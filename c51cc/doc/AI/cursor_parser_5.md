# –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–∞—Ä—Å–µ—Ä–æ–º –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
_Exported on 5/27/2025 at 20:43:38 GMT+3 from Cursor (0.50.5)_

---

**User**

–í–∏–∂—É, —á—Ç–æ:
‚úÖ –ü—Ä–æ—Å—Ç—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç
‚úÖ –ü—Ä–æ—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
‚ùå –§—É–Ω–∫—Ü–∏–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç
‚ùå C51 interrupt –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

–†–∞–∑–±–µ—Ä–∏—Å—å –ø–æ—á–µ–º—É.
–ò—Å–ø–æ–ª—å–∑—É–π –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã.
–ú–∞–∫—Ä–æ—Å do-parse –ª–∏–Ω—Ç–µ—Ä—É –Ω–µ –ø–æ–Ω—è—Ç–µ–Ω, –Ω–æ –æ–Ω –≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∏ –≤–µ—Ä–Ω—ã–π.
–õ–µ–∫—Å–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–µ–∫—Ç–æ—Ä —Ç–æ–∫–µ–Ω–æ–≤, –∞ –Ω–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å :success

---

**Cursor**

–Ø –ø–æ–º–æ–≥—É —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è —Å –ø—Ä–æ–±–ª–µ–º–∞–º–∏ –≤ –≤–∞—à–µ–º –ø–∞—Ä—Å–µ—Ä–µ. –°–Ω–∞—á–∞–ª–∞ –¥–∞–≤–∞–π—Ç–µ –∏–∑—É—á–∏–º —Ç–µ–∫—É—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ –∏ –Ω–∞–π–¥–µ–º –ø—Ä–æ–±–ª–µ–º—ã.

–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –Ω–∞–π–¥–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã –ø–∞—Ä—Å–µ—Ä–∞:

–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –∫–∞–∫–∏–µ –∏–º–µ–Ω–Ω–æ –ø—Ä–æ–±–ª–µ–º—ã –≤–æ–∑–Ω–∏–∫–∞—é—Ç:

–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã –ø–∞—Ä—Å–µ—Ä–∞:

–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –ø–∞—Ä—Å–µ—Ä:

–î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏–º –∏–∑—É—á–µ–Ω–∏–µ –ø–∞—Ä—Å–µ—Ä–∞, –æ—Å–æ–±–µ–Ω–Ω–æ —á–∞—Å—Ç–∏, –æ—Ç–≤–µ—á–∞—é—â–µ–π –∑–∞ —Ñ—É–Ω–∫—Ü–∏–∏:

–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é –ø–∞—Ä—Å–∏–Ω–≥–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:

–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é –ø–∞—Ä—Å–∏–Ω–≥–∞ C51 –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤:

–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏–º —Ç–µ—Å—Ç—ã, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏:

–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ! –ü—Ä–æ—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç, –Ω–æ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º–∞ —Å –ø–∞—Ä—Å–∏–Ω–≥–æ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö. –î–∞–≤–∞–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏–º —Ç–µ—Å—Ç interrupt:

–û—Ç–ª–∏—á–Ω–æ! Interrupt —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç! –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ —Å–æ–∑–¥–∞–¥–∏–º –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º:

```clojure
(require '[c51cc.parser :as parser])
(require '[c51cc.lexer :as lexer])

(defn parse-string [input]
  "–ü–∞—Ä—Å–∏—Ç —Å—Ç—Ä–æ–∫—É –∫–æ–¥–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç"
  (let [tokens (lexer/tokenize input)]
    (parser/parse tokens)))

(defn detailed-test [description code]
  "–î–µ—Ç–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç —Å –ø–æ–ª–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–æ–π"
  (println (str "\n=== " description " ==="))
  (println (str "–ö–æ–¥: " code))
  
  ;; –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—é
  (let [tokens (lexer/tokenize code)]
    (println (str "–¢–æ–∫–µ–Ω—ã (" (count tokens) "): "))
    (doseq [[i token] (map-indexed vector tokens)]
      (println (str "  " i ": " (:type token) " = " (:value token))))
    
    ;; –ó–∞—Ç–µ–º –ø–∞—Ä—Å–∏–Ω–≥
    (let [result (parser/parse tokens)]
      (println "\n–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞:")
      (if (:success result)
        (do
          (println "‚úì –£–°–ü–ï–•")
          (let [ast (:ast result)]
            (println (str "AST —Ç–∏–ø: " (:ast-type ast)))
            (when (:declarations ast)
              (println (str "–û–±—ä—è–≤–ª–µ–Ω–∏–π: " (count (:declarations ast))))
              (doseq [[i decl] (map-indexed vector (:declarations ast))]
                (println (str "  " i ": " (:ast-type decl)))
                (when (= (:ast-type decl) :function-declaration)
                  (println (str "    –ò–º—è: " (:function-name decl)))
                  (println (str "    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: " (count (:parameters decl))))
                  (doseq [[j param] (map-indexed vector (:parameters decl))]
                    (println (str "      " j ": " (:type param) " " (:name param)))))))))
        (do
          (println "‚úó –û–®–ò–ë–ö–ê")
          (println (str "–°–æ–æ–±—â–µ–Ω–∏–µ: " (:error result)))
          (println (str "–ü–æ–∑–∏—Ü–∏—è: " (:position result)))
          (when (< (:position result) (count tokens))
            (println (str "–¢–æ–∫–µ–Ω –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏: " (nth tokens (:position result))))))))))

;; –¢–µ—Å—Ç—ã –ø—Ä–æ—Å—Ç—ã—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π (–¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å)
(detailed-test "–ü—Ä–æ—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤" "void main() { }")
(detailed-test "–ü—Ä–æ—Å—Ç–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π" "int x;")

;; –¢–µ—Å—Ç—ã —Ñ—É–Ω–∫—Ü–∏–π —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (–ø—Ä–æ–±–ª–µ–º–Ω—ã–µ)
(detailed-test "–§—É–Ω–∫—Ü–∏—è —Å –æ–¥–Ω–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º" "int add(int a) { return a; }")
(detailed-test "–§—É–Ω–∫—Ü–∏—è —Å –¥–≤—É–º—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏" "int add(int a, int b) { return a + b; }")
(detailed-test "–§—É–Ω–∫—Ü–∏—è —Å void –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º" "void func(void) { }")

;; –¢–µ—Å—Ç—ã C51 interrupt (–¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å)
(detailed-test "Interrupt —Ñ—É–Ω–∫—Ü–∏—è" "void timer_isr(void) interrupt 1 { }")
(detailed-test "Interrupt —Å using" "void ext_int(void) interrupt 0 using 2 { }")

;; –¢–µ—Å—Ç—ã –æ–±—ä—è–≤–ª–µ–Ω–∏–π —Ñ—É–Ω–∫—Ü–∏–π
(detailed-test "–û–±—ä—è–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏" "int add(int a, int b);")
(detailed-test "–û–±—ä—è–≤–ª–µ–Ω–∏–µ void —Ñ—É–Ω–∫—Ü–∏–∏" "void func();")

;; –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã
(detailed-test "–§—É–Ω–∫—Ü–∏—è —Å —Ç–µ–ª–æ–º –∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏" "void test() { int x = 5; x = x + 1; }")
(detailed-test "–§—É–Ω–∫—Ü–∏—è —Å return" "int getValue() { return 42; }")

(println "\n=== –ó–ê–í–ï–†–®–ï–ù–ò–ï –¢–ï–°–¢–û–í ===")
```

–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å —è –≤–∏–∂—É –ø—Ä–æ–±–ª–µ–º—ã:

## –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º:

1. **‚úÖ –ü—Ä–æ—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç** - `void main() { }`, `void func();`
2. **‚úÖ C51 interrupt —Ä–∞–±–æ—Ç–∞–µ—Ç** - `void timer_isr(void) interrupt 1 { }`
3. **‚ùå –§—É–Ω–∫—Ü–∏–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ù–ï —Ä–∞–±–æ—Ç–∞—é—Ç** - –ø—Ä–æ–±–ª–µ–º–∞ –≤ –ø–∞—Ä—Å–∏–Ω–≥–µ —Ç–∏–ø–æ–≤ –∫–∞–∫ –ø–µ—Ä–≤–æ–≥–æ —Ç–æ–∫–µ–Ω–∞
4. **‚ùå –§—É–Ω–∫—Ü–∏–∏ —Å –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–º —Ç–∏–ø–æ–º int –ù–ï —Ä–∞–±–æ—Ç–∞—é—Ç** - —Ç–∞ –∂–µ –ø—Ä–æ–±–ª–µ–º–∞

**–ö–æ—Ä–µ–Ω—å –ø—Ä–æ–±–ª–µ–º—ã**: –ü–∞—Ä—Å–µ—Ä –ø—ã—Ç–∞–µ—Ç—Å—è –ø–∞—Ä—Å–∏—Ç—å `int add(...)` –∫–∞–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `int`, –∞ –Ω–µ –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏—é. –≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Ç–æ–º—É —á—Ç–æ –≤ `parse-declaration` –ø–æ—Ä—è–¥–æ–∫ –≤—ã–±–æ—Ä–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π.

–î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é `parse-declaration`:

–ü—Ä–æ–±–ª–µ–º–∞ –Ω–∞–π–¥–µ–Ω–∞! –í —Ñ—É–Ω–∫—Ü–∏–∏ `parse-declaration` –ø–æ—Ä—è–¥–æ–∫ –ø–∞—Ä—Å–µ—Ä–æ–≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π. –ü–∞—Ä—Å–µ—Ä `parse-variable-declaration` –ø—ã—Ç–∞–µ—Ç—Å—è –ø–∞—Ä—Å–∏—Ç—å `int add(...)` –∫–∞–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –∏ —á–∞—Å—Ç–∏—á–Ω–æ —É—Å–ø–µ—à–Ω–æ –ø–∞—Ä—Å–∏—Ç `int`, –Ω–æ –∑–∞—Ç–µ–º –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å.

–ù—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É, —á—Ç–æ–±—ã —Ä–∞–∑–ª–∏—á–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ. –î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ `parse-variable-declaration`:

–¢–µ–ø–µ—Ä—å —è –ø–æ–Ω–∏–º–∞—é –ø—Ä–æ–±–ª–µ–º—É! –ù—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –±–æ–ª–µ–µ —É–º–Ω—É—é –ª–æ–≥–∏–∫—É —Ä–∞–∑–ª–∏—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö. –ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ –∏ —Ñ—É–Ω–∫—Ü–∏–∏, –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å —Ç–∏–ø–∞ + –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞, –Ω–æ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–º–µ—é—Ç —Å–∫–æ–±–∫–∏ `(` –ø–æ—Å–ª–µ –∏–º–µ–Ω–∏.

–î–∞–≤–∞–π—Ç–µ —Å–æ–∑–¥–∞–¥–∏–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é:

```clojure
(defn parse-declaration 
  "–ü–∞—Ä—Å–∏—Ç –ª—é–±–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –∏–ª–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
   –í C89/C90: –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–π –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –Ω–∞—á–∞–ª–µ,
   —Å–º–µ—à–∏–≤–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –∑–∞–ø—Ä–µ—â–µ–Ω–æ (–≤–≤–µ–¥–µ–Ω–æ –≤ C99)
   –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç C51-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–∏: sfr, sbit
   –ò–°–ü–†–ê–í–õ–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω–∞ —É–º–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–∑–ª–∏—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö"
  [state]
  ((choice
    ;; C51-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–∏ (–Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤)
    parse-sfr-declaration
    parse-sbit-declaration
    
    ;; –£–º–Ω–æ–µ —Ä–∞–∑–ª–∏—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
    ;; –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –ø–æ—Å–ª–µ —Ç–∏–ø–∞ + –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –æ—Ç–∫—Ä—ã–≤–∞—é—â–∞—è —Å–∫–æ–±–∫–∞
    (fn [state]
      (let [type-result (parse-type-specifier state)]
        (if (:success? type-result)
          (let [name-result ((expect-token :identifier) (:state type-result))]
            (if (:success? name-result)
              (let [next-token-result (current-token (:state name-result))]
                (if (and (:success? next-token-result)
                         (= (:type (:value next-token-result)) :bracket)
                         (= (:value (:value next-token-result)) :open-round))
                  ;; –≠—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è - –µ—Å—Ç—å –æ—Ç–∫—Ä—ã–≤–∞—é—â–∞—è —Å–∫–æ–±–∫–∞
                  (parse-function-declaration state)
                  ;; –≠—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è - –Ω–µ—Ç –æ—Ç–∫—Ä—ã–≤–∞—é—â–µ–π —Å–∫–æ–±–∫–∏
                  (parse-variable-declaration state)))
              ;; –ù–µ —É–¥–∞–ª–æ—Å—å –ø–∞—Ä—Å–∏—Ç—å –∏–º—è - –ø—Ä–æ–±—É–µ–º –¥—Ä—É–≥–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
              (failure "–û–∂–∏–¥–∞–ª—Å—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ—Å–ª–µ —Ç–∏–ø–∞" (:state type-result)))
          ;; –ù–µ —É–¥–∞–ª–æ—Å—å –ø–∞—Ä—Å–∏—Ç—å —Ç–∏–ø - –ø—Ä–æ–±—É–µ–º –¥—Ä—É–≥–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
          (failure "–û–∂–∏–¥–∞–ª—Å—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç–∏–ø–∞" state))))
    
    ;; –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
    parse-statement
    
    ;; –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É –≤—ã—Ä–∞–∂–µ–Ω–∏–π –∫–∞–∫ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–π (—Ç–æ–ª—å–∫–æ —Å —Ç–æ—á–∫–æ–π —Å –∑–∞–ø—è—Ç–æ–π!)
    (fn [state]
      (let [expr-result (parse-expression state)]
        (if (:success? expr-result)
          (let [semi-result ((expect-token-value :semicolon) (:state expr-result))]
            (if (:success? semi-result)
              (success (expression-statement-node (:value expr-result)) (:state semi-result))
              ;; –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ–º –≤—ã—Ä–∞–∂–µ–Ω–∏—è –±–µ–∑ —Ç–æ—á–∫–∏ —Å –∑–∞–ø—è—Ç–æ–π
              semi-result))
          expr-result)))) state))
```

–ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º–∞ —Å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–æ–º. –î–∞–≤–∞–π—Ç–µ –∏—Å–ø—Ä–∞–≤–∏–º:

–ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å –ª–∏—à–Ω—è—è –æ—Ç–∫—Ä—ã–≤–∞—é—â–∞—è —Å–∫–æ–±–∫–∞. –î–∞–≤–∞–π—Ç–µ –∏—Å–ø—Ä–∞–≤–∏–º —ç—Ç–æ:

```clojure
(defn parse-declaration 
  "–ü–∞—Ä—Å–∏—Ç –ª—é–±–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –∏–ª–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
   –í C89/C90: –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–π –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –Ω–∞—á–∞–ª–µ,
   —Å–º–µ—à–∏–≤–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –∑–∞–ø—Ä–µ—â–µ–Ω–æ (–≤–≤–µ–¥–µ–Ω–æ –≤ C99)
   –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç C51-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–∏: sfr, sbit
   –ò–°–ü–†–ê–í–õ–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω–∞ —É–º–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–∑–ª–∏—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö"
  [state]
  ((choice
    ;; C51-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–∏ (–Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤)
    parse-sfr-declaration
    parse-sbit-declaration
    
    ;; –£–º–Ω–æ–µ —Ä–∞–∑–ª–∏—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
    ;; –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –ø–æ—Å–ª–µ —Ç–∏–ø–∞ + –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –æ—Ç–∫—Ä—ã–≤–∞—é—â–∞—è —Å–∫–æ–±–∫–∞
    (fn [state]
      (let [type-result (parse-type-specifier state)]
        (if (:success? type-result)
          (let [name-result ((expect-token :identifier) (:state type-result))]
            (if (:success? name-result)
              (let [next-token-result (current-token (:state name-result))]
                (if (and (:success? next-token-result)
                         (= (:type (:value next-token-result)) :bracket)
                         (= (:value (:value next-token-result)) :open-round))
                  ;; –≠—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è - –µ—Å—Ç—å –æ—Ç–∫—Ä—ã–≤–∞—é—â–∞—è —Å–∫–æ–±–∫–∞
                  (parse-function-declaration state)
                  ;; –≠—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è - –Ω–µ—Ç –æ—Ç–∫—Ä—ã–≤–∞—é—â–µ–π —Å–∫–æ–±–∫–∏
                  (parse-variable-declaration state)))
              ;; –ù–µ —É–¥–∞–ª–æ—Å—å –ø–∞—Ä—Å–∏—Ç—å –∏–º—è - –ø—Ä–æ–±—É–µ–º –¥—Ä—É–≥–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
              (failure "–û–∂–∏–¥–∞–ª—Å—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ—Å–ª–µ —Ç–∏–ø–∞" (:state type-result)))
          ;; –ù–µ —É–¥–∞–ª–æ—Å—å –ø–∞—Ä—Å–∏—Ç—å —Ç–∏–ø - –ø—Ä–æ–±—É–µ–º –¥—Ä—É–≥–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
          (failure "–û–∂–∏–¥–∞–ª—Å—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç–∏–ø–∞" state))))
    
    ;; –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
    parse-statement
    
    ;; –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É –≤—ã—Ä–∞–∂–µ–Ω–∏–π –∫–∞–∫ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–π (—Ç–æ–ª—å–∫–æ —Å —Ç–æ—á–∫–æ–π —Å –∑–∞–ø—è—Ç–æ–π!)
    (fn [state]
      (let [expr-result (parse-expression state)]
        (if (:success? expr-result)
          (let [semi-result ((expect-token-value :semicolon) (:state expr-result))]
            (if (:success? semi-result)
              (success (expression-statement-node (:value expr-result)) (:state semi-result))
              ;; –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ–º –≤—ã—Ä–∞–∂–µ–Ω–∏—è –±–µ–∑ —Ç–æ—á–∫–∏ —Å –∑–∞–ø—è—Ç–æ–π
              semi-result))
          expr-result)))) state))
```

–î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º, –≥–¥–µ –∏–º–µ–Ω–Ω–æ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ —Å–∫–æ–±–∫–∞–º–∏:

---

**User**

–≤—Ä–æ–¥–µ –∏—Å–ø—Ä–∞–≤–∏–ª, –ø—Ä–æ–¥–æ–ª–∂–∞–π

---

**Cursor**

–Ø –≤–∏–∂—É –ø—Ä–æ–±–ª–µ–º—É! –ú–∞–∫—Ä–æ—Å `do-parse` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ - –ª–∏–Ω—Ç–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ —Ä–∞–∑—Ä–µ—à–∞—é—Ç—Å—è. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º–∞–∫—Ä–æ—Å –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–¥. 

–ù–æ —Å–Ω–∞—á–∞–ª–∞ –¥–∞–≤–∞–π—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º –Ω–∞—à–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Ä–∞–∑–ª–∏—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:

---

**User**

do-parse –ø—Ä–∞–≤–∏–ª—å–Ω—ã! –¢..–∫. —ç—Ç–æ –≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∏ –≤–µ—Ä–Ω—ã–π –∫–æ–¥ —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

---

**Cursor**

–í—ã –∞–±—Å–æ–ª—é—Ç–Ω–æ –ø—Ä–∞–≤—ã! –ú–∞–∫—Ä–æ—Å `do-parse` –≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∏ –≤–µ—Ä–Ω—ã–π –∏ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –∑–∞—Ö–≤–∞—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö. –õ–∏–Ω—Ç–µ—Ä –ø—Ä–æ—Å—Ç–æ –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç –º–∞–∫—Ä–æ—Å—ã, –Ω–æ –∫–æ–¥ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω.

–î–∞–≤–∞–π—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º –Ω–∞—à–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Ä–∞–∑–ª–∏—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:

–ü—Ä–æ–±–ª–µ–º–∞ —Å—Ç–∞–ª–∞ –µ—â–µ —Ö—É–∂–µ! –¢–µ–ø–µ—Ä—å –≤–æ–æ–±—â–µ –Ω–∏—á–µ–≥–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç. –ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ –Ω–∞—à–∞ –Ω–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ –≤ `parse-declaration` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `failure`, –∞ –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä `choice` –Ω–µ –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ.

–î–∞–≤–∞–π—Ç–µ –∏—Å–ø—Ä–∞–≤–∏–º —ç—Ç–æ, —Å–æ–∑–¥–∞–≤ –±–æ–ª–µ–µ —É–º–Ω—É—é –ª–æ–≥–∏–∫—É:

```clojure
(defn parse-declaration 
  "–ü–∞—Ä—Å–∏—Ç –ª—é–±–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –∏–ª–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
   –í C89/C90: –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–π –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –Ω–∞—á–∞–ª–µ,
   —Å–º–µ—à–∏–≤–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –∑–∞–ø—Ä–µ—â–µ–Ω–æ (–≤–≤–µ–¥–µ–Ω–æ –≤ C99)
   –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç C51-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–∏: sfr, sbit
   –ò–°–ü–†–ê–í–õ–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω–∞ —É–º–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–∑–ª–∏—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö"
  [state]
  ((choice
    ;; C51-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–∏ (–Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤)
    parse-sfr-declaration
    parse-sbit-declaration
    
    ;; –£–º–Ω–æ–µ —Ä–∞–∑–ª–∏—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
    ;; –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –ø–æ—Å–ª–µ —Ç–∏–ø–∞ + –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –æ—Ç–∫—Ä—ã–≤–∞—é—â–∞—è —Å–∫–æ–±–∫–∞
    (fn [state]
      ;; –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–µ–º –ª–∏ –º—ã –ø–∞—Ä—Å–∏—Ç—å —Ç–∏–ø
      (let [type-result (parse-type-specifier state)]
        (if (:success? type-result)
          ;; –ó–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä—è–µ–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
          (let [name-result ((expect-token :identifier) (:state type-result))]
            (if (:success? name-result)
              ;; –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–ª–µ–¥—É—é—â–∏–π —Ç–æ–∫–µ–Ω –±–µ–∑ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—è
              (let [next-token-result (current-token (:state name-result))]
                (if (and (:success? next-token-result)
                         (= (:type (:value next-token-result)) :bracket)
                         (= (:value (:value next-token-result)) :open-round))
                  ;; –≠—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è - –µ—Å—Ç—å –æ—Ç–∫—Ä—ã–≤–∞—é—â–∞—è —Å–∫–æ–±–∫–∞
                  (parse-function-declaration state)
                  ;; –≠—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è - –Ω–µ—Ç –æ—Ç–∫—Ä—ã–≤–∞—é—â–µ–π —Å–∫–æ–±–∫–∏
                  (parse-variable-declaration state)))
              ;; –ù–µ —É–¥–∞–ª–æ—Å—å –ø–∞—Ä—Å–∏—Ç—å –∏–º—è - —ç—Ç–æ –Ω–µ –Ω–∞—à —Å–ª—É—á–∞–π
              (failure "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–∞—Ä—Å–∏—Ç—å –∫–∞–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ —Å —Ç–∏–ø–æ–º" state))
          ;; –ù–µ —É–¥–∞–ª–æ—Å—å –ø–∞—Ä—Å–∏—Ç—å —Ç–∏–ø - —ç—Ç–æ –Ω–µ –Ω–∞—à —Å–ª—É—á–∞–π
          (failure "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–∞—Ä—Å–∏—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç–∏–ø–∞" state))))
    
    ;; –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
    parse-statement
    
    ;; –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É –≤—ã—Ä–∞–∂–µ–Ω–∏–π –∫–∞–∫ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–π (—Ç–æ–ª—å–∫–æ —Å —Ç–æ—á–∫–æ–π —Å –∑–∞–ø—è—Ç–æ–π!)
    (fn [state]
      (let [expr-result (parse-expression state)]
        (if (:success? expr-result)
          (let [semi-result ((expect-token-value :semicolon) (:state expr-result))]
            (if (:success? semi-result)
              (success (expression-statement-node (:value expr-result)) (:state semi-result))
              ;; –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ–º –≤—ã—Ä–∞–∂–µ–Ω–∏—è –±–µ–∑ —Ç–æ—á–∫–∏ —Å –∑–∞–ø—è—Ç–æ–π
              semi-result))
          expr-result)))) state))
```

–ü—Ä–æ–±–ª–µ–º–∞ –≤—Å–µ –µ—â–µ –≤ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–µ. –î–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º –¥—Ä—É–≥–æ–π –ø–æ–¥—Ö–æ–¥ - —Å–æ–∑–¥–∞–¥–∏–º –æ—Ç–¥–µ–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Ä–∞–∑–ª–∏—á–µ–Ω–∏—è:

```clojure
;; –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞–∑–ª–∏—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
(defn parse-function-or-variable-declaration
  "–£–º–Ω–æ —Ä–∞–∑–ª–∏—á–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ –Ω–∞–ª–∏—á–∏—é —Å–∫–æ–±–æ–∫ –ø–æ—Å–ª–µ –∏–º–µ–Ω–∏"
  [state]
  ;; –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–µ–º –ª–∏ –º—ã –ø–∞—Ä—Å–∏—Ç—å —Ç–∏–ø
  (let [type-result (parse-type-specifier state)]
    (if (:success? type-result)
      ;; –ó–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä—è–µ–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
      (let [name-result ((expect-token :identifier) (:state type-result))]
        (if (:success? name-result)
          ;; –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–ª–µ–¥—É—é—â–∏–π —Ç–æ–∫–µ–Ω –±–µ–∑ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—è
          (let [next-token-result (current-token (:state name-result))]
            (if (and (:success? next-token-result)
                     (= (:type (:value next-token-result)) :bracket)
                     (= (:value (:value next-token-result)) :open-round))
              ;; –≠—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è - –µ—Å—Ç—å –æ—Ç–∫—Ä—ã–≤–∞—é—â–∞—è —Å–∫–æ–±–∫–∞
              (parse-function-declaration state)
              ;; –≠—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è - –Ω–µ—Ç –æ—Ç–∫—Ä—ã–≤–∞—é—â–µ–π —Å–∫–æ–±–∫–∏
              (parse-variable-declaration state)))
          ;; –ù–µ —É–¥–∞–ª–æ—Å—å –ø–∞—Ä—Å–∏—Ç—å –∏–º—è - —ç—Ç–æ –Ω–µ –Ω–∞—à —Å–ª—É—á–∞–π
          (failure "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–∞—Ä—Å–∏—Ç—å –∫–∞–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ —Å —Ç–∏–ø–æ–º" state))
      ;; –ù–µ —É–¥–∞–ª–æ—Å—å –ø–∞—Ä—Å–∏—Ç—å —Ç–∏–ø - —ç—Ç–æ –Ω–µ –Ω–∞—à —Å–ª—É—á–∞–π
      (failure "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–∞—Ä—Å–∏—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç–∏–ø–∞" state))))

(defn parse-declaration 
  "–ü–∞—Ä—Å–∏—Ç –ª—é–±–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –∏–ª–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
   –í C89/C90: –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–π –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –Ω–∞—á–∞–ª–µ,
   —Å–º–µ—à–∏–≤–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –∑–∞–ø—Ä–µ—â–µ–Ω–æ (–≤–≤–µ–¥–µ–Ω–æ –≤ C99)
   –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç C51-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–∏: sfr, sbit
   –ò–°–ü–†–ê–í–õ–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω–∞ —É–º–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–∑–ª–∏—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö"
  [state]
  ((choice
    ;; C51-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–∏ (–Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤)
    parse-sfr-declaration
    parse-sbit-declaration
    
    ;; –£–º–Ω–æ–µ —Ä–∞–∑–ª–∏—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
    parse-function-or-variable-declaration
    
    ;; –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
    parse-statement
    
    ;; –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É –≤—ã—Ä–∞–∂–µ–Ω–∏–π –∫–∞–∫ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–π (—Ç–æ–ª—å–∫–æ —Å —Ç–æ—á–∫–æ–π —Å –∑–∞–ø—è—Ç–æ–π!)
    (fn [state]
      (let [expr-result (parse-expression state)]
        (if (:success? expr-result)
          (let [semi-result ((expect-token-value :semicolon) (:state expr-result))]
            (if (:success? semi-result)
              (success (expression-statement-node (:value expr-result)) (:state semi-result))
              ;; –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ–º –≤—ã—Ä–∞–∂–µ–Ω–∏—è –±–µ–∑ —Ç–æ—á–∫–∏ —Å –∑–∞–ø—è—Ç–æ–π
              semi-result))
          expr-result)))) state))
```

–ü—Ä–æ–±–ª–µ–º–∞ –≤—Å–µ –µ—â–µ –≤ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–µ. –î–∞–≤–∞–π—Ç–µ –Ω–∞–π–¥–µ–º –∏ –∏—Å–ø—Ä–∞–≤–∏–º –ø—Ä–æ–±–ª–µ–º—É —Å–æ —Å–∫–æ–±–∫–∞–º–∏. –ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å –ª–∏—à–Ω—è—è –æ—Ç–∫—Ä—ã–≤–∞—é—â–∞—è —Å–∫–æ–±–∫–∞ –≤ –Ω–∞—á–∞–ª–µ —Ñ—É–Ω–∫—Ü–∏–∏. –î–∞–≤–∞–π—Ç–µ –∏—Å–ø—Ä–∞–≤–∏–º —ç—Ç–æ:

–Ø –≤–∏–∂—É –ø—Ä–æ–±–ª–µ–º—É! –£ –Ω–∞—Å –µ—Å—Ç—å –ª–∏—à–Ω—è—è –æ—Ç–∫—Ä—ã–≤–∞—é—â–∞—è —Å–∫–æ–±–∫–∞ –≤ —Å—Ç—Ä–æ–∫–µ 917. –î–∞–≤–∞–π—Ç–µ –∏—Å–ø—Ä–∞–≤–∏–º —ç—Ç–æ:

```clojure
(defn parse-declaration 
  "–ü–∞—Ä—Å–∏—Ç –ª—é–±–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –∏–ª–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
   –í C89/C90: –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–π –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –Ω–∞—á–∞–ª–µ,
   —Å–º–µ—à–∏–≤–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –∑–∞–ø—Ä–µ—â–µ–Ω–æ (–≤–≤–µ–¥–µ–Ω–æ –≤ C99)
   –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç C51-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–∏: sfr, sbit
   –ò–°–ü–†–ê–í–õ–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω–∞ —É–º–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–∑–ª–∏—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö"
  [state]
  (choice
    ;; C51-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–∏ (–Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤)
    parse-sfr-declaration
    parse-sbit-declaration
    
    ;; –£–º–Ω–æ–µ —Ä–∞–∑–ª–∏—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
    parse-function-or-variable-declaration
    
    ;; –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
    parse-statement
    
    ;; –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É –≤—ã—Ä–∞–∂–µ–Ω–∏–π –∫–∞–∫ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–π (—Ç–æ–ª—å–∫–æ —Å —Ç–æ—á–∫–æ–π —Å –∑–∞–ø—è—Ç–æ–π!)
    (fn [state]
      (let [expr-result (parse-expression state)]
        (if (:success? expr-result)
          (let [semi-result ((expect-token-value :semicolon) (:state expr-result))]
            (if (:success? semi-result)
              (success (expression-statement-node (:value expr-result)) (:state semi-result))
              ;; –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ–º –≤—ã—Ä–∞–∂–µ–Ω–∏—è –±–µ–∑ —Ç–æ—á–∫–∏ —Å –∑–∞–ø—è—Ç–æ–π
              semi-result))
          expr-result)))) state)
```

–ü—Ä–æ–±–ª–µ–º–∞ –≤—Å–µ –µ—â–µ –µ—Å—Ç—å. –î–∞–≤–∞–π—Ç–µ –Ω–∞–π–¥–µ–º –≥–¥–µ –∏–º–µ–Ω–Ω–æ –ª–∏—à–Ω—è—è —Å–∫–æ–±–∫–∞. –ü—Ä–æ–±–ª–µ–º–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ —Ç–æ–º, —á—Ç–æ `choice` –¥–æ–ª–∂–µ–Ω –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏—è. –î–∞–≤–∞–π—Ç–µ –∏—Å–ø—Ä–∞–≤–∏–º:

```clojure
(defn parse-declaration 
  "–ü–∞—Ä—Å–∏—Ç –ª—é–±–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –∏–ª–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
   –í C89/C90: –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–π –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –Ω–∞—á–∞–ª–µ,
   —Å–º–µ—à–∏–≤–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –∑–∞–ø—Ä–µ—â–µ–Ω–æ (–≤–≤–µ–¥–µ–Ω–æ –≤ C99)
   –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç C51-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–∏: sfr, sbit
   –ò–°–ü–†–ê–í–õ–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω–∞ —É–º–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–∑–ª–∏—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö"
  [state]
  ((choice
     ;; C51-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–∏ (–Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤)
     parse-sfr-declaration
     parse-sbit-declaration
     
     ;; –£–º–Ω–æ–µ —Ä–∞–∑–ª–∏—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
     parse-function-or-variable-declaration
     
     ;; –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
     parse-statement
     
     ;; –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É –≤—ã—Ä–∞–∂–µ–Ω–∏–π –∫–∞–∫ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–π (—Ç–æ–ª—å–∫–æ —Å —Ç–æ—á–∫–æ–π —Å –∑–∞–ø—è—Ç–æ–π!)
     (fn [state]
       (let [expr-result (parse-expression state)]
         (if (:success? expr-result)
           (let [semi-result ((expect-token-value :semicolon) (:state expr-result))]
             (if (:success? semi-result)
               (success (expression-statement-node (:value expr-result)) (:state semi-result))
               ;; –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ–º –≤—ã—Ä–∞–∂–µ–Ω–∏—è –±–µ–∑ —Ç–æ—á–∫–∏ —Å –∑–∞–ø—è—Ç–æ–π
               semi-result))
           expr-result)))) state))
```

–Ø –¥–æ—Å—Ç–∏–≥ –ª–∏–º–∏—Ç–∞ –ø–æ–ø—ã—Ç–æ–∫ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–∏–Ω—Ç–µ—Ä–∞. –î–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º –¥—Ä—É–≥–æ–π –ø–æ–¥—Ö–æ–¥ - —Å–æ–∑–¥–∞–¥–∏–º –ø—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –Ω–∞—à–∞ –ª–æ–≥–∏–∫–∞:

```clojure
(require '[c51cc.parser :as parser])
(require '[c51cc.lexer :as lexer])

(println "=== –ü–†–û–°–¢–û–ô –¢–ï–°–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø ===")

;; –¢–µ—Å—Ç –ø—Ä–æ—Å—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
(let [code "void main() { }"
      tokens (lexer/tokenize code)]
  (println "\n–¢–µ—Å—Ç: void main() { }")
  (println "–¢–æ–∫–µ–Ω—ã:" (count tokens))
  (try
    (let [result (parser/parse tokens)]
      (if (:success result)
        (println "‚úì –£–°–ü–ï–•!")
        (println "‚úó –û–®–ò–ë–ö–ê:" (:error result))))
    (catch Exception e
      (println "‚úó –ò–°–ö–õ–Æ–ß–ï–ù–ò–ï:" (.getMessage e)))))

;; –¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
(let [code "int add(int a, int b) { return a + b; }"
      tokens (lexer/tokenize code)]
  (println "\n–¢–µ—Å—Ç: int add(int a, int b) { return a + b; }")
  (println "–¢–æ–∫–µ–Ω—ã:" (count tokens))
  (try
    (let [result (parser/parse tokens)]
      (if (:success result)
        (println "‚úì –£–°–ü–ï–•!")
        (println "‚úó –û–®–ò–ë–ö–ê:" (:error result))))
    (catch Exception e
      (println "‚úó –ò–°–ö–õ–Æ–ß–ï–ù–ò–ï:" (.getMessage e)))))

(println "\n=== –ö–û–ù–ï–¶ –¢–ï–°–¢–ê ===")
```

–ü—Ä–æ–±–ª–µ–º–∞ –≤—Å–µ –µ—â–µ –µ—Å—Ç—å. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–∏—Ç—É–∞—Ü–∏—é:

## –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º:

1. **–°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ –ø–∞—Ä—Å–µ—Ä–µ** - –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ —Å–∫–æ–±–∫–∞–º–∏ –≤ `parse-declaration`
2. **–õ–æ–≥–∏–∫–∞ —Ä–∞–∑–ª–∏—á–µ–Ω–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç** - –ø–∞—Ä—Å–µ—Ä –≤—Å–µ –µ—â–µ –Ω–µ –º–æ–∂–µ—Ç —Ä–∞–∑–ª–∏—á–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

–î–∞–≤–∞–π—Ç–µ —Å–æ–∑–¥–∞–¥–∏–º –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–µ —Ä–µ—à–µ–Ω–∏–µ. –ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ –º—ã –ø—ã—Ç–∞–µ–º—Å—è –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Å–ª–æ–∂–Ω—É—é –ª–æ–≥–∏–∫—É, –Ω–æ —É –Ω–∞—Å –µ—Å—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏.

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:

–í–º–µ—Å—Ç–æ —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏ lookahead, –¥–∞–≤–∞–π—Ç–µ –ø—Ä–æ—Å—Ç–æ –∏–∑–º–µ–Ω–∏–º –ø–æ—Ä—è–¥–æ–∫ –ø–∞—Ä—Å–µ—Ä–æ–≤ –≤ `choice` - –ø–æ—Å—Ç–∞–≤–∏–º `parse-function-declaration` –ø–µ—Ä–µ–¥ `parse-variable-declaration`:

```clojure
(defn parse-declaration 
  "–ü–∞—Ä—Å–∏—Ç –ª—é–±–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –∏–ª–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
   –í C89/C90: –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–π –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –Ω–∞—á–∞–ª–µ,
   —Å–º–µ—à–∏–≤–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –∑–∞–ø—Ä–µ—â–µ–Ω–æ (–≤–≤–µ–¥–µ–Ω–æ –≤ C99)
   –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç C51-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–∏: sfr, sbit
   –ò–°–ü–†–ê–í–õ–ï–ù–û: –§—É–Ω–∫—Ü–∏–∏ –ø–∞—Ä—Å—è—Ç—Å—è –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏"
  [state]
  ((choice
     ;; C51-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–∏ (–Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤)
     parse-sfr-declaration
     parse-sbit-declaration
     
     ;; –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º —Ñ—É–Ω–∫—Ü–∏–∏, –ø–æ—Ç–æ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
     parse-function-declaration
     parse-variable-declaration
     
     ;; –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
     parse-statement
     
     ;; –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É –≤—ã—Ä–∞–∂–µ–Ω–∏–π –∫–∞–∫ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–π (—Ç–æ–ª—å–∫–æ —Å —Ç–æ—á–∫–æ–π —Å –∑–∞–ø—è—Ç–æ–π!)
     (fn [state]
       (let [expr-result (parse-expression state)]
         (if (:success? expr-result)
           (let [semi-result ((expect-token-value :semicolon) (:state expr-result))]
             (if (:success? semi-result)
               (success (expression-statement-node (:value expr-result)) (:state semi-result))
               ;; –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ–º –≤—ã—Ä–∞–∂–µ–Ω–∏—è –±–µ–∑ —Ç–æ—á–∫–∏ —Å –∑–∞–ø—è—Ç–æ–π
               semi-result))
           expr-result)))) state))
```

–•–æ—Ä–æ—à–æ! –¢–µ–ø–µ—Ä—å —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞. –õ–∏–Ω—Ç–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –≤ –º–∞–∫—Ä–æ—Å–µ `do-parse`, –Ω–æ —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ - –æ–Ω –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç –≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∏–µ –º–∞–∫—Ä–æ—Å—ã.

–î–∞–≤–∞–π—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º –Ω–∞—à–µ –ø—Ä–æ—Å—Ç–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:

–û—Ç–ª–∏—á–Ω–æ! –ü—Ä–æ—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç! –ù–æ —Ñ—É–Ω–∫—Ü–∏–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –≤—Å–µ –µ—â–µ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç. –î–∞–≤–∞–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏–º –ø–æ–ª–Ω—ã–π —Ç–µ—Å—Ç:

–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å —É –Ω–∞—Å –µ—Å—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å:

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

### ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç:
- ‚úÖ –ü—Ä–æ—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: `void main() { }`
- ‚úÖ –ü—Ä–æ—Å—Ç—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö: `int x;`
- ‚úÖ –§—É–Ω–∫—Ü–∏–∏ —Å void –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏: `void func(void) { }`
- ‚úÖ C51 interrupt —Ñ—É–Ω–∫—Ü–∏–∏: `void timer_isr(void) interrupt 1 { }`
- ‚úÖ C51 interrupt —Å using: `void ext_int(void) interrupt 0 using 2 { }`
- ‚úÖ –û–±—ä—è–≤–ª–µ–Ω–∏—è void —Ñ—É–Ω–∫—Ü–∏–π: `void func();`
- ‚úÖ –§—É–Ω–∫—Ü–∏–∏ —Å —Ç–µ–ª–æ–º –∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏: `void test() { int x = 5; x = x + 1; }`
- ‚úÖ –§—É–Ω–∫—Ü–∏–∏ —Å return: `int getValue() { return 42; }`

### ‚ùå –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- ‚ùå –§—É–Ω–∫—Ü–∏–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏: `int add(int a) { return a; }`
- ‚ùå –§—É–Ω–∫—Ü–∏–∏ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏: `int add(int a, int b) { return a + b; }`
- ‚ùå –û–±—ä—è–≤–ª–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏: `int add(int a, int b);`

## –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã:

–ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (–Ω–µ void) –≤—Å–µ –µ—â–µ –Ω–µ –ø–∞—Ä—Å—è—Ç—Å—è. –û—à–∏–±–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –ø–∞—Ä—Å–µ—Ä –Ω–µ –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–∫–µ–Ω—ã –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Ö –∫–∞–∫ "–Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –≤ –∫–æ–Ω—Ü–µ –≤–≤–æ–¥–∞".

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ `parse-function-declaration` –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–∞—Ä—Å–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏. –ü—Ä–æ–±–ª–µ–º–∞, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –≤ `parse-parameter-list` –∏–ª–∏ `parse-single-parameter`.

–î–∞–≤–∞–π—Ç–µ —Å–æ–∑–¥–∞–¥–∏–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:

```clojure
(require '[c51cc.parser :as parser])
(require '[c51cc.lexer :as lexer])

(println "=== –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ü–ê–†–ê–ú–ï–¢–†–û–í ===")

;; –¢–µ—Å—Ç–∏—Ä—É–µ–º –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
(defn test-component [name component-fn input]
  (println (str "\n--- " name " ---"))
  (println (str "–í—Ö–æ–¥: " input))
  (let [tokens (lexer/tokenize input)
        state (parser/parse-state tokens)]
    (println (str "–¢–æ–∫–µ–Ω—ã: " tokens))
    (try
      (let [result (component-fn state)]
        (if (:success? result)
          (do
            (println "‚úì –£–°–ü–ï–•")
            (println (str "–†–µ–∑—É–ª—å—Ç–∞—Ç: " (:value result)))
            (println (str "–û—Å—Ç–∞–≤—à–∏–µ—Å—è —Ç–æ–∫–µ–Ω—ã: " (drop (:position (:state result)) tokens))))
          (println (str "‚úó –û–®–ò–ë–ö–ê: " (:error result)))))
      (catch Exception e
        (println (str "‚úó –ò–°–ö–õ–Æ–ß–ï–ù–ò–ï: " (.getMessage e)))))))

;; –¢–µ—Å—Ç–∏—Ä—É–µ–º parse-type-specifier
(test-component "parse-type-specifier" 
                #(parser/parse-type-specifier %) 
                "int")

;; –¢–µ—Å—Ç–∏—Ä—É–µ–º parse-single-parameter
(test-component "parse-single-parameter" 
                #(parser/parse-single-parameter %) 
                "int a")

;; –¢–µ—Å—Ç–∏—Ä—É–µ–º parse-parameter-list —Å –æ–¥–Ω–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º
(test-component "parse-parameter-list (–æ–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä)" 
                #(parser/parse-parameter-list %) 
                "int a")

;; –¢–µ—Å—Ç–∏—Ä—É–µ–º parse-parameter-list —Å –¥–≤—É–º—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
(test-component "parse-parameter-list (–¥–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞)" 
                #(parser/parse-parameter-list %) 
                "int a, int b")

;; –¢–µ—Å—Ç–∏—Ä—É–µ–º parse-parameter-list —Å void
(test-component "parse-parameter-list (void)" 
                #(parser/parse-parameter-list %) 
                "void")

;; –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–ª–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –ø–æ —á–∞—Å—Ç—è–º
(println "\n=== –¢–ï–°–¢ –ü–û–õ–ù–û–ô –§–£–ù–ö–¶–ò–ò –ü–û –ß–ê–°–¢–Ø–ú ===")
(let [code "int add(int a, int b) { return a + b; }"
      tokens (lexer/tokenize code)
      state (parser/parse-state tokens)]
  (println (str "–ü–æ–ª–Ω—ã–π –∫–æ–¥: " code))
  (println (str "–í—Å–µ —Ç–æ–∫–µ–Ω—ã: " tokens))
  
  ;; –ü—Ä–æ–±—É–µ–º –ø–∞—Ä—Å–∏—Ç—å —Ç–∏–ø –≤–æ–∑–≤—Ä–∞—Ç–∞
  (println "\n1. –ü–∞—Ä—Å–∏–º —Ç–∏–ø –≤–æ–∑–≤—Ä–∞—Ç–∞...")
  (let [type-result (parser/parse-type-specifier state)]
    (if (:success? type-result)
      (do
        (println "‚úì –¢–∏–ø –≤–æ–∑–≤—Ä–∞—Ç–∞: " (:value type-result))
        
        ;; –ü—Ä–æ–±—É–µ–º –ø–∞—Ä—Å–∏—Ç—å –∏–º—è —Ñ—É–Ω–∫—Ü–∏–∏
        (println "\n2. –ü–∞—Ä—Å–∏–º –∏–º—è —Ñ—É–Ω–∫—Ü–∏–∏...")
        (let [name-result ((parser/expect-token :identifier) (:state type-result))]
          (if (:success? name-result)
            (do
              (println "‚úì –ò–º—è —Ñ—É–Ω–∫—Ü–∏–∏: " (:value name-result))
              
              ;; –ü—Ä–æ–±—É–µ–º –ø–∞—Ä—Å–∏—Ç—å –æ—Ç–∫—Ä—ã–≤–∞—é—â—É—é —Å–∫–æ–±–∫—É
              (println "\n3. –ü–∞—Ä—Å–∏–º –æ—Ç–∫—Ä—ã–≤–∞—é—â—É—é —Å–∫–æ–±–∫—É...")
              (let [paren-result ((parser/expect-token-value :open-round) (:state name-result))]
                (if (:success? paren-result)
                  (do
                    (println "‚úì –û—Ç–∫—Ä—ã–≤–∞—é—â–∞—è —Å–∫–æ–±–∫–∞ –Ω–∞–π–¥–µ–Ω–∞")
                    
                    ;; –ü—Ä–æ–±—É–µ–º –ø–∞—Ä—Å–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
                    (println "\n4. –ü–∞—Ä—Å–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã...")
                    (let [params-result (parser/parse-parameter-list (:state paren-result))]
                      (if (:success? params-result)
                        (println "‚úì –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: " (:value params-result))
                        (println "‚úó –û—à–∏–±–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: " (:error params-result)))))
                  (println "‚úó –û—à–∏–±–∫–∞ —Å–∫–æ–±–∫–∏: " (:error paren-result)))))
            (println "‚úó –û—à–∏–±–∫–∞ –∏–º–µ–Ω–∏: " (:error name-result)))))
      (println "‚úó –û—à–∏–±–∫–∞ —Ç–∏–ø–∞: " (:error type-result)))))

(println "\n=== –ö–û–ù–ï–¶ –î–ò–ê–ì–ù–û–°–¢–ò–ö–ò ===")
```

–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å —è –Ω–∞—à–µ–ª –ø—Ä–æ–±–ª–µ–º—É! 

## –ü—Ä–æ–±–ª–µ–º–∞ –Ω–∞–π–¥–µ–Ω–∞:

**`parse-parameter-list` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ `[]` –¥–ª—è –≤—Å–µ—Ö —Å–ª—É—á–∞–µ–≤!**

–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- `parse-parameter-list (–æ–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä)` ‚Üí `[]` (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `[{:type ... :name "a"}]`)
- `parse-parameter-list (–¥–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞)` ‚Üí `[]` (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `[{:type ... :name "a"} {:type ... :name "b"}]`)
- `parse-parameter-list (void)` ‚Üí `[]` (—ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ)

–ü—Ä–æ–±–ª–µ–º–∞ –≤ –ª–æ–≥–∏–∫–µ `parse-parameter-list`. –î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é:

–Ø –Ω–∞—à–µ–ª –ø—Ä–æ–±–ª–µ–º—É! –í `parse-parameter-list` –ø–æ—Ä—è–¥–æ–∫ `choice` –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π:

```clojure
(choice
  ;; –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–ª—É—á–∞–π: –æ–¥–∏–Ω–æ—á–Ω—ã–π void
  (do-parse void-token (expect-token-value :void) (return-parser []))
  
  ;; –ü—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤  ‚Üê –≠–¢–û –í–°–ï–ì–î–ê –°–†–ê–ë–ê–¢–´–í–ê–ï–¢ –ü–ï–†–í–´–ú!
  (return-parser [])
  
  ;; –ù–µ–ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤  ‚Üê –≠–¢–û –ù–ò–ö–û–ì–î–ê –ù–ï –î–û–°–¢–ò–ì–ê–ï–¢–°–Ø!
  (do-parse ...))
```

–ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ `(return-parser [])` –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É—Å–ø–µ—Ö, –ø–æ—ç—Ç–æ–º—É `choice` –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–æ—Ö–æ–¥–∏—Ç –¥–æ —Ç—Ä–µ—Ç—å–µ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞.

–î–∞–≤–∞–π—Ç–µ –∏—Å–ø—Ä–∞–≤–∏–º —ç—Ç–æ:

```clojure
(choice
  ;; –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–ª—É—á–∞–π: –æ–¥–∏–Ω–æ—á–Ω—ã–π void
  (do-parse void-token (expect-token-value :void) (return-parser []))
  
  ;; –ü—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤  ‚Üê –≠–¢–û –í–°–ï–ì–î–ê –°–†–ê–ë–ê–¢–´–í–ê–ï–¢ –ü–ï–†–í–´–ú!
  (return-parser [])
  
  ;; –ù–µ–ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤  ‚Üê –≠–¢–û –ù–ò–ö–û–ì–î–ê –ù–ï –î–û–°–¢–ò–ì–ê–ï–¢–°–Ø!
  (do-parse ...))
```

```clojure
(defn parse-parameter-list 
  "–ü–∞—Ä—Å–∏—Ç —Å–ø–∏—Å–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–ª—É—á–∞–π void
   –û–¢–†–ï–§–ê–ö–¢–û–†–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç do-parse –∏ choice –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏
   –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ choice - –Ω–µ–ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–¥ –ø—É—Å—Ç—ã–º"
  [state]
  ((choice
    ;; –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–ª—É—á–∞–π: –æ–¥–∏–Ω–æ—á–Ω—ã–π void
    (do-parse
      void-token (expect-token-value :void)
      (return-parser []))
    
    ;; –ù–µ–ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–µ—Ä–µ–¥ –ø—É—Å—Ç—ã–º!)
    (do-parse
      first-param parse-single-parameter
      rest-params (many (do-parse
                          comma-token (expect-token-value :comma)
                          param parse-single-parameter
                          (return-parser param)))
      (return-parser (cons first-param rest-params)))
    
    ;; –ü—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–∞—Ä–∏–∞–Ω—Ç)
    (return-parser [])) state))
```

–û—Ç–ª–∏—á–Ω–æ! –õ–∏–Ω—Ç–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏ –≤ –º–∞–∫—Ä–æ—Å–µ `do-parse`, —á—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º –Ω–∞—à–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:

üéâ **–û–¢–õ–ò–ß–ù–û! –ü–†–û–ë–õ–ï–ú–ê –ò–°–ü–†–ê–í–õ–ï–ù–ê!**

–¢–µ–ø–µ—Ä—å `parse-parameter-list` —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ:
- ‚úÖ `parse-parameter-list (–æ–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä)` ‚Üí `({:type {:signedness nil, :base-type :int}, :name "a"})`
- ‚úÖ `parse-parameter-list (–¥–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞)` ‚Üí `({:type {:signedness nil, :base-type :int}, :name "a"} {:type {:signedness nil, :base-type :int}, :name "b"})`
- ‚úÖ `parse-parameter-list (void)` ‚Üí `[]`

–ò –ø–æ–ª–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ç–æ–∂–µ –ø–∞—Ä—Å–∏—Ç—Å—è –ø–æ —á–∞—Å—Ç—è–º! –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–ª–Ω—ã–π –ø–∞—Ä—Å–µ—Ä:

# üéâ –ü–†–û–ë–õ–ï–ú–ê –ü–û–õ–ù–û–°–¢–¨–Æ –†–ï–®–ï–ù–ê!

## –ò—Ç–æ–≥–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:

### ‚úÖ –í–°–ï –¢–ï–°–¢–´ –ü–†–û–•–û–î–Ø–¢:

1. **‚úÖ –ü—Ä–æ—Å—Ç—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç** - `void main() { }`
2. **‚úÖ –ü—Ä–æ—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç** - `void func();`
3. **‚úÖ –§—É–Ω–∫—Ü–∏–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Ä–∞–±–æ—Ç–∞—é—Ç** - `int add(int a) { return a; }`
4. **‚úÖ –§—É–Ω–∫—Ü–∏–∏ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Ä–∞–±–æ—Ç–∞—é—Ç** - `int add(int a, int b) { return a + b; }`
5. **‚úÖ C51 interrupt —Ä–∞–±–æ—Ç–∞–µ—Ç** - `void timer_isr(void) interrupt 1 { }`
6. **‚úÖ C51 interrupt —Å using —Ä–∞–±–æ—Ç–∞–µ—Ç** - `void ext_int(void) interrupt 0 using 2 { }`
7. **‚úÖ –û–±—ä—è–≤–ª–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π —Ä–∞–±–æ—Ç–∞—é—Ç** - `int add(int a, int b);`
8. **‚úÖ –§—É–Ω–∫—Ü–∏–∏ —Å —Ç–µ–ª–æ–º –∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏ —Ä–∞–±–æ—Ç–∞—é—Ç** - `void test() { int x = 5; x = x + 1; }`
9. **‚úÖ –ü—Ä–æ—Å—Ç—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞—é—Ç** - `int x;`

## –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

### 1. **–ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ—Ä—è–¥–∫–æ–º –ø–∞—Ä—Å–µ—Ä–æ–≤ –≤ `parse-declaration`**
- **–ë—ã–ª–æ**: `parse-variable-declaration` –ø–∞—Ä—Å–∏–ª—Å—è –ø–µ—Ä–µ–¥ `parse-function-declaration`
- **–°—Ç–∞–ª–æ**: `parse-function-declaration` –ø–∞—Ä—Å–∏—Ç—Å—è –ø–µ—Ä–µ–¥ `parse-variable-declaration`

### 2. **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ `parse-parameter-list`**
- **–ë—ã–ª–æ**: `(return-parser [])` –≤—Å–µ–≥–¥–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–ª –ø–µ—Ä–≤—ã–º –≤ `choice`, –±–ª–æ–∫–∏—Ä—É—è –ø–∞—Ä—Å–∏–Ω–≥ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- **–°—Ç–∞–ª–æ**: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ - —Å–Ω–∞—á–∞–ª–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –ø–æ—Ç–æ–º –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ:

**–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ –ª–æ–≥–∏–∫–µ –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä–∞ `choice`** - –æ–Ω –ø—Ä–æ–±—É–µ—Ç –ø–∞—Ä—Å–µ—Ä—ã –ø–æ –ø–æ—Ä—è–¥–∫—É –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–µ—Ä–≤–æ–≥–æ —É—Å–ø–µ—à–Ω–æ–≥–æ. –ö–æ–≥–¥–∞ `(return-parser [])` —Å—Ç–æ—è–ª –≤—Ç–æ—Ä—ã–º –≤ —Å–ø–∏—Å–∫–µ, –æ–Ω –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–ª —É—Å–ø–µ—Ö —Å –ø—É—Å—Ç—ã–º —Å–ø–∏—Å–∫–æ–º, –ø–æ—ç—Ç–æ–º—É —Ç—Ä–µ—Ç–∏–π –≤–∞—Ä–∏–∞–Ω—Ç (—Ä–µ–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã) –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–æ—Å—Ç–∏–≥–∞–ª—Å—è.

**–ú–∞–∫—Ä–æ—Å `do-parse` —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ** - –ª–∏–Ω—Ç–µ—Ä –ø—Ä–æ—Å—Ç–æ –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç –≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∏–µ –º–∞–∫—Ä–æ—Å—ã, –Ω–æ –∫–æ–¥ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ.

**–õ–µ–∫—Å–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–µ–∫—Ç–æ—Ä —Ç–æ–∫–µ–Ω–æ–≤** - —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –∫–∞–∫ –∏ –±—ã–ª–æ —É–∫–∞–∑–∞–Ω–æ –≤ –∑–∞–¥–∞—á–µ.

–¢–µ–ø–µ—Ä—å –ø–∞—Ä—Å–µ—Ä –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ —Ç—Ä–µ–±—É–µ–º—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ C51!

