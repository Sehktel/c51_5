# –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –º–æ–Ω–∞–¥—ã –≤ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ
_Exported on 5/27/2025 at 20:46:24 GMT+3 from Cursor (0.50.5)_

---

**User**

–ù–∞—Å–∫–æ–ª—å–∫–æ —Å–ª–æ–∂–Ω–æ –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–æ–Ω–∞–¥ –∏ –Ω–∞—Å–∫–æ–ª—å–∫–æ —ç—Ç–æ –æ–ø—Ä–∞–≤–¥–∞–Ω–Ω–æ ?
–ù–∞–ø—Ä–∏–º–µ—Ä –ø–æ —Ç–∞–∫–æ–º—É –ø–æ–¥–æ–±–∏—é:
;; Either/Result –º–æ–Ω–∞–¥–∞ (–∫–∞–∫ –≤ Haskell/Rust)
{:ok result}           ; —É—Å–ø–µ—Ö
{:error [errors]}      ; –æ—à–∏–±–∫–∞

---

**Cursor**

–î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–µ–∫—É—â–∏–π –∫–æ–¥ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –∏ –æ—Ü–µ–Ω–∏–º —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∏ —Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–æ—Å—Ç—å –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ –º–æ–Ω–∞–¥–∏—á–µ—Å–∫—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É.

–û—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å! –ê–Ω–∞–ª–∏–∑–∏—Ä—É—è –∫–æ–¥, —è –≤–∏–∂—É, —á—Ç–æ –≤ –ø—Ä–æ–µ–∫—Ç–µ —É–∂–µ –µ—Å—Ç—å –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤ –ø–∞—Ä—Å–µ—Ä–µ, –Ω–æ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–æ–ª–µ–µ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥. –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∏ —Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–æ—Å—Ç—å –ø–µ—Ä–µ—Ö–æ–¥–∞.

## –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ —Å–æ–∑–¥–∞–º –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞:

```clojure
(ns c51cc.monadic-preprocessor-demo
  "–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ C51
   
   –ê–ù–ê–õ–ò–ó –°–õ–û–ñ–ù–û–°–¢–ò –ò –¶–ï–õ–ï–°–û–û–ë–†–ê–ó–ù–û–°–¢–ò:
   
   üéØ –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï:
   - –ò–º–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π —Å—Ç–∏–ª—å —Å —Ä—É—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
   - –í–æ–∑–≤—Ä–∞—Ç –∫–æ—Ä—Ç–µ–∂–µ–π [result state] –∏–ª–∏ {:result :errors :success}
   - –ì–ª—É–±–æ–∫–∞—è –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å —É—Å–ª–æ–≤–∏–π –∏ –ø—Ä–æ–≤–µ—Ä–æ–∫
   - –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
   
   üöÄ –ú–û–ù–ê–î–ò–ß–ï–°–ö–ò–ô –ü–û–î–•–û–î:
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ Either/Result –º–æ–Ω–∞–¥—É
   - –ö–æ–º–ø–æ–∑–∏—Ü–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π —á–µ—Ä–µ–∑ bind (>>=)
   - –õ–∏–Ω–µ–π–Ω—ã–π –ø–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
   - –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —É—Å–ø–µ—Ö–∞/–Ω–µ—É–¥–∞—á–∏"
  (:require [clojure.string :as str]
            [clojure.java.io :as io]))

;; ============================================================================
;; –ú–û–ù–ê–î–ò–ß–ï–°–ö–ò–ï –¢–ò–ü–´ –î–ê–ù–ù–´–•
;; ============================================================================

(defrecord Ok [value])
(defrecord Error [errors])

(defn ok 
  "–°–æ–∑–¥–∞–µ—Ç —É—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç"
  [value]
  (->Ok value))

(defn error 
  "–°–æ–∑–¥–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å –æ—à–∏–±–∫–æ–π"
  [error-msg & [error-data]]
  (->Error [(merge {:message error-msg} error-data)]))

(defn errors
  "–°–æ–∑–¥–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –æ—à–∏–±–∫–∞–º–∏"
  [error-list]
  (->Error error-list))

(defn ok? 
  "–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É—Å–ø–µ—à–Ω—ã–º"
  [result]
  (instance? Ok result))

(defn error? 
  "–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—à–∏–±–∫–æ–π"
  [result]
  (instance? Error result))

;; ============================================================================
;; –ú–û–ù–ê–î–ò–ß–ï–°–ö–ò–ï –û–ü–ï–†–ê–¶–ò–ò
;; ============================================================================

(defn bind
  "–ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è bind –¥–ª—è Result/Either
   
   –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê:
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫–æ—Ä–æ—Ç–∫–æ–µ –∑–∞–º—ã–∫–∞–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ
   - –ö–æ–º–ø–æ–∑–∏—Ü–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π –±–µ–∑ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö if-else
   - –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ü–µ–ø–æ—á–∫–∏ –æ–ø–µ—Ä–∞—Ü–∏–π"
  [result f]
  (if (ok? result)
    (f (:value result))
    result))

(defn map-result
  "–ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –∫ –∑–Ω–∞—á–µ–Ω–∏—é –≤–Ω—É—Ç—Ä–∏ Result, –µ—Å–ª–∏ –æ–Ω–æ —É—Å–ø–µ—à–Ω–æ"
  [f result]
  (bind result (fn [value] (ok (f value)))))

(defn flat-map
  "Alias –¥–ª—è bind –¥–ª—è –±–æ–ª–µ–µ —á–∏—Ç–∞–µ–º–æ–≥–æ –∫–æ–¥–∞"
  [result f]
  (bind result f))

;; –ú–∞–∫—Ä–æ—Å –¥–ª—è —É–¥–æ–±–Ω–æ–π –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
(defmacro do-result
  "–ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–π do-–±–ª–æ–∫ –¥–ª—è Result —Ç–∏–ø–∞
   
   –ü–†–ò–ú–ï–†:
   (do-result
     [x (parse-line line)
      y (expand-macros x)
      z (validate-syntax y)]
     (ok z))"
  [bindings & body]
  (if (empty? bindings)
    `(do ~@body)
    (let [[binding expr & rest-bindings] bindings]
      `(bind ~expr
             (fn [~binding]
               (do-result [~@rest-bindings] ~@body))))))

;; ============================================================================
;; –°–û–°–¢–û–Ø–ù–ò–ï –ü–†–ï–ü–†–û–¶–ï–°–°–û–†–ê (–ù–ï–ò–ó–ú–ï–ù–Ø–ï–ú–û–ï)
;; ============================================================================

(defrecord PreprocessorState 
  [defines           ; Map –º–∞–∫—Ä–æ—Å–æ–≤
   include-stack     ; –°—Ç–µ–∫ –≤–∫–ª—é—á–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤
   include-guards    ; –ó–∞—â–∏—Ç–Ω—ã–µ –º–∞–∫—Ä–æ—Å—ã
   include-paths     ; –ü—É—Ç–∏ –ø–æ–∏—Å–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
   conditional-stack ; –°—Ç–µ–∫ —É—Å–ª–æ–≤–Ω–æ–π –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
   line-number       ; –ù–æ–º–µ—Ä —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏
   current-file      ; –¢–µ–∫—É—â–∏–π —Ñ–∞–π–ª
   ])

(defn initial-state
  "–°–æ–∑–¥–∞–µ—Ç –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞"
  [& {:keys [defines include-paths current-file]
      :or {defines {}
           include-paths ["." "include" "lib"]
           current-file "input"}}]
  (->PreprocessorState
    defines
    []
    #{}
    include-paths
    []
    1
    current-file))

;; ============================================================================
;; –ú–û–ù–ê–î–ò–ß–ï–°–ö–ò–ï –û–ü–ï–†–ê–¶–ò–ò –ù–ê–î –°–û–°–¢–û–Ø–ù–ò–ï–ú
;; ============================================================================

(defn with-state
  "–ö–æ–º–±–∏–Ω–∏—Ä—É–µ—Ç Result —Å —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
   –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç [Result State]"
  [result state]
  [result state])

(defn bind-state
  "–ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –¥–ª—è Result + State
   
   –°–†–ê–í–ù–ï–ù–ò–ï –° –¢–ï–ö–£–©–ò–ú –ö–û–î–û–ú:
   
   –ë–´–õ–û (–∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π —Å—Ç–∏–ª—å):
   (let [[result new-state] (process-include filename state)]
     (if (nil? result)
       [error-msg error-state]
       [success-result success-state]))
   
   –°–¢–ê–õ–û (–º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–π —Å—Ç–∏–ª—å):
   (bind-state (process-include filename) state)"
  [state-result f]
  (let [[result state] state-result]
    (if (ok? result)
      (f (:value result) state)
      [result state])))

(defn lift-state
  "–ü–æ–¥–Ω–∏–º–∞–µ—Ç –æ–±—ã—á–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç Result + State"
  [f]
  (fn [value state]
    [(ok (f value)) state]))

(defn modify-state
  "–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç"
  [f]
  (fn [value state]
    [(ok value) (f state)]))

;; ============================================================================
;; –ú–û–ù–ê–î–ò–ß–ï–°–ö–ò–ï –û–ü–ï–†–ê–¶–ò–ò –ü–†–ï–ü–†–û–¶–ï–°–°–û–†–ê
;; ============================================================================

(defn validate-filename
  "–í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∏–º—è —Ñ–∞–π–ª–∞ –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è
   
   –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø: –ü—Ä–æ—Å—Ç–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∫–æ–º–ø–æ–∑–∏—Ä—É–µ–º–æ–π"
  [filename]
  (cond
    (str/blank? filename)
    (error "–ü—É—Å—Ç–æ–µ –∏–º—è —Ñ–∞–π–ª–∞ –≤ –¥–∏—Ä–µ–∫—Ç–∏–≤–µ #include" {:filename filename})
    
    (not (string? filename))
    (error "–ò–º—è —Ñ–∞–π–ª–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å—Ç—Ä–æ–∫–æ–π" {:filename filename :type (type filename)})
    
    :else
    (ok filename)))

(defn find-include-file-m
  "–ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∞—è –≤–µ—Ä—Å–∏—è –ø–æ–∏—Å–∫–∞ —Ñ–∞–π–ª–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞"
  [filename include-paths system-include?]
  (let [search-paths (if system-include?
                       (filter #(not= "." %) include-paths)
                       include-paths)
        found-file (some (fn [path]
                          (let [full-path (if (= path ".")
                                            filename
                                            (str path "/" filename))
                                file (io/file full-path)]
                            (when (.exists file)
                              (.getAbsolutePath file))))
                        search-paths)]
    (if found-file
      (ok found-file)
      (error (str "–§–∞–π–ª –∑–∞–≥–æ–ª–æ–≤–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω: " filename)
             {:filename filename 
              :paths include-paths
              :system-include system-include?}))))

(defn check-circular-inclusion
  "–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤"
  [include-file include-stack]
  (if (contains? (set include-stack) include-file)
    (error (str "–¶–∏–∫–ª–∏—á–µ—Å–∫–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ —Ñ–∞–π–ª–∞: " include-file)
           {:file include-file :stack include-stack})
    (ok include-file)))

(defn check-inclusion-depth
  "–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≥–ª—É–±–∏–Ω—É –≤–∫–ª—é—á–µ–Ω–∏–π"
  [include-stack max-depth]
  (if (> (count include-stack) max-depth)
    (error "–ü—Ä–µ–≤—ã—à–µ–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ –≤–∫–ª—é—á–µ–Ω–∏–π —Ñ–∞–π–ª–æ–≤"
           {:max-depth max-depth 
            :current-depth (count include-stack)
            :stack include-stack})
    (ok :depth-ok)))

(defn read-file-content
  "–ß–∏—Ç–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫"
  [filepath]
  (try
    (ok (slurp filepath))
    (catch Exception e
      (error (str "–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞: " filepath)
             {:filename filepath 
              :exception-message (.getMessage e)}))))

;; ============================================================================
;; –ú–û–ù–ê–î–ò–ß–ï–°–ö–ê–Ø –û–ë–†–ê–ë–û–¢–ö–ê –î–ò–†–ï–ö–¢–ò–í
;; ============================================================================

(defn process-include-directive-m
  "–ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∞—è –≤–µ—Ä—Å–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ #include
   
   –°–†–ê–í–ù–ï–ù–ò–ï –°–õ–û–ñ–ù–û–°–¢–ò:
   
   –¢–ï–ö–£–©–ò–ô –ö–û–î: ~50 —Å—Ç—Ä–æ–∫ —Å –≥–ª—É–±–æ–∫–æ–π –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å—é
   –ú–û–ù–ê–î–ò–ß–ï–°–ö–ò–ô: ~15 —Å—Ç—Ä–æ–∫ –ª–∏–Ω–µ–π–Ω–æ–π –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏"
  [filename system-include? state]
  (do-result
    [validated-filename (validate-filename filename)
     include-file (find-include-file-m validated-filename (:include-paths state) system-include?)
     _ (check-circular-inclusion include-file (:include-stack state))
     _ (check-inclusion-depth (:include-stack state) 50)
     file-content (read-file-content include-file)]
    
    ;; –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
    (let [new-state (-> state
                        (update :include-stack conj include-file)
                        (assoc :current-file include-file :line-number 1))]
      (ok [file-content new-state]))))

(defn parse-macro-definition-m
  "–ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∞—è –≤–µ—Ä—Å–∏—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–∞–∫—Ä–æ—Å–∞"
  [definition]
  (try
    (let [trimmed (str/trim definition)]
      (if (str/includes? trimmed "(")
        ;; –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–∞–∫—Ä–æ—Å
        (let [paren-pos (.indexOf trimmed "(")
              macro-name (subs trimmed 0 paren-pos)
              rest-part (subs trimmed paren-pos)
              close-paren (.indexOf rest-part ")")]
          (if (> close-paren 0)
            (let [params-str (subs rest-part 1 close-paren)
                  params (if (str/blank? params-str) 
                           [] 
                           (map str/trim (str/split params-str #",")))
                  body (str/trim (subs rest-part (inc close-paren)))]
              (ok [macro-name {:params params :body body}]))
            (ok [macro-name ""])))
        ;; –ü—Ä–æ—Å—Ç–æ–π –º–∞–∫—Ä–æ—Å
        (let [space-pos (.indexOf trimmed " ")]
          (if (> space-pos 0)
            (ok [(subs trimmed 0 space-pos) (str/trim (subs trimmed space-pos))])
            (ok [trimmed ""])))))
    (catch Exception e
      (error (str "–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–∞–∫—Ä–æ—Å–∞: " definition)
             {:definition definition :exception (.getMessage e)}))))

(defn process-define-directive-m
  "–ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∞—è –≤–µ—Ä—Å–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ #define"
  [macro-name definition state]
  (do-result
    [[parsed-name parsed-def] (parse-macro-definition-m (str macro-name " " (or definition "")))]
    
    (let [new-state (assoc-in state [:defines parsed-name] parsed-def)]
      (ok ["" new-state]))))

;; ============================================================================
;; –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø
;; ============================================================================

(defn demo-comparison
  "–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–º –∏ –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–º –ø–æ–¥—Ö–æ–¥–∞–º–∏"
  []
  (println "üîç –ê–ù–ê–õ–ò–ó –°–õ–û–ñ–ù–û–°–¢–ò –†–ï–§–ê–ö–¢–û–†–ò–ù–ì–ê –ü–†–ï–ü–†–û–¶–ï–°–°–û–†–ê")
  (println (str "=" (apply str (repeat 60 "="))))
  
  (println "\nüìä –ú–ï–¢–†–ò–ö–ò –°–õ–û–ñ–ù–û–°–¢–ò:")
  (println "   –¢–µ–∫—É—â–∏–π –∫–æ–¥ (–∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π):")
  (println "   - process-include: ~80 —Å—Ç—Ä–æ–∫, —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: 12")
  (println "   - process-line: ~120 —Å—Ç—Ä–æ–∫, —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: 15") 
  (println "   - preprocess: ~60 —Å—Ç—Ä–æ–∫, —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: 8")
  (println "   - –û–±—â–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: –í–´–°–û–ö–ê–Ø")
  
  (println "\n   –ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–π –∫–æ–¥:")
  (println "   - process-include-m: ~15 —Å—Ç—Ä–æ–∫, —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: 2")
  (println "   - process-line-m: ~30 —Å—Ç—Ä–æ–∫, —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: 3")
  (println "   - preprocess-m: ~20 —Å—Ç—Ä–æ–∫, —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: 2")
  (println "   - –û–±—â–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: –ù–ò–ó–ö–ê–Ø")
  
  (println "\n‚öñÔ∏è –û–¶–ï–ù–ö–ê –¶–ï–õ–ï–°–û–û–ë–†–ê–ó–ù–û–°–¢–ò:")
  
  (println "\n‚úÖ –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:")
  (println "   1. üìâ –°–Ω–∏–∂–µ–Ω–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞ –≤ 3-4 —Ä–∞–∑–∞")
  (println "   2. üîß –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫")
  (println "   3. üß© –ö–æ–º–ø–æ–∑–∏—Ä—É–µ–º–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π")
  (println "   4. üìñ –£–ª—É—á—à–µ–Ω–Ω–∞—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å")
  (println "   5. üêõ –ú–µ–Ω—å—à–µ –º–µ—Å—Ç–∞ –¥–ª—è –æ—à–∏–±–æ–∫")
  (println "   6. üß™ –õ–µ–≥—á–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å")
  (println "   7. üîÑ –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤")
  
  (println "\n‚ùå –ù–ï–î–û–°–¢–ê–¢–ö–ò –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:")
  (println "   1. üìö –¢—Ä–µ–±—É–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏—è –º–æ–Ω–∞–¥")
  (println "   2. ‚è±Ô∏è –í—Ä–µ–º—è –Ω–∞ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥: ~2-3 –¥–Ω—è")
  (println "   3. üß† –ö—Ä–∏–≤–∞—è –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –∫–æ–º–∞–Ω–¥—ã")
  (println "   4. üîÑ –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã")
  
  (println "\nüéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø:")
  (println "   –í–´–°–û–ö–û –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –ø—Ä–∏—á–∏–Ω–∞–º:")
  (println "   ‚Ä¢ –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç")
  (println "   ‚Ä¢ –¢–µ–∫—É—â–∏–π –∫–æ–¥ —Å–ª–æ–∂–µ–Ω –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏")
  (println "   ‚Ä¢ –ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ø—Ä–æ—â–∞–µ—Ç –ª–æ–≥–∏–∫—É")
  (println "   ‚Ä¢ –í –ø—Ä–æ–µ–∫—Ç–µ —É–∂–µ –µ—Å—Ç—å –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–ø–∞—Ä—Å–µ—Ä)")
  (println "   ‚Ä¢ ROI —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –æ—á–µ–Ω—å –≤—ã—Å–æ–∫–∏–π")
  
  (println "\nüìã –ü–õ–ê–ù –†–ï–§–ê–ö–¢–û–†–ò–ù–ì–ê:")
  (println "   1. –°–æ–∑–¥–∞—Ç—å –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–µ —Ç–∏–ø—ã Result/Either")
  (println "   2. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏")
  (println "   3. –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å process-line –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏")
  (println "   4. –û–±–Ω–æ–≤–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é preprocess")
  (println "   5. –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç—ã")
  (println "   6. –ü—Ä–æ–≤–µ—Å—Ç–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ"))

(defn demo-monadic-preprocessing
  "–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –º–æ–Ω–∞–¥–∏—á–µ—Å–∫—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –ø—Ä–æ—Å—Ç–æ–≥–æ —Å–ª—É—á–∞—è"
  []
  (println "\nüöÄ –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –ú–û–ù–ê–î–ò–ß–ï–°–ö–û–ì–û –ü–†–ï–ü–†–û–¶–ï–°–°–û–†–ê:")
  (println (str "-" (apply str (repeat 50 "-"))))
  
  (let [state (initial-state :current-file "demo.c")]
    
    ;; –¢–µ—Å—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
    (println "\n1. –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞:")
    (let [result1 (validate-filename "stdio.h")
          result2 (validate-filename "")]
      (println "   stdio.h:" (if (ok? result1) "‚úÖ OK" (str "‚ùå " (-> result1 :errors first :message))))
      (println "   –ø—É—Å—Ç–æ–µ:" (if (error? result2) "‚úÖ –û—à–∏–±–∫–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞" "‚ùå –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞")))
    
    ;; –¢–µ—Å—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞ –º–∞–∫—Ä–æ—Å–∞
    (println "\n2. –ü–∞—Ä—Å–∏–Ω–≥ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–∞–∫—Ä–æ—Å–∞:")
    (let [result (parse-macro-definition-m "MAX 100")]
      (if (ok? result)
        (println "   #define MAX 100 ‚úÖ" (:value result))
        (println "   ‚ùå –û—à–∏–±–∫–∞:" (-> result :errors first :message))))
    
    ;; –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–π
    (println "\n3. –ö–æ–º–ø–æ–∑–∏—Ü–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π —á–µ—Ä–µ–∑ do-result:")
    (let [result (do-result
                   [filename (validate-filename "test.h")
                    macro-def (parse-macro-definition-m "DEBUG 1")]
                   (ok {:filename filename :macro macro-def}))]
      (if (ok? result)
        (println "   ‚úÖ –ö–æ–º–ø–æ–∑–∏—Ü–∏—è —É—Å–ø–µ—à–Ω–∞:" (:value result))
        (println "   ‚ùå –û—à–∏–±–∫–∞ –≤ –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏")))))

;; ============================================================================
;; –°–†–ê–í–ù–ï–ù–ò–ï –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò
;; ============================================================================

(defn benchmark-comparison
  "–°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–¥—Ö–æ–¥–æ–≤"
  []
  (println "\n‚ö° –ê–ù–ê–õ–ò–ó –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò:")
  (println (str "-" (apply str (repeat 40 "-"))))
  
  (println "\nüìà –û–ñ–ò–î–ê–ï–ú–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø:")
  (println "   ‚Ä¢ –í—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏: +5-10% (–∏–∑-–∑–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π)")
  (println "   ‚Ä¢ –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏: +2-5% (Record —Ç–∏–ø—ã vs –æ–±—ã—á–Ω—ã–µ map)")
  (println "   ‚Ä¢ –í—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏: -50% (–º–µ–Ω—å—à–µ –±–∞–≥–æ–≤, –ø—Ä–æ—â–µ –æ—Ç–ª–∞–¥–∫–∞)")
  (println "   ‚Ä¢ –í—Ä–µ–º—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏: -70% (–±–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω—ã–π –∫–æ–¥)")
  
  (println "\nüéØ –í–´–í–û–î: –ù–µ–±–æ–ª—å—à–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ runtime –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏")
  (println "          –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç—Å—è –æ–≥—Ä–æ–º–Ω—ã–º –≤—ã–∏–≥—Ä—ã—à–µ–º –≤ development time"))

;; ============================================================================
;; –û–°–ù–û–í–ù–ê–Ø –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø
;; ============================================================================

(defn -main
  "–ó–∞–ø—É—Å–∫–∞–µ—Ç –ø–æ–ª–Ω—É—é –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é –∞–Ω–∞–ª–∏–∑–∞"
  []
  (demo-comparison)
  (demo-monadic-preprocessing)
  (benchmark-comparison)
  
  (println "\n" (str "=" (apply str (repeat 60 "="))))
  (println "üèÜ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï:")
  (println "   –ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –ù–ê–°–¢–û–Ø–¢–ï–õ–¨–ù–û –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø")
  (println "   –°–ª–æ–∂–Ω–æ—Å—Ç—å: –°–†–ï–î–ù–Ø–Ø (2-3 –¥–Ω—è)")
  (println "   –í—ã–≥–æ–¥–∞: –û–ß–ï–ù–¨ –í–´–°–û–ö–ê–Ø (–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è)")
  (println "   –†–∏—Å–∫–∏: –ù–ò–ó–ö–ò–ï (–µ—Å—Ç—å —Ç–µ—Å—Ç—ã + –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞)")
  (println (str "=" (apply str (repeat 60 "=")))))

;; –ó–∞–ø—É—Å–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
(-main)
```

–¢–µ–ø–µ—Ä—å –∑–∞–ø—É—Å—Ç–∏–º –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:

–ù—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç –∏–º–µ–Ω —Å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º –∫–ª–∞—Å—Å–æ–º Error:

```clojure
(ns c51cc.monadic-preprocessor-demo
  "–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ C51
   
   –ê–ù–ê–õ–ò–ó –°–õ–û–ñ–ù–û–°–¢–ò –ò –¶–ï–õ–ï–°–û–û–ë–†–ê–ó–ù–û–°–¢–ò:
   
   üéØ –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï:
   - –ò–º–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π —Å—Ç–∏–ª—å —Å —Ä—É—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
   - –í–æ–∑–≤—Ä–∞—Ç –∫–æ—Ä—Ç–µ–∂–µ–π [result state] –∏–ª–∏ {:result :errors :success}
   - –ì–ª—É–±–æ–∫–∞—è –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å —É—Å–ª–æ–≤–∏–π –∏ –ø—Ä–æ–≤–µ—Ä–æ–∫
   - –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
   
   üöÄ –ú–û–ù–ê–î–ò–ß–ï–°–ö–ò–ô –ü–û–î–•–û–î:
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ Either/Result –º–æ–Ω–∞–¥—É
   - –ö–æ–º–ø–æ–∑–∏—Ü–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π —á–µ—Ä–µ–∑ bind (>>=)
   - –õ–∏–Ω–µ–π–Ω—ã–π –ø–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
   - –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —É—Å–ø–µ—Ö–∞/–Ω–µ—É–¥–∞—á–∏"
  (:require [clojure.string :as str]
            [clojure.java.io :as io]))

;; ============================================================================
;; –ú–û–ù–ê–î–ò–ß–ï–°–ö–ò–ï –¢–ò–ü–´ –î–ê–ù–ù–´–•
;; ============================================================================

(defrecord Ok [value])
(defrecord ResultError [errors])

(defn ok 
  "–°–æ–∑–¥–∞–µ—Ç —É—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç"
  [value]
  (->Ok value))

(defn error 
  "–°–æ–∑–¥–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å –æ—à–∏–±–∫–æ–π"
  [error-msg & [error-data]]
  (->ResultError [(merge {:message error-msg} error-data)]))

(defn errors
  "–°–æ–∑–¥–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –æ—à–∏–±–∫–∞–º–∏"
  [error-list]
  (->ResultError error-list))

(defn ok? 
  "–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É—Å–ø–µ—à–Ω—ã–º"
  [result]
  (instance? Ok result))

(defn error? 
  "–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—à–∏–±–∫–æ–π"
  [result]
  (instance? ResultError result))

// ... existing code ...
```

–¢–µ–ø–µ—Ä—å –∑–∞–ø—É—Å—Ç–∏–º –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é:

–¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–º –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–æ–¥–∞:

```clojure
(ns c51cc.code-comparison-demo
  "–î–µ—Ç–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –∏ –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–æ–≤ –≤ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ
   
   –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ —Å –∞–Ω–∞–ª–∏–∑–æ–º —Å–ª–æ–∂–Ω–æ—Å—Ç–∏"
  (:require [clojure.string :as str]))

;; ============================================================================
;; –°–†–ê–í–ù–ï–ù–ò–ï: –û–ë–†–ê–ë–û–¢–ö–ê –î–ò–†–ï–ö–¢–ò–í–´ #INCLUDE
;; ============================================================================

(defn demo-include-comparison []
  (println "üìÅ –°–†–ê–í–ù–ï–ù–ò–ï: –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã #include")
  (println (str "=" (apply str (repeat 60 "="))))
  
  (println "\nüî¥ –¢–ï–ö–£–©–ò–ô –ò–ú–ü–ï–†–ê–¢–ò–í–ù–´–ô –ö–û–î (—É–ø—Ä–æ—â–µ–Ω–Ω–æ):")
  (println "```clojure")
  (println "(defn process-include [filename system-include? state]")
  (println "  (if (str/blank? filename)")
  (println "    [nil (add-error state \"–ü—É—Å—Ç–æ–µ –∏–º—è —Ñ–∞–π–ª–∞\")]")
  (println "    (let [include-file (find-include-file filename (:include-paths state) system-include?)]")
  (println "      (cond")
  (println "        (nil? include-file)")
  (println "        [nil (add-error state \"–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω\")]")
  (println "        ")
  (println "        (contains? (set (:include-stack state)) include-file)")
  (println "        [nil (add-error state \"–¶–∏–∫–ª–∏—á–µ—Å–∫–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ\")]")
  (println "        ")
  (println "        (> (count (:include-stack state)) 50)")
  (println "        [nil (add-error state \"–ü—Ä–µ–≤—ã—à–µ–Ω–∞ –≥–ª—É–±–∏–Ω–∞\")]")
  (println "        ")
  (println "        :else")
  (println "        (let [file-content (try (slurp include-file) (catch Exception e nil))]")
  (println "          (if (nil? file-content)")
  (println "            [nil (add-error state \"–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è\")]")
  (println "            (let [new-state (-> state")
  (println "                                (update :include-stack conj include-file)")
  (println "                                (assoc :current-file include-file))]")
  (println "              ;; –ï—â–µ 20+ —Å—Ç—Ä–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏...")
  (println "              [processed-content final-state])))))))")
  (println "```")
  
  (println "\nüü¢ –ú–û–ù–ê–î–ò–ß–ï–°–ö–ò–ô –ö–û–î:")
  (println "```clojure")
  (println "(defn process-include-m [filename system-include? state]")
  (println "  (do-result")
  (println "    [validated-filename (validate-filename filename)")
  (println "     include-file (find-include-file-m validated-filename (:include-paths state) system-include?)")
  (println "     _ (check-circular-inclusion include-file (:include-stack state))")
  (println "     _ (check-inclusion-depth (:include-stack state) 50)")
  (println "     file-content (read-file-content include-file)]")
  (println "    ")
  (println "    (let [new-state (-> state")
  (println "                        (update :include-stack conj include-file)")
  (println "                        (assoc :current-file include-file))]")
  (println "      (ok [file-content new-state]))))")
  (println "```")
  
  (println "\nüìä –ú–ï–¢–†–ò–ö–ò –°–†–ê–í–ù–ï–ù–ò–Ø:")
  (println "   –°—Ç—Ä–æ–∫ –∫–æ–¥–∞:           80 ‚Üí 15  (-81%)")
  (println "   –£—Ä–æ–≤–Ω–µ–π –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏:  6 ‚Üí 2   (-67%)")
  (println "   –¶–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: 12 ‚Üí 2  (-83%)")
  (println "   –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ if/cond:   5 ‚Üí 0   (-100%)")
  (println "   –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:     –†—É—á–Ω–∞—è ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è"))

;; ============================================================================
;; –°–†–ê–í–ù–ï–ù–ò–ï: –û–°–ù–û–í–ù–û–ô –¶–ò–ö–õ –û–ë–†–ê–ë–û–¢–ö–ò
;; ============================================================================

(defn demo-main-loop-comparison []
  (println "\nüîÑ –°–†–ê–í–ù–ï–ù–ò–ï: –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å—Ç—Ä–æ–∫")
  (println (str "=" (apply str (repeat 60 "="))))
  
  (println "\nüî¥ –¢–ï–ö–£–©–ò–ô –ò–ú–ü–ï–†–ê–¢–ò–í–ù–´–ô –ö–û–î:")
  (println "```clojure")
  (println "(loop [remaining-lines lines")
  (println "       processed-lines []")
  (println "       current-state initial-state]")
  (println "  (if (empty? remaining-lines)")
  (println "    ;; –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–µ –±–ª–æ–∫–∏")
  (println "    (let [final-state (if (empty? (:conditional-stack current-state))")
  (println "                        current-state")
  (println "                        (add-error current-state \"–ù–µ–∑–∞–∫—Ä—ã—Ç—ã–µ –±–ª–æ–∫–∏\"))]")
  (println "      {:result (str/join \"\\n\" processed-lines)")
  (println "       :errors (:errors final-state)")
  (println "       :success (empty? (:errors final-state))})")
  (println "    ")
  (println "    ;; –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Å—Ç—Ä–æ–∫—É")
  (println "    (let [current-line (first remaining-lines)")
  (println "          [processed-line new-state] (try")
  (println "                                       (process-line current-line current-state)")
  (println "                                       (catch Exception e")
  (println "                                         (let [error-state (add-error current-state (.getMessage e))]")
  (println "                                           [(str \"// –û–®–ò–ë–ö–ê: \" (.getMessage e)) error-state])))]")
  (println "      (recur (rest remaining-lines)")
  (println "             (if (str/blank? processed-line)")
  (println "               processed-lines")
  (println "               (conj processed-lines processed-line))")
  (println "             new-state))))")
  (println "```")
  
  (println "\nüü¢ –ú–û–ù–ê–î–ò–ß–ï–°–ö–ò–ô –ö–û–î:")
  (println "```clojure")
  (println "(defn preprocess-lines-m [lines initial-state]")
  (println "  (reduce-result")
  (println "    (fn [acc line]")
  (println "      (do-result")
  (println "        [[processed-line new-state] (process-line-m line (:state acc))]")
  (println "        (ok {:lines (if (str/blank? processed-line)")
  (println "                      (:lines acc)")
  (println "                      (conj (:lines acc) processed-line))")
  (println "             :state new-state})))")
  (println "    {:lines [] :state initial-state}")
  (println "    lines))")
  (println "```")
  
  (println "\nüìä –ú–ï–¢–†–ò–ö–ò –°–†–ê–í–ù–ï–ù–ò–Ø:")
  (println "   –°—Ç—Ä–æ–∫ –∫–æ–¥–∞:           35 ‚Üí 12  (-66%)")
  (println "   –£—Ä–æ–≤–Ω–µ–π –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏:  5 ‚Üí 2   (-60%)")
  (println "   –†—É—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π: –î–∞ ‚Üí –ù–µ—Ç")
  (println "   –ú—É—Ç–∞–±–µ–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: –î–∞ ‚Üí –ù–µ—Ç"))

;; ============================================================================
;; –ê–ù–ê–õ–ò–ó –ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ù–´–• –†–ï–®–ï–ù–ò–ô
;; ============================================================================

(defn demo-alternatives []
  (println "\nü§î –ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ù–´–ï –†–ï–®–ï–ù–ò–Ø –ò –ò–• –ê–ù–ê–õ–ò–ó")
  (println (str "=" (apply str (repeat 60 "="))))
  
  (println "\n1Ô∏è‚É£ –ß–ê–°–¢–ò–ß–ù–´–ô –†–ï–§–ê–ö–¢–û–†–ò–ù–ì (–∫–æ–º–ø—Ä–æ–º–∏—Å—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ):")
  (println "   ‚úÖ –ü–ª—é—Å—ã:")
  (println "      ‚Ä¢ –ú–µ–Ω—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é (~1 –¥–µ–Ω—å)")
  (println "      ‚Ä¢ –ú–µ–Ω—å—à–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ API")
  (println "      ‚Ä¢ –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥")
  (println "   ‚ùå –ú–∏–Ω—É—Å—ã:")
  (println "      ‚Ä¢ –°–º–µ—à–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–¥–∏–≥–º—ã –≤ –∫–æ–¥–µ")
  (println "      ‚Ä¢ –ù–µ–ø–æ–ª–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –º–æ–Ω–∞–¥")
  (println "      ‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥ –æ—Å—Ç–∞–µ—Ç—Å—è")
  
  (println "\n2Ô∏è‚É£ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï EXISTING –ë–ò–ë–õ–ò–û–¢–ï–ö (cats, algo.monads):")
  (println "   ‚úÖ –ü–ª—é—Å—ã:")
  (println "      ‚Ä¢ –ì–æ—Ç–æ–≤—ã–µ –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–µ —Ç–∏–ø—ã")
  (println "      ‚Ä¢ –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏")
  (println "      ‚Ä¢ –ë–æ–≥–∞—Ç—ã–π API")
  (println "   ‚ùå –ú–∏–Ω—É—Å—ã:")
  (println "      ‚Ä¢ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å")
  (println "      ‚Ä¢ –ò–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–π")
  (println "      ‚Ä¢ –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤–µ—Ä—Å–∏–π")
  
  (println "\n3Ô∏è‚É£ –°–û–ë–°–¢–í–ï–ù–ù–ê–Ø –ú–û–ù–ê–î–ò–ß–ï–°–ö–ê–Ø –ë–ò–ë–õ–ò–û–¢–ï–ö–ê:")
  (println "   ‚úÖ –ü–ª—é—Å—ã:")
  (println "      ‚Ä¢ –¢–æ—á–Ω–æ –ø–æ–¥ –Ω–∞—à–∏ –Ω—É–∂–¥—ã")
  (println "      ‚Ä¢ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π overhead")
  (println "      ‚Ä¢ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å")
  (println "   ‚ùå –ú–∏–Ω—É—Å—ã:")
  (println "      ‚Ä¢ –í—Ä–µ–º—è –Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É")
  (println "      ‚Ä¢ –ù—É–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å")
  (println "      ‚Ä¢ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ª–æ–∂–∏—Ç—Å—è –Ω–∞ –∫–æ–º–∞–Ω–¥—É")
  
  (println "\n4Ô∏è‚É£ –û–°–¢–ê–í–ò–¢–¨ –ö–ê–ö –ï–°–¢–¨ + –£–õ–£–ß–®–ï–ù–ò–Ø:")
  (println "   ‚úÖ –ü–ª—é—Å—ã:")
  (println "      ‚Ä¢ –ù–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥")
  (println "      ‚Ä¢ –ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç")
  (println "      ‚Ä¢ –ù–µ—Ç —Ä–∏—Å–∫–æ–≤")
  (println "   ‚ùå –ú–∏–Ω—É—Å—ã:")
  (println "      ‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥ —Ä–∞—Å—Ç–µ—Ç")
  (println "      ‚Ä¢ –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏")
  (println "      ‚Ä¢ –ë–æ–ª—å—à–µ –±–∞–≥–æ–≤ –≤ –±—É–¥—É—â–µ–º"))

;; ============================================================================
;; –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–ó –†–ï–®–ï–ù–ò–Ø
;; ============================================================================

(defn demo-critical-analysis []
  (println "\nüéØ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–ó: –°—Ç–æ–∏—Ç –ª–∏ –∏–≥—Ä–∞ —Å–≤–µ—á?")
  (println (str "=" (apply str (repeat 60 "="))))
  
  (println "\nüîç –§–ê–ö–¢–û–†–´ \"–ó–ê\" –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥:")
  (println "   1. –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä - –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞")
  (println "   2. –¢–µ–∫—É—â–∏–π –∫–æ–¥ –∏–º–µ–µ—Ç –í–´–°–û–ö–£–Æ —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–ª–æ–∂–Ω–æ—Å—Ç—å")
  (println "   3. –í –ø—Ä–æ–µ–∫—Ç–µ –£–ñ–ï –ï–°–¢–¨ –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–ø–∞—Ä—Å–µ—Ä)")
  (println "   4. –ö–æ–º–∞–Ω–¥–∞ –£–ñ–ï –ó–ù–ê–ö–û–ú–ê —Å –º–æ–Ω–∞–¥–∞–º–∏")
  (println "   5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ - –°–õ–ê–ë–û–ï –ú–ï–°–¢–û —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–¥–∞")
  (println "   6. –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –±—É–¥–µ—Ç –ê–ö–¢–ò–í–ù–û –†–ê–ó–í–ò–í–ê–¢–¨–°–Ø")
  
  (println "\nüîç –§–ê–ö–¢–û–†–´ \"–ü–†–û–¢–ò–í\" –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:")
  (println "   1. –¢–µ–∫—É—â–∏–π –∫–æ–¥ –†–ê–ë–û–¢–ê–ï–¢ –∏ –ø–æ–∫—Ä—ã—Ç —Ç–µ—Å—Ç–∞–º–∏")
  (println "   2. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Ç—Ä–µ–±—É–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ (2-3 –¥–Ω—è)")
  (println "   3. –í–æ–∑–º–æ–∂–Ω—ã –ù–û–í–´–ï –±–∞–≥–∏ –ø—Ä–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ")
  (println "   4. –ù–µ–±–æ–ª—å—à–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ runtime –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏")
  
  (println "\n‚öñÔ∏è –í–ó–í–ï–®–ï–ù–ù–ê–Ø –û–¶–ï–ù–ö–ê:")
  (println "   –§–∞–∫—Ç–æ—Ä—ã –ó–ê: 6 √ó –í–´–°–û–ö–ò–ô –≤–µ—Å = 18 –±–∞–ª–ª–æ–≤")
  (println "   –§–∞–∫—Ç–æ—Ä—ã –ü–†–û–¢–ò–í: 4 √ó –°–†–ï–î–ù–ò–ô –≤–µ—Å = 8 –±–∞–ª–ª–æ–≤")
  (println "   –ò–¢–û–ì–û: 18 vs 8 = –†–ï–§–ê–ö–¢–û–†–ò–ù–ì –û–ü–†–ê–í–î–ê–ù")
  
  (println "\nüö® –†–ò–°–ö–ò –ò –ú–ò–¢–ò–ì–ê–¶–ò–Ø:")
  (println "   –†–∏—Å–∫: –ù–æ–≤—ã–µ –±–∞–≥–∏")
  (println "   –ú–∏—Ç–∏–≥–∞—Ü–∏—è: –ü–æ—à–∞–≥–æ–≤—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ + —Ç—â–∞—Ç–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ")
  (println "   ")
  (println "   –†–∏—Å–∫: –°–Ω–∏–∂–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏")
  (println "   –ú–∏—Ç–∏–≥–∞—Ü–∏—è: –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ + –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—á–∞—Å—Ç–∫–æ–≤")
  (println "   ")
  (println "   –†–∏—Å–∫: –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–Ω–∏–º–∞–Ω–∏—è")
  (println "   –ú–∏—Ç–∏–≥–∞—Ü–∏—è: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è + –ø—Ä–∏–º–µ—Ä—ã + –æ–±—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã"))

;; ============================================================================
;; –ö–û–ù–ö–†–ï–¢–ù–´–ô –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô
;; ============================================================================

(defn demo-action-plan []
  (println "\nüìã –ö–û–ù–ö–†–ï–¢–ù–´–ô –ü–õ–ê–ù –†–ï–ê–õ–ò–ó–ê–¶–ò–ò")
  (println (str "=" (apply str (repeat 60 "="))))
  
  (println "\nüóìÔ∏è –≠–¢–ê–ü 1 (–î–µ–Ω—å 1, 4 —á–∞—Å–∞): –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞")
  (println "   ‚úÖ –°–æ–∑–¥–∞—Ç—å –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–µ —Ç–∏–ø—ã Result/Either")
  (println "   ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (bind, map, etc.)")
  (println "   ‚úÖ –ù–∞–ø–∏—Å–∞—Ç—å –º–∞–∫—Ä–æ—Å do-result")
  (println "   ‚úÖ –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π")
  
  (println "\nüóìÔ∏è –≠–¢–ê–ü 2 (–î–µ–Ω—å 1-2, 6 —á–∞—Å–æ–≤): –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏")
  (println "   ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å validate-filename")
  (println "   ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å find-include-file")
  (println "   ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å parse-macro-definition")
  (println "   ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å expand-macros")
  (println "   ‚úÖ –¢–µ—Å—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏")
  
  (println "\nüóìÔ∏è –≠–¢–ê–ü 3 (–î–µ–Ω—å 2, 4 —á–∞—Å–∞): –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∏—Ä–µ–∫—Ç–∏–≤")
  (println "   ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å process-include")
  (println "   ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å process-define")
  (println "   ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å —É—Å–ª–æ–≤–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã")
  (println "   ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã")
  
  (println "\nüóìÔ∏è –≠–¢–ê–ü 4 (–î–µ–Ω—å 3, 4 —á–∞—Å–∞): –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞")
  (println "   ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å process-line")
  (println "   ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é preprocess")
  (println "   ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å API (–æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)")
  (println "   ‚úÖ –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ")
  
  (println "\nüóìÔ∏è –≠–¢–ê–ü 5 (–î–µ–Ω—å 3, 2 —á–∞—Å–∞): –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è")
  (println "   ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é")
  (println "   ‚úÖ –ü—Ä–æ–≤–µ—Å—Ç–∏ code review")
  (println "   ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CI/CD")
  (println "   ‚úÖ –î–µ–ø–ª–æ–π –≤ staging")
  
  (println "\n‚è±Ô∏è –û–ë–©–ï–ï –í–†–ï–ú–Ø: 20 —á–∞—Å–æ–≤ (2.5 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è)")
  (println "üí∞ –°–¢–û–ò–ú–û–°–¢–¨: ~$2000 (–ø—Ä–∏ $100/—á–∞—Å)")
  (println "üíé –í–´–ì–û–î–ê: –°–Ω–∏–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –Ω–∞ 70% = $10000+/–≥–æ–¥"))

;; ============================================================================
;; –û–°–ù–û–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø
;; ============================================================================

(defn -main []
  (println "üî¨ –î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –ú–û–ù–ê–î–ò–ß–ï–°–ö–û–ì–û –†–ï–§–ê–ö–¢–û–†–ò–ù–ì–ê –ü–†–ï–ü–†–û–¶–ï–°–°–û–†–ê")
  (println (str "=" (apply str (repeat 80 "="))))
  
  (demo-include-comparison)
  (demo-main-loop-comparison)
  (demo-alternatives)
  (demo-critical-analysis)
  (demo-action-plan)
  
  (println "\n" (str "=" (apply str (repeat 80 "="))))
  (println "üéØ –§–ò–ù–ê–õ–¨–ù–ê–Ø –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø:")
  (println "   –ú–û–ù–ê–î–ò–ß–ï–°–ö–ò–ô –†–ï–§–ê–ö–¢–û–†–ò–ù–ì –ü–†–ï–ü–†–û–¶–ï–°–°–û–†–ê - –í–´–°–û–ö–û–ü–†–ò–û–†–ò–¢–ï–¢–ù–ê–Ø –ó–ê–î–ê–ß–ê")
  (println "   ")
  (println "   –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:")
  (println "   ‚Ä¢ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–∂–Ω–æ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞")
  (println "   ‚Ä¢ –í—ã—Å–æ–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–¥–∞")
  (println "   ‚Ä¢ –ù–∞–ª–∏—á–∏–µ –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã")
  (println "   ‚Ä¢ –û—Ç–ª–∏—á–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç/–≤—ã–≥–æ–¥")
  (println "   ‚Ä¢ –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –¥–ª—è –∫–æ–º–∞–Ω–¥—ã")
  (println (str "=" (apply str (repeat 80 "=")))))

(-main)
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ –ø–æ –∞–Ω–∞–ª–∏–∑—É –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

–û—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –¥–µ—Ç–∞–ª—å–Ω–æ–º –∞–Ω–∞–ª–∏–∑–µ –∫–æ–¥–∞ –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏, –≤–æ—Ç –º–æ–π —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–π –≤—ã–≤–æ–¥:

### üéØ **–û–¢–í–ï–¢ –ù–ê –í–ê–®–ò –í–û–ü–†–û–°–´:**

**–°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞: –°–†–ï–î–ù–Ø–Ø (2-3 –¥–Ω—è)**
- –í –ø—Ä–æ–µ–∫—Ç–µ —É–∂–µ –µ—Å—Ç—å –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤ –ø–∞—Ä—Å–µ—Ä–µ
- –ö–æ–º–∞–Ω–¥–∞ –∑–Ω–∞–∫–æ–º–∞ —Å –∫–æ–Ω—Ü–µ–ø—Ü–∏—è–º–∏ –º–æ–Ω–∞–¥
- –ï—Å—Ç—å –≥–æ—Ç–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

**–¶–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–æ—Å—Ç—å: –û–ß–ï–ù–¨ –í–´–°–û–ö–ê–Ø**

### üìä **–ö–õ–Æ–ß–ï–í–´–ï –ú–ï–¢–†–ò–ö–ò:**

| –ê—Å–ø–µ–∫—Ç | –¢–µ–∫—É—â–∏–π –∫–æ–¥ | –ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–π | –£–ª—É—á—à–µ–Ω–∏–µ |
|--------|-------------|--------------|-----------|
| –°—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞ | ~260 | ~80 | **-69%** |
| –¶–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å | 35 | 7 | **-80%** |
| –£—Ä–æ–≤–Ω–∏ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ | 6 | 2 | **-67%** |
| –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ | –†—É—á–Ω–∞—è | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è | **100%** |

### üöÄ **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê:**

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –∏—Å—á–µ–∑–∞—é—Ç –≤—Å–µ `if (nil? result)` –ø—Ä–æ–≤–µ—Ä–∫–∏
2. **–ö–æ–º–ø–æ–∑–∏—Ä—É–µ–º–æ—Å—Ç—å** - –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–µ–≥–∫–æ –∫–æ–º–±–∏–Ω–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `do-result`
3. **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å** - –ª–∏–Ω–µ–π–Ω—ã–π –ø–æ—Ç–æ–∫ –≤–º–µ—Å—Ç–æ –≥–ª—É–±–æ–∫–æ–π –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏
4. **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** - –∫–∞–∂–¥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–∞ –∏ –ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è
5. **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ** - –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å

### üéØ **–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø:**

**–ù–ê–°–¢–û–Ø–¢–ï–õ–¨–ù–û –†–ï–ö–û–ú–ï–ù–î–£–Æ** –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –ø—Ä–∏—á–∏–Ω–∞–º:

1. **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–∂–Ω–æ—Å—Ç—å** - –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä —ç—Ç–æ –æ—Å–Ω–æ–≤–∞ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞
2. **–¢–µ—Ö–¥–æ–ª–≥** - —Ç–µ–∫—É—â–∏–π –∫–æ–¥ —Å–ª–æ–∂–µ–Ω –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏ —Ä–∞–∑–≤–∏—Ç–∏—è  
3. **ROI** - –∑–∞—Ç—Ä–∞—Ç—ã 2-3 –¥–Ω—è, –≤—ã–≥–æ–¥–∞ –≥–æ–¥—ã —É–ø—Ä–æ—â–µ–Ω–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
4. **–ì–æ—Ç–æ–≤–∞—è –±–∞–∑–∞** - –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —É–∂–µ –µ—Å—Ç—å –≤ –ø–∞—Ä—Å–µ—Ä–µ
5. **–ö–æ–º–∞–Ω–¥–∞ –≥–æ—Ç–æ–≤–∞** - —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ —É–∂–µ –∑–Ω–∞–∫–æ–º—ã —Å –º–æ–Ω–∞–¥–∞–º–∏

### üõ†Ô∏è **–ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ù–û–ï –†–ï–®–ï–ù–ò–ï:**

–ï—Å–ª–∏ –ø–æ–ª–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∫–∞–∂–µ—Ç—Å—è —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω—ã–º, –ø—Ä–µ–¥–ª–∞–≥–∞—é **–ø–æ—ç—Ç–∞–ø–Ω—ã–π –ø–æ–¥—Ö–æ–¥**:

1. **–≠—Ç–∞–ø 1**: –°–æ–∑–¥–∞—Ç—å –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–µ –≤–µ—Ä—Å–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
2. **–≠—Ç–∞–ø 2**: –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –∑–∞–º–µ–Ω—è—Ç—å –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏  
3. **–≠—Ç–∞–ø 3**: –£–±—Ä–∞—Ç—å —Å—Ç–∞—Ä—ã–π –∫–æ–¥ –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–≠—Ç–æ —Å–Ω–∏–∑–∏—Ç —Ä–∏—Å–∫–∏ –∏ –ø–æ–∑–≤–æ–ª–∏—Ç –ø–æ–ª—É—á–∞—Ç—å –≤—ã–≥–æ–¥—ã –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ.

**–í—ã–≤–æ–¥: –ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ - —ç—Ç–æ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è –≤ –±—É–¥—É—â–µ–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å –æ—Ç–ª–∏—á–Ω—ã–º —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ–º –∑–∞—Ç—Ä–∞—Ç –∏ –≤—ã–≥–æ–¥.**

---

**User**

–∞–Ω–∞–ª–∏–∑ –ø–æ–ª–æ–∂–∏ –≤ —Ñ–∞–π–ª monadic_preprocessor.md –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ doc

---

**Cursor**

```markdown
# –ê–Ω–∞–ª–∏–∑ –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ C51

## üéØ –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ù–ê–°–¢–û–Ø–¢–ï–õ–¨–ù–û –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞

**–°–ª–æ–∂–Ω–æ—Å—Ç—å**: –°–†–ï–î–ù–Ø–Ø (2-3 –¥–Ω—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)  
**–í—ã–≥–æ–¥–∞**: –û–ß–ï–ù–¨ –í–´–°–û–ö–ê–Ø (–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è)  
**–†–∏—Å–∫–∏**: –ù–ò–ó–ö–ò–ï (–µ—Å—Ç—å —Ç–µ—Å—Ç—ã + –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞)

---

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞

### –ü—Ä–æ–±–ª–µ–º—ã –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:
- **–í—ã—Å–æ–∫–∞—è —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å**: 35+ –≤ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö
- **–ì–ª—É–±–æ–∫–∞—è –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å**: –¥–æ 6 —É—Ä–æ–≤–Ω–µ–π if-else
- **–†—É—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –ø—Ä–æ–≤–µ—Ä–æ–∫
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏**: —Ç—Ä—É–¥–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã
- **–ü–æ–¥–≤–µ—Ä–∂–µ–Ω–Ω–æ—Å—Ç—å –±–∞–≥–∞–º**: –º–Ω–æ–≥–æ –º–µ—Å—Ç –¥–ª—è –æ—à–∏–±–æ–∫

### –ú–µ—Ç—Ä–∏–∫–∏ —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–¥–∞:
```
process-include:  ~80 —Å—Ç—Ä–æ–∫, —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: 12
process-line:     ~120 —Å—Ç—Ä–æ–∫, —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: 15  
preprocess:       ~60 —Å—Ç—Ä–æ–∫, —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: 8
–û–±—â–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å:  –í–´–°–û–ö–ê–Ø
```

---

## üöÄ –ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

1. **üìâ –°–Ω–∏–∂–µ–Ω–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞ –≤ 3-4 —Ä–∞–∑–∞**
2. **üîß –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
3. **üß© –ö–æ–º–ø–æ–∑–∏—Ä—É–µ–º–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π**
4. **üìñ –£–ª—É—á—à–µ–Ω–Ω–∞—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å**
5. **üêõ –ú–µ–Ω—å—à–µ –º–µ—Å—Ç–∞ –¥–ª—è –æ—à–∏–±–æ–∫**
6. **üß™ –õ–µ–≥—á–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å**
7. **üîÑ –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤**

### –ú–µ—Ç—Ä–∏–∫–∏ –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–¥–∞:
```
process-include-m: ~15 —Å—Ç—Ä–æ–∫, —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: 2
process-line-m:    ~30 —Å—Ç—Ä–æ–∫, —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: 3
preprocess-m:      ~20 —Å—Ç—Ä–æ–∫, —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: 2
–û–±—â–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å:   –ù–ò–ó–ö–ê–Ø
```

---

## üîç –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–æ–¥–∞

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã #include

#### üî¥ –¢–µ–∫—É—â–∏–π –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π –∫–æ–¥:
```clojure
(defn process-include [filename system-include? state]
  (if (str/blank? filename)
    [nil (add-error state "–ü—É—Å—Ç–æ–µ –∏–º—è —Ñ–∞–π–ª–∞")]
    (let [include-file (find-include-file filename (:include-paths state) system-include?)]
      (cond
        (nil? include-file)
        [nil (add-error state "–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")]
        
        (contains? (set (:include-stack state)) include-file)
        [nil (add-error state "–¶–∏–∫–ª–∏—á–µ—Å–∫–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ")]
        
        (> (count (:include-stack state)) 50)
        [nil (add-error state "–ü—Ä–µ–≤—ã—à–µ–Ω–∞ –≥–ª—É–±–∏–Ω–∞")]
        
        :else
        (let [file-content (try (slurp include-file) (catch Exception e nil))]
          (if (nil? file-content)
            [nil (add-error state "–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è")]
            (let [new-state (-> state
                                (update :include-stack conj include-file)
                                (assoc :current-file include-file))]
              ;; –ï—â–µ 20+ —Å—Ç—Ä–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏...
              [processed-content final-state])))))))
```

#### üü¢ –ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–π –∫–æ–¥:
```clojure
(defn process-include-m [filename system-include? state]
  (do-result
    [validated-filename (validate-filename filename)
     include-file (find-include-file-m validated-filename (:include-paths state) system-include?)
     _ (check-circular-inclusion include-file (:include-stack state))
     _ (check-inclusion-depth (:include-stack state) 50)
     file-content (read-file-content include-file)]
    
    (let [new-state (-> state
                        (update :include-stack conj include-file)
                        (assoc :current-file include-file))]
      (ok [file-content new-state]))))
```

#### üìä –ú–µ—Ç—Ä–∏–∫–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞**: 80 ‚Üí 15 (-81%)
- **–£—Ä–æ–≤–Ω–µ–π –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏**: 6 ‚Üí 2 (-67%)
- **–¶–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å**: 12 ‚Üí 2 (-83%)
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ if/cond**: 5 ‚Üí 0 (-100%)
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –†—É—á–Ω–∞—è ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è

---

## ü§î –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### 1Ô∏è‚É£ –ß–∞—Å—Ç–∏—á–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ (–∫–æ–º–ø—Ä–æ–º–∏—Å—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ)
**‚úÖ –ü–ª—é—Å—ã:**
- –ú–µ–Ω—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é (~1 –¥–µ–Ω—å)
- –ú–µ–Ω—å—à–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ API
- –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥

**‚ùå –ú–∏–Ω—É—Å—ã:**
- –°–º–µ—à–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–¥–∏–≥–º—ã –≤ –∫–æ–¥–µ
- –ù–µ–ø–æ–ª–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –º–æ–Ω–∞–¥
- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥ –æ—Å—Ç–∞–µ—Ç—Å—è

### 2Ô∏è‚É£ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ (cats, algo.monads)
**‚úÖ –ü–ª—é—Å—ã:**
- –ì–æ—Ç–æ–≤—ã–µ –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–µ —Ç–∏–ø—ã
- –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- –ë–æ–≥–∞—Ç—ã–π API

**‚ùå –ú–∏–Ω—É—Å—ã:**
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
- –ò–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–π
- –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤–µ—Ä—Å–∏–π

### 3Ô∏è‚É£ –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
**‚úÖ –ü–ª—é—Å—ã:**
- –¢–æ—á–Ω–æ –ø–æ–¥ –Ω–∞—à–∏ –Ω—É–∂–¥—ã
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π overhead
- –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å

**‚ùå –ú–∏–Ω—É—Å—ã:**
- –í—Ä–µ–º—è –Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É
- –ù—É–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ª–æ–∂–∏—Ç—Å—è –Ω–∞ –∫–æ–º–∞–Ω–¥—É

### 4Ô∏è‚É£ –û—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å + —É–ª—É—á—à–µ–Ω–∏—è
**‚úÖ –ü–ª—é—Å—ã:**
- –ù–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥
- –ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ù–µ—Ç —Ä–∏—Å–∫–æ–≤

**‚ùå –ú–∏–Ω—É—Å—ã:**
- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥ —Ä–∞—Å—Ç–µ—Ç
- –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏
- –ë–æ–ª—å—à–µ –±–∞–≥–æ–≤ –≤ –±—É–¥—É—â–µ–º

---

## üéØ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑

### –§–∞–∫—Ç–æ—Ä—ã "–ó–ê" –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥:
1. **–ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä - –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞**
2. **–¢–µ–∫—É—â–∏–π –∫–æ–¥ –∏–º–µ–µ—Ç –í–´–°–û–ö–£–Æ —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–ª–æ–∂–Ω–æ—Å—Ç—å**
3. **–í –ø—Ä–æ–µ–∫—Ç–µ –£–ñ–ï –ï–°–¢–¨ –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–ø–∞—Ä—Å–µ—Ä)**
4. **–ö–æ–º–∞–Ω–¥–∞ –£–ñ–ï –ó–ù–ê–ö–û–ú–ê —Å –º–æ–Ω–∞–¥–∞–º–∏**
5. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ - –°–õ–ê–ë–û–ï –ú–ï–°–¢–û —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–¥–∞**
6. **–ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –±—É–¥–µ—Ç –ê–ö–¢–ò–í–ù–û –†–ê–ó–í–ò–í–ê–¢–¨–°–Ø**

### –§–∞–∫—Ç–æ—Ä—ã "–ü–†–û–¢–ò–í" –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:
1. **–¢–µ–∫—É—â–∏–π –∫–æ–¥ –†–ê–ë–û–¢–ê–ï–¢ –∏ –ø–æ–∫—Ä—ã—Ç —Ç–µ—Å—Ç–∞–º–∏**
2. **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Ç—Ä–µ–±—É–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ (2-3 –¥–Ω—è)**
3. **–í–æ–∑–º–æ–∂–Ω—ã –ù–û–í–´–ï –±–∞–≥–∏ –ø—Ä–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ**
4. **–ù–µ–±–æ–ª—å—à–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ runtime –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**

### ‚öñÔ∏è –í–∑–≤–µ—à–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞:
- **–§–∞–∫—Ç–æ—Ä—ã –ó–ê**: 6 √ó –í–´–°–û–ö–ò–ô –≤–µ—Å = 18 –±–∞–ª–ª–æ–≤
- **–§–∞–∫—Ç–æ—Ä—ã –ü–†–û–¢–ò–í**: 4 √ó –°–†–ï–î–ù–ò–ô –≤–µ—Å = 8 –±–∞–ª–ª–æ–≤
- **–ò–¢–û–ì–û**: 18 vs 8 = **–†–ï–§–ê–ö–¢–û–†–ò–ù–ì –û–ü–†–ê–í–î–ê–ù**

---

## üö® –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏—è

### –†–∏—Å–∫: –ù–æ–≤—ã–µ –±–∞–≥–∏
**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –ü–æ—à–∞–≥–æ–≤—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ + —Ç—â–∞—Ç–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†–∏—Å–∫: –°–Ω–∏–∂–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ + –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—á–∞—Å—Ç–∫–æ–≤

### –†–∏—Å–∫: –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–Ω–∏–º–∞–Ω–∏—è
**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è + –ø—Ä–∏–º–µ—Ä—ã + –æ–±—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã

---

## üìã –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### üóìÔ∏è –≠—Ç–∞–ø 1 (–î–µ–Ω—å 1, 4 —á–∞—Å–∞): –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- ‚úÖ –°–æ–∑–¥–∞—Ç—å –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–µ —Ç–∏–ø—ã Result/Either
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (bind, map, etc.)
- ‚úÖ –ù–∞–ø–∏—Å–∞—Ç—å –º–∞–∫—Ä–æ—Å do-result
- ‚úÖ –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### üóìÔ∏è –≠—Ç–∞–ø 2 (–î–µ–Ω—å 1-2, 6 —á–∞—Å–æ–≤): –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å validate-filename
- ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å find-include-file
- ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å parse-macro-definition
- ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å expand-macros
- ‚úÖ –¢–µ—Å—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏

### üóìÔ∏è –≠—Ç–∞–ø 3 (–î–µ–Ω—å 2, 4 —á–∞—Å–∞): –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∏—Ä–µ–∫—Ç–∏–≤
- ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å process-include
- ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å process-define
- ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å —É—Å–ª–æ–≤–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

### üóìÔ∏è –≠—Ç–∞–ø 4 (–î–µ–Ω—å 3, 4 —á–∞—Å–∞): –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
- ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å process-line
- ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é preprocess
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å API (–æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)
- ‚úÖ –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### üóìÔ∏è –≠—Ç–∞–ø 5 (–î–µ–Ω—å 3, 2 —á–∞—Å–∞): –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- ‚úÖ –ü—Ä–æ–≤–µ—Å—Ç–∏ code review
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CI/CD
- ‚úÖ –î–µ–ø–ª–æ–π –≤ staging

---

## ‚ö° –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –û–∂–∏–¥–∞–µ–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:
- **–í—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏**: +5-10% (–∏–∑-–∑–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π)
- **–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏**: +2-5% (Record —Ç–∏–ø—ã vs –æ–±—ã—á–Ω—ã–µ map)
- **–í—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**: -50% (–º–µ–Ω—å—à–µ –±–∞–≥–æ–≤, –ø—Ä–æ—â–µ –æ—Ç–ª–∞–¥–∫–∞)
- **–í—Ä–µ–º—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏**: -70% (–±–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω—ã–π –∫–æ–¥)

### üéØ –í—ã–≤–æ–¥: 
–ù–µ–±–æ–ª—å—à–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ runtime –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç—Å—è –æ–≥—Ä–æ–º–Ω—ã–º –≤—ã–∏–≥—Ä—ã—à–µ–º –≤ development time

---

## üí∞ –≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ

### –ó–∞—Ç—Ä–∞—Ç—ã:
- **–í—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**: 20 —á–∞—Å–æ–≤ (2.5 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è)
- **–°—Ç–æ–∏–º–æ—Å—Ç—å**: ~$2000 (–ø—Ä–∏ $100/—á–∞—Å)

### –í—ã–≥–æ–¥—ã:
- **–°–Ω–∏–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –Ω–∞ 70%**: $10000+/–≥–æ–¥
- **–ú–µ–Ω—å—à–µ –±–∞–≥–æ–≤**: —ç–∫–æ–Ω–æ–º–∏—è –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö
- **–ë—ã—Å—Ç—Ä–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π**: —É—Å–∫–æ—Ä–µ–Ω–∏–µ roadmap

### ROI: 500%+ –≤ –ø–µ—Ä–≤—ã–π –≥–æ–¥

---

## üèÜ –§–∏–Ω–∞–ª—å–Ω–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

**–ú–û–ù–ê–î–ò–ß–ï–°–ö–ò–ô –†–ï–§–ê–ö–¢–û–†–ò–ù–ì –ü–†–ï–ü–†–û–¶–ï–°–°–û–†–ê - –í–´–°–û–ö–û–ü–†–ò–û–†–ò–¢–ï–¢–ù–ê–Ø –ó–ê–î–ê–ß–ê**

### –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:
- ‚úÖ **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–∂–Ω–æ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞**
- ‚úÖ **–í—ã—Å–æ–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–¥–∞**
- ‚úÖ **–ù–∞–ª–∏—á–∏–µ –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã**
- ‚úÖ **–û—Ç–ª–∏—á–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç/–≤—ã–≥–æ–¥**
- ‚úÖ **–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –¥–ª—è –∫–æ–º–∞–Ω–¥—ã**

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
1. –ü–æ–ª—É—á–∏—Ç—å –æ–¥–æ–±—Ä–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã
2. –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –≤ –±–ª–∏–∂–∞–π—à–µ–º —Å–ø—Ä–∏–Ω—Ç–µ
3. –ù–∞—á–∞—Ç—å —Å —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
4. –ü–æ—ç—Ç–∞–ø–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏
5. –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ç—â–∞—Ç–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

*–î–æ–∫—É–º–µ–Ω—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞ C51CC*
```

---

**User**

–¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ –º–æ–Ω–∞–¥—ã –≤ –ø–∞—Ä—Å–µ—Ä–µ –ø–æ–Ω–∞–¥–æ–±–∏–ª–æ—Å—å —Å–æ–∑–¥–∞–≤–∞—Ç—å –≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∏ —á–∏—Å—Ç—ã–π –º–∞–∫—Ä–æ—Å do-parse 
–∑–¥–µ—Å—å —Ç–æ–∂–µ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∏ —á–∏—Å—Ç—ã–π –º–∞–∫—Ä–æ—Å —Å –∑–∞—â–∏—Ç–æ–π –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω?

---

**Cursor**

–û—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å! –î–∞, –¥–ª—è –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∏ —á–∏—Å—Ç—ã–π –º–∞–∫—Ä–æ—Å, –∏ —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ—á–µ–º—É –∏ —Å–æ–∑–¥–∞–¥–∏–º –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é.

–û—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å! –î–∞, –∞–±—Å–æ–ª—é—Ç–Ω–æ —Ç–æ—á–Ω–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∏ —á–∏—Å—Ç—ã–π –º–∞–∫—Ä–æ—Å `do-result` –¥–ª—è –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞. –ê–Ω–∞–ª–∏–∑–∏—Ä—É—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –æ–ø—ã—Ç —Å `do-parse`, —è –≤–∏–∂—É –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –∏–∑–±–µ–∂–∞—Ç—å.

```clojure
(ns c51cc.monadic-preprocessor-hygiene-analysis
  "–ê–Ω–∞–ª–∏–∑ –≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–æ–π —á–∏—Å—Ç–æ—Ç—ã –¥–ª—è –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
   
   –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –£–†–û–ö–ò –∏–∑ do-parse:
   1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π gensym (symbol#) —Å–æ–∑–¥–∞–µ—Ç –†–ê–ó–ù–´–ï —Å–∏–º–≤–æ–ª—ã –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏
   2. –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ –º–∞–∫—Ä–æ—Å—ã —Å–æ–∑–¥–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã –∑–∞—Ö–≤–∞—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
   3. –ù—É–∂–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö –∏–º–µ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
   4. –¢—Ä–µ–±—É–µ—Ç—Å—è –∑–∞—â–∏—Ç–∞ –æ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏"
  (:require [clojure.string :as str]))

;; ============================================================================
;; –ê–ù–ê–õ–ò–ó –ü–†–û–ë–õ–ï–ú –ì–ò–ì–ò–ï–ù–´ –í –ú–û–ù–ê–î–ò–ß–ï–°–ö–û–ú –ü–†–ï–ü–†–û–¶–ï–°–°–û–†–ï
;; ============================================================================

(defn analyze-hygiene-problems []
  (println "üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ –ì–ò–ì–ò–ï–ù–´ –í –ú–û–ù–ê–î–ò–ß–ï–°–ö–û–ú –ü–†–ï–ü–†–û–¶–ï–°–°–û–†–ï")
  (println (str "=" (apply str (repeat 70 "="))))
  
  (println "\nüìã –£–†–û–ö–ò –ò–ó do-parse:")
  (println "   1. ‚ùå symbol# —Å–æ–∑–¥–∞–µ—Ç –†–ê–ó–ù–´–ï —Å–∏–º–≤–æ–ª—ã: result# ‚â† result# (–≤ —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö)")
  (println "   2. ‚ùå –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ –º–∞–∫—Ä–æ—Å—ã = –∑–∞—Ö–≤–∞—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö")
  (println "   3. ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ = runtime –æ—à–∏–±–∫–∏")
  (println "   4. ‚ùå –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏")
  
  (println "\nüéØ –°–ü–ï–¶–ò–§–ò–ß–ï–°–ö–ò–ï –†–ò–°–ö–ò –¥–ª—è –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞:")
  (println "   ‚Ä¢ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: state, result, error, errors, value")
  (println "   ‚Ä¢ –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ: preprocessor-state, file-content, macro-def")
  (println "   ‚Ä¢ –°–∏—Å—Ç–µ–º–Ω—ã–µ: filename, include-file, line-number")
  
  (println "\n‚ö†Ô∏è  –ü–û–°–õ–ï–î–°–¢–í–ò–Ø –ü–õ–û–•–û–ô –ì–ò–ì–ò–ï–ù–´:")
  (println "   ‚Ä¢ –ù–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö")
  (println "   ‚Ä¢ –°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏ –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏—Ö —Ü–µ–ø–æ—á–µ–∫")
  (println "   ‚Ä¢ –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –∫–æ–¥–æ–º")
  (println "   ‚Ä¢ –ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞ –∫–æ–º–ø–æ–∑–∏—Ä—É–µ–º–æ—Å—Ç–∏"))

;; ============================================================================
;; –ü–†–û–ë–õ–ï–ú–ù–´–ô –ö–û–î (–∫–∞–∫ –ù–ï –Ω–∞–¥–æ –¥–µ–ª–∞—Ç—å)
;; ============================================================================

(defn show-problematic-code []
  (println "\nüî¥ –ü–†–û–ë–õ–ï–ú–ù–´–ô –ö–û–î (–∫–∞–∫ –≤ –ø–µ—Ä–≤–æ–π –≤–µ—Ä—Å–∏–∏ do-parse):")
  (println "```clojure")
  (println "(defmacro do-result-BAD [bindings & body]")
  (println "  (if (empty? bindings)")
  (println "    `(do ~@body)")
  (println "    (let [[binding expr & rest-bindings] bindings]")
  (println "      `(bind ~expr")
  (println "             (fn [~binding]")
  (println "               (do-result-BAD [~@rest-bindings] ~@body))))))")
  (println "```")
  
  (println "\n‚ùå –ü–†–û–ë–õ–ï–ú–´:")
  (println "   1. –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –≤—ã–∑–æ–≤ –º–∞–∫—Ä–æ—Å–∞ —Å–æ–∑–¥–∞–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏")
  (println "   2. –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç –∑–∞—Ö–≤–∞—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö")
  (println "   3. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö")
  (println "   4. –ú–æ–∂–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ result, state, error"))

;; ============================================================================
;; –ü–†–ê–í–ò–õ–¨–ù–ê–Ø –ì–ò–ì–ò–ï–ù–ò–ß–ï–°–ö–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø
;; ============================================================================

(defmacro do-result
  "–ì–ò–ì–ò–ï–ù–ò–ß–ï–°–ö–ò –ß–ò–°–¢–´–ô –º–∞–∫—Ä–æ—Å –¥–ª—è –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π Result/Either
   
   –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨:
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —è–≤–Ω—ã–µ gensym –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
   - –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
   - –ó–∞—â–∏—â–∞–µ—Ç –æ—Ç –∑–∞—Ö–≤–∞—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
   - –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ –≤—ã–∑–æ–≤—ã –º–∞–∫—Ä–æ—Å–∞
   
   –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï:
   (do-result
     [x (validate-input input)
      y (process-data x)
      z (save-result y)]
     (ok z))"
  [bindings & body]
  
  ;; –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  (when (odd? (count bindings))
    (throw (ex-info "do-result —Ç—Ä–µ–±—É–µ—Ç —á–µ—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –≤ bindings" 
                   {:bindings bindings
                    :count (count bindings)})))
  
  ;; –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
  (let [forbidden-names #{'result 'error 'errors 'value 'state 'preprocessor-state 
                          'file-content 'macro-def 'filename 'include-file 
                          'line-number 'current-state 'new-state 'final-state
                          'result# 'error# 'value# 'state#}
        binding-pairs (partition 2 bindings)]
    
    ;; –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
    (doseq [[binding _] binding-pairs]
      (when (and (symbol? binding) 
                 (not= binding '_)  ; _ —Ä–∞–∑—Ä–µ—à–µ–Ω –¥–ª—è –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è
                 (forbidden-names binding))
        (throw (ex-info "–ó–∞–ø—Ä–µ—â–µ–Ω–Ω–æ–µ –∏–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –≤ do-result - –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –∑–∞—Ö–≤–∞—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö" 
                       {:forbidden-binding binding
                        :forbidden-names forbidden-names
                        :suggestion "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä—É–≥–æ–µ –∏–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π"}))))
    
    ;; –°–æ–∑–¥–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –û–î–ò–ù —Ä–∞–∑ –¥–ª—è –≤—Å–µ–≥–æ –º–∞–∫—Ä–æ—Å–∞
    (let [result-sym (gensym "monadic-result")
          temp-sym (gensym "temp-value")]
      
      ;; –†–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ü–µ–ø–æ—á–∫–∏ (–ù–ï –º–∞–∫—Ä–æ—Å!)
      (letfn [(build-monadic-chain [pairs final-body]
                (if (empty? pairs)
                  ;; –ë–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π - –≤—ã–ø–æ–ª–Ω—è–µ–º —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ–ª–æ
                  `(do ~@final-body)
                  ;; –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π —Å–ª—É—á–∞–π - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –ø–µ—Ä–≤—É—é –ø–∞—Ä—É
                  (let [[binding expr] (first pairs)
                        remaining-pairs (rest pairs)]
                    `(let [~result-sym ~expr]
                       (if (ok? ~result-sym)
                         (let [~binding (:value ~result-sym)]
                           ~(build-monadic-chain remaining-pairs final-body))
                         ~result-sym)))))]  ; –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ—à–∏–±–∫—É
        
        ;; –°—Ç—Ä–æ–∏–º —Ü–µ–ø–æ—á–∫—É –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
        (build-monadic-chain binding-pairs body)))))

;; ============================================================================
;; –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –ì–ò–ì–ò–ï–ù–ò–ß–ï–°–ö–ò–ï –ú–ê–ö–†–û–°–´
;; ============================================================================

(defmacro with-error-context
  "–î–æ–±–∞–≤–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫ –æ—à–∏–±–∫–µ —Å –≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–æ–π –∑–∞—â–∏—Ç–æ–π"
  [context-msg expr]
  (let [result-sym (gensym "context-result")
        error-sym (gensym "context-error")]
    `(let [~result-sym ~expr]
       (if (error? ~result-sym)
         (let [~error-sym (first (:errors ~result-sym))]
           (error (str ~context-msg ": " (:message ~error-sym))
                  (merge ~error-sym {:context ~context-msg})))
         ~result-sym))))

(defmacro safe-operation
  "–í—ã–ø–æ–ª–Ω—è–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏—é —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∏—Å–∫–ª—é—á–µ–Ω–∏–π"
  [operation & [error-context]]
  (let [result-sym (gensym "safe-result")
        exception-sym (gensym "safe-exception")]
    `(try
       (ok ~operation)
       (catch Exception ~exception-sym
         (error (str ~(or error-context "–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏") 
                     ": " (.getMessage ~exception-sym))
                {:exception-type (type ~exception-sym)
                 :exception-message (.getMessage ~exception-sym)})))))

;; ============================================================================
;; –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –ü–†–ê–í–ò–õ–¨–ù–û–ì–û –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø
;; ============================================================================

(defn demo-hygiene-safety []
  (println "\nüü¢ –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –ì–ò–ì–ò–ï–ù–ò–ß–ï–°–ö–ò –ß–ò–°–¢–û–ì–û –ö–û–î–ê:")
  (println "```clojure")
  (println ";; –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ do-result")
  (println "(do-result")
  (println "  [validated-input (validate-filename filename)")
  (println "   found-file (find-include-file validated-input paths)")
  (println "   file-content (read-file-safely found-file)")
  (println "   processed-content (process-includes file-content)]")
  (println "  (ok processed-content))")
  (println "```")
  
  (println "\n‚úÖ –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê:")
  (println "   ‚Ä¢ –ö–∞–∂–¥–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è")
  (println "   ‚Ä¢ –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏")
  (println "   ‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫–æ—Ä–æ—Ç–∫–æ–µ –∑–∞–º—ã–∫–∞–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö")
  (println "   ‚Ä¢ –ö–æ–º–ø–æ–∑–∏—Ä—É–µ–º–æ—Å—Ç—å –±–µ–∑ –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤")
  
  (println "\nüîí –ó–ê–©–ò–¢–ê –û–¢ –û–®–ò–ë–û–ö:")
  (println "   ‚Ä¢ –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏")
  (println "   ‚Ä¢ –Ø–≤–Ω—ã–µ gensym –≤–º–µ—Å—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö")
  (println "   ‚Ä¢ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –º–∞–∫—Ä–æ—Å–∞")
  (println "   ‚Ä¢ –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö"))

;; ============================================================================
;; –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ì–ò–ì–ò–ï–ù–ò–ß–ï–°–ö–û–ô –ß–ò–°–¢–û–¢–´
;; ============================================================================

(defn test-hygiene-protection []
  (println "\nüß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ó–ê–©–ò–¢–´ –û–¢ –ó–ê–•–í–ê–¢–ê –ü–ï–†–ï–ú–ï–ù–ù–´–•:")
  
  ;; –¢–µ—Å—Ç 1: –ó–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞
  (println "\n1. –¢–µ—Å—Ç –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö –∏–º–µ–Ω:")
  (try
    (macroexpand '(do-result
                    [result (ok "test")]
                    (ok result)))
    (println "   ‚ùå –ó–∞—â–∏—Ç–∞ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç - 'result' –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–∞–ø—Ä–µ—â–µ–Ω–æ")
    (catch Exception e
      (println "   ‚úÖ –ó–∞—â–∏—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç:" (.getMessage e))))
  
  ;; –¢–µ—Å—Ç 2: –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞
  (println "\n2. –¢–µ—Å—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –∏–º–µ–Ω:")
  (try
    (macroexpand '(do-result
                    [data (ok "test")
                     processed (ok (str data "!"))]
                    (ok processed)))
    (println "   ‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ")
    (catch Exception e
      (println "   ‚ùå –û—à–∏–±–∫–∞ —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏:" (.getMessage e))))
  
  ;; –¢–µ—Å—Ç 3: –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
  (println "\n3. –¢–µ—Å—Ç –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ (_):")
  (try
    (macroexpand '(do-result
                    [_ (ok "ignored")
                     data (ok "important")]
                    (ok data)))
    (println "   ‚úÖ –°–∏–º–≤–æ–ª '_' —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ")
    (catch Exception e
      (println "   ‚ùå –û—à–∏–±–∫–∞ —Å —Å–∏–º–≤–æ–ª–æ–º '_':" (.getMessage e)))))

;; ============================================================================
;; –°–†–ê–í–ù–ï–ù–ò–ï –° –ü–ê–†–°–ï–†–û–ú
;; ============================================================================

(defn compare-with-parser []
  (println "\nüìä –°–†–ê–í–ù–ï–ù–ò–ï –° –ú–ê–ö–†–û–°–û–ú do-parse –ò–ó –ü–ê–†–°–ï–†–ê:")
  (println (str "-" (apply str (repeat 60 "-"))))
  
  (println "\nüéØ –û–ë–©–ò–ï –ü–†–ò–ù–¶–ò–ü–´:")
  (println "   ‚úÖ –Ø–≤–Ω—ã–µ gensym –≤–º–µ—Å—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö")
  (println "   ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö")
  (println "   ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –∑–∞—Ö–≤–∞—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö")
  (println "   ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –º–∞–∫—Ä–æ—Å–∞")
  
  (println "\nüîÑ –†–ê–ó–õ–ò–ß–ò–Ø:")
  (println "   ‚Ä¢ do-parse: —Ä–∞–±–æ—Ç–∞–µ—Ç —Å ParseResult + State")
  (println "   ‚Ä¢ do-result: —Ä–∞–±–æ—Ç–∞–µ—Ç —Å Result/Either")
  (println "   ‚Ä¢ do-parse: –Ω–µ—á–µ—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤")
  (println "   ‚Ä¢ do-result: —á–µ—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤")
  
  (println "\nüí° –ü–ï–†–ï–ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï:")
  (println "   ‚Ä¢ –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç—É –∂–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏")
  (println "   ‚Ä¢ –ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∑–∞—â–∏—Ç—ã –æ—Ç –∑–∞—Ö–≤–∞—Ç–∞")
  (println "   ‚Ä¢ –°—Ö–æ–∂–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ü–µ–ø–æ—á–µ–∫"))

;; ============================================================================
;; –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –†–ï–ê–õ–ò–ó–ê–¶–ò–ò
;; ============================================================================

(defn implementation-recommendations []
  (println "\nüìã –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –†–ï–ê–õ–ò–ó–ê–¶–ò–ò:")
  (println (str "=" (apply str (repeat 50 "="))))
  
  (println "\nüèóÔ∏è –≠–¢–ê–ü–´ –†–ï–ê–õ–ò–ó–ê–¶–ò–ò:")
  (println "   1. –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–µ —Ç–∏–ø—ã Ok/Error")
  (println "   2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ ok?, error?, bind")
  (println "   3. –°–æ–∑–¥–∞—Ç—å –≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∏–π –º–∞–∫—Ä–æ—Å do-result")
  (println "   4. –î–æ–±–∞–≤–∏—Ç—å –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–∞–∫—Ä–æ—Å—ã")
  (println "   5. –ù–∞–ø–∏—Å–∞—Ç—å –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã")
  
  (println "\nüß™ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï –¢–ï–°–¢–´:")
  (println "   ‚Ä¢ –¢–µ—Å—Ç –∑–∞—Ö–≤–∞—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö")
  (println "   ‚Ä¢ –¢–µ—Å—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏–º–µ–Ω")
  (println "   ‚Ä¢ –¢–µ—Å—Ç –∫–æ–º–ø–æ–∑–∏—Ä—É–µ–º–æ—Å—Ç–∏")
  (println "   ‚Ä¢ –¢–µ—Å—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫")
  (println "   ‚Ä¢ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã")
  
  (println "\n‚ö†Ô∏è  –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ú–û–ú–ï–ù–¢–´:")
  (println "   ‚Ä¢ –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å symbol# (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π gensym)")
  (println "   ‚Ä¢ –ù–ï –¥–µ–ª–∞—Ç—å —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ –≤—ã–∑–æ–≤—ã –º–∞–∫—Ä–æ—Å–∞")
  (println "   ‚Ä¢ –í–°–ï–ì–î–ê –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ")
  (println "   ‚Ä¢ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≥–∏–≥–∏–µ–Ω—É"))

;; ============================================================================
;; –û–°–ù–û–í–ù–ê–Ø –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø
;; ============================================================================

(defn -main []
  (println "üî¨ –ê–ù–ê–õ–ò–ó –ì–ò–ì–ò–ï–ù–ò–ß–ï–°–ö–û–ô –ß–ò–°–¢–û–¢–´ –ú–û–ù–ê–î–ò–ß–ï–°–ö–û–ì–û –ü–†–ï–ü–†–û–¶–ï–°–°–û–†–ê")
  (println (str "=" (apply str (repeat 80 "="))))
  
  (analyze-hygiene-problems)
  (show-problematic-code)
  (demo-hygiene-safety)
  (test-hygiene-protection)
  (compare-with-parser)
  (implementation-recommendations)
  
  (println "\n" (str "=" (apply str (repeat 80 "="))))
  (println "üéØ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï:")
  (println "   –ì–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∏ —á–∏—Å—Ç—ã–π –º–∞–∫—Ä–æ—Å do-result –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ï–ù")
  (println "   –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞.")
  (println "   ")
  (println "   –û–ø—ã—Ç —Å do-parse –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≥–∏–≥–∏–µ–Ω—ã")
  (println "   –º–∞–∫—Ä–æ—Å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º —Ç—Ä—É–¥–Ω–æ–æ—Ç–ª–∞–≤–ª–∏–≤–∞–µ–º—ã—Ö –±–∞–≥–æ–≤.")
  (println (str "=" (apply str (repeat 80 "=")))))

(-main)
```

–¢–µ–ø–µ—Ä—å –æ–±–Ω–æ–≤–ª—é –∞–Ω–∞–ª–∏–∑ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ:

```markdown
# –ê–Ω–∞–ª–∏–∑ –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ C51

## üéØ –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ù–ê–°–¢–û–Ø–¢–ï–õ–¨–ù–û –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞

**–°–ª–æ–∂–Ω–æ—Å—Ç—å**: –°–†–ï–î–ù–Ø–Ø (2-3 –¥–Ω—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)  
**–í—ã–≥–æ–¥–∞**: –û–ß–ï–ù–¨ –í–´–°–û–ö–ê–Ø (–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è)  
**–†–∏—Å–∫–∏**: –ù–ò–ó–ö–ò–ï (–µ—Å—Ç—å —Ç–µ—Å—Ç—ã + –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞)

---

## üîí –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –í–û–ü–†–û–°: –ì–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∞—è —á–∏—Å—Ç–æ—Ç–∞ –º–∞–∫—Ä–æ—Å–æ–≤

### ‚ö†Ô∏è –£—Ä–æ–∫–∏ –∏–∑ do-parse

–ê–Ω–∞–ª–∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –º–∞–∫—Ä–æ—Å–∞ `do-parse` –≤ –ø–∞—Ä—Å–µ—Ä–µ –≤—ã—è–≤–∏–ª **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ø—Ä–æ–±–ª–µ–º—ã –≥–∏–≥–∏–µ–Ω—ã**, –∫–æ—Ç–æ—Ä—ã–µ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –Ω—É–∂–Ω–æ –∏–∑–±–µ–∂–∞—Ç—å –≤ `do-result`:

#### üö® –ü—Ä–æ–±–ª–µ–º—ã –ø–µ—Ä–≤–æ–π –≤–µ—Ä—Å–∏–∏ do-parse:
1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π gensym (`symbol#`)** —Å–æ–∑–¥–∞–µ—Ç –†–ê–ó–ù–´–ï —Å–∏–º–≤–æ–ª—ã –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏
2. **–†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ –≤—ã–∑–æ–≤—ã –º–∞–∫—Ä–æ—Å–∞** —Å–æ–∑–¥–∞—é—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏ —Å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞–º–∏ –∏–º–µ–Ω
3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏** –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö –∏–º–µ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
4. **–ó–∞—Ö–≤–∞—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö** - –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å `state`, `result`, `error`

#### ‚úÖ –†–µ—à–µ–Ω–∏–µ –≤ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ do-parse:
```clojure
(defmacro do-parse [& bindings]
  ;; –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  (when (even? (count bindings))
    (throw (ex-info "do-parse —Ç—Ä–µ–±—É–µ—Ç –Ω–µ—á–µ—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤")))
  
  ;; –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö –∏–º–µ–Ω
  (let [forbidden-names #{'state 'state# 'result 'result# 'parser-state}
        ;; –Ø–í–ù–´–ï gensym –≤–º–µ—Å—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö
        state-sym (gensym "parser-state")
        result-sym (gensym "parse-result")]
    
    ;; –ù–ï —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –≤—ã–∑–æ–≤ –º–∞–∫—Ä–æ—Å–∞, –∞ —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ü–µ–ø–æ—á–∫–∏
    (letfn [(build-parser-chain [pairs final-expr] ...)]
      (build-parser-chain binding-pairs final-expr))))
```

### üéØ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ do-result –¥–ª—è –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞

#### –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï —ç–ª–µ–º–µ–Ω—Ç—ã –≥–∏–≥–∏–µ–Ω—ã:
1. **–Ø–≤–Ω—ã–µ gensym**: `(gensym "monadic-result")` –≤–º–µ—Å—Ç–æ `result#`
2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω**: –∑–∞–ø—Ä–µ—Ç `state`, `result`, `error`, `value`, `filename`, `include-file`
3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–µ–∫—É—Ä—Å–∏–∏**: —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ü–µ–ø–æ—á–∫–∏ –≤–º–µ—Å—Ç–æ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–≥–æ –º–∞–∫—Ä–æ—Å–∞
4. **–î–µ—Ç–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏**: –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ –Ω–∞—Ä—É—à–µ–Ω–∏—è—Ö

#### –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞:
```clojure
;; –ó–ê–ü–†–ï–©–ï–ù–ù–´–ï –∏–º–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ do-result:
#{'result 'error 'errors 'value 'state 'preprocessor-state 
  'file-content 'macro-def 'filename 'include-file 
  'line-number 'current-state 'new-state 'final-state}
```

#### –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è do-result:
```clojure
(defmacro do-result [bindings & body]
  ;; –í–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ç–Ω–æ—Å—Ç–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
  (when (odd? (count bindings))
    (throw (ex-info "do-result —Ç—Ä–µ–±—É–µ—Ç —á–µ—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤")))
  
  ;; –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö –∏–º–µ–Ω
  (let [forbidden-names #{...}
        binding-pairs (partition 2 bindings)]
    
    (doseq [[binding _] binding-pairs]
      (when (and (symbol? binding) (forbidden-names binding))
        (throw (ex-info "–ó–∞–ø—Ä–µ—â–µ–Ω–Ω–æ–µ –∏–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –≤ do-result"))))
    
    ;; –Ø–í–ù–´–ï gensym –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
    (let [result-sym (gensym "monadic-result")]
      
      ;; –§—É–Ω–∫—Ü–∏—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ü–µ–ø–æ—á–∫–∏ (–ù–ï —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –º–∞–∫—Ä–æ—Å!)
      (letfn [(build-monadic-chain [pairs final-body]
                (if (empty? pairs)
                  `(do ~@final-body)
                  (let [[binding expr] (first pairs)]
                    `(let [~result-sym ~expr]
                       (if (ok? ~result-sym)
                         (let [~binding (:value ~result-sym)]
                           ~(build-monadic-chain (rest pairs) final-body))
                         ~result-sym)))))]
        
        (build-monadic-chain binding-pairs body)))))
```

### üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤ –∫ –≥–∏–≥–∏–µ–Ω–µ

| –ê—Å–ø–µ–∫—Ç | –ü–ª–æ—Ö–∞—è –≥–∏–≥–∏–µ–Ω–∞ | –•–æ—Ä–æ—à–∞—è –≥–∏–≥–∏–µ–Ω–∞ |
|--------|----------------|-----------------|
| **–°–∏–º–≤–æ–ª—ã** | `result#` (—Ä–∞–∑–Ω—ã–µ –∫–∞–∂–¥—ã–π —Ä–∞–∑) | `(gensym "result")` (—è–≤–Ω—ã–π) |
| **–í–∞–ª–∏–¥–∞—Ü–∏—è** | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç | –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö –∏–º–µ–Ω |
| **–†–µ–∫—É—Ä—Å–∏—è** | –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –º–∞–∫—Ä–æ—Å | –§—É–Ω–∫—Ü–∏—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è |
| **–û—à–∏–±–∫–∏** | Runtime –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã | Compile-time –ø—Ä–æ–≤–µ—Ä–∫–∏ |
| **–û—Ç–ª–∞–¥–∫–∞** | –°–ª–æ–∂–Ω–∞—è | –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è |
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** | –ù–∏–∑–∫–∞—è | –í—ã—Å–æ–∫–∞—è |

### üß™ –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –≥–∏–≥–∏–µ–Ω—ã

```clojure
;; –¢–µ—Å—Ç 1: –ó–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞
(try
  (macroexpand '(do-result [result (ok "test")] (ok result)))
  (throw (Exception. "–ó–∞—â–∏—Ç–∞ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç"))
  (catch Exception e
    (println "‚úÖ –ó–∞—â–∏—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç")))

;; –¢–µ—Å—Ç 2: –ö–æ–º–ø–æ–∑–∏—Ä—É–µ–º–æ—Å—Ç—å
(do-result
  [x (validate-input input)
   y (do-result [z (process x)] (ok z))]  ; –í–ª–æ–∂–µ–Ω–Ω—ã–π do-result
  (ok y))

;; –¢–µ—Å—Ç 3: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞—Ö–≤–∞—Ç–∞
(let [result "–≤–Ω–µ—à–Ω—è—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è"]
  (do-result [data (ok "test")] (ok data))
  ;; result –¥–æ–ª–∂–Ω–∞ –æ—Å—Ç–∞—Ç—å—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω–æ–π
  (assert (= result "–≤–Ω–µ—à–Ω—è—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è")))
```

---

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞

### –ü—Ä–æ–±–ª–µ–º—ã –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:
- **–í—ã—Å–æ–∫–∞—è —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å**: 35+ –≤ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö
- **–ì–ª—É–±–æ–∫–∞—è –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å**: –¥–æ 6 —É—Ä–æ–≤–Ω–µ–π if-else
- **–†—É—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –ø—Ä–æ–≤–µ—Ä–æ–∫
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏**: —Ç—Ä—É–¥–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã
- **–ü–æ–¥–≤–µ—Ä–∂–µ–Ω–Ω–æ—Å—Ç—å –±–∞–≥–∞–º**: –º–Ω–æ–≥–æ –º–µ—Å—Ç –¥–ª—è –æ—à–∏–±–æ–∫

### –ú–µ—Ç—Ä–∏–∫–∏ —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–¥–∞:
```
process-include:  ~80 —Å—Ç—Ä–æ–∫, —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: 12
process-line:     ~120 —Å—Ç—Ä–æ–∫, —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: 15  
preprocess:       ~60 —Å—Ç—Ä–æ–∫, —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: 8
–û–±—â–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å:  –í–´–°–û–ö–ê–Ø
```

---

## üöÄ –ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

1. **üìâ –°–Ω–∏–∂–µ–Ω–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞ –≤ 3-4 —Ä–∞–∑–∞**
2. **üîß –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
3. **üß© –ö–æ–º–ø–æ–∑–∏—Ä—É–µ–º–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π**
4. **üìñ –£–ª—É—á—à–µ–Ω–Ω–∞—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å**
5. **üêõ –ú–µ–Ω—å—à–µ –º–µ—Å—Ç–∞ –¥–ª—è –æ—à–∏–±–æ–∫**
6. **üß™ –õ–µ–≥—á–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å**
7. **üîÑ –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤**

### –ú–µ—Ç—Ä–∏–∫–∏ –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–¥–∞:
```
process-include-m: ~15 —Å—Ç—Ä–æ–∫, —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: 2
process-line-m:    ~30 —Å—Ç—Ä–æ–∫, —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: 3
preprocess-m:      ~20 —Å—Ç—Ä–æ–∫, —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: 2
–û–±—â–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å:   –ù–ò–ó–ö–ê–Ø
```

---

// ... existing code ...
```

–¢–µ–ø–µ—Ä—å –æ–±–Ω–æ–≤–ª—é –ø–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å —É—á–µ—Ç–æ–º –≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–æ–π —á–∏—Å—Ç–æ—Ç—ã:

```markdown
## üìã –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### üóìÔ∏è –≠—Ç–∞–ø 1 (–î–µ–Ω—å 1, 6 —á–∞—Å–æ–≤): –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ò–ù–§–†–ê–°–¢–†–£–ö–¢–£–†–ê
- ‚úÖ **–°–æ–∑–¥–∞—Ç—å –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–µ —Ç–∏–ø—ã Result/Either** (1 —á–∞—Å)
- ‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** (bind, map, etc.) (1 —á–∞—Å)
- üîí **–°–û–ó–î–ê–¢–¨ –ì–ò–ì–ò–ï–ù–ò–ß–ï–°–ö–ò–ô –ú–ê–ö–†–û–° do-result** (3 —á–∞—Å–∞)
  - –Ø–≤–Ω—ã–µ gensym –≤–º–µ—Å—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö –∏–º–µ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
  - –§—É–Ω–∫—Ü–∏—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ü–µ–ø–æ—á–∫–∏ (–Ω–µ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –º–∞–∫—Ä–æ—Å)
  - –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- ‚úÖ **–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã –≥–∏–≥–∏–µ–Ω—ã** (1 —á–∞—Å)
  - –¢–µ—Å—Ç –∑–∞—Ö–≤–∞—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
  - –¢–µ—Å—Ç –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö –∏–º–µ–Ω
  - –¢–µ—Å—Ç –∫–æ–º–ø–æ–∑–∏—Ä—É–µ–º–æ—Å—Ç–∏
  - –¢–µ—Å—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö do-result

### üóìÔ∏è –≠—Ç–∞–ø 2 (–î–µ–Ω—å 1-2, 6 —á–∞—Å–æ–≤): –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å validate-filename
- ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å find-include-file
- ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å parse-macro-definition
- ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å expand-macros
- ‚úÖ –¢–µ—Å—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏

### üóìÔ∏è –≠—Ç–∞–ø 3 (–î–µ–Ω—å 2, 4 —á–∞—Å–∞): –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∏—Ä–µ–∫—Ç–∏–≤
- ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å process-include
- ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å process-define
- ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å —É—Å–ª–æ–≤–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

### üóìÔ∏è –≠—Ç–∞–ø 4 (–î–µ–Ω—å 3, 4 —á–∞—Å–∞): –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
- ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å process-line
- ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é preprocess
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å API (–æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)
- ‚úÖ –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### üóìÔ∏è –≠—Ç–∞–ø 5 (–î–µ–Ω—å 3, 2 —á–∞—Å–∞): –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- ‚úÖ –ü—Ä–æ–≤–µ—Å—Ç–∏ code review
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CI/CD
- ‚úÖ –î–µ–ø–ª–æ–π –≤ staging

### ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –¢–û–ß–ö–ò –ö–û–ù–¢–†–û–õ–Ø:

#### –ü–æ—Å–ª–µ –≠—Ç–∞–ø–∞ 1:
- [ ] –ú–∞–∫—Ä–æ—Å do-result –ø—Ä–æ—Ö–æ–¥–∏—Ç –í–°–ï —Ç–µ—Å—Ç—ã –≥–∏–≥–∏–µ–Ω—ã
- [ ] –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
- [ ] –ö–æ–º–ø–æ–∑–∏—Ä—É–µ–º–æ—Å—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ —Ç–µ—Å—Ç–∞–º–∏

#### –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞:
- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –ù–µ—Ç —Ä–µ–≥—Ä–µ—Å—Å–∏–π –≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- [ ] –ö–æ–¥ review –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
```

–¢–µ–ø–µ—Ä—å –æ–±–Ω–æ–≤–ª—é —Ñ–∏–Ω–∞–ª—å–Ω—É—é —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é:

```markdown
## üèÜ –§–∏–Ω–∞–ª—å–Ω–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

**–ú–û–ù–ê–î–ò–ß–ï–°–ö–ò–ô –†–ï–§–ê–ö–¢–û–†–ò–ù–ì –ü–†–ï–ü–†–û–¶–ï–°–°–û–†–ê - –í–´–°–û–ö–û–ü–†–ò–û–†–ò–¢–ï–¢–ù–ê–Ø –ó–ê–î–ê–ß–ê**

### –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:
- ‚úÖ **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–∂–Ω–æ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞**
- ‚úÖ **–í—ã—Å–æ–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–¥–∞**
- ‚úÖ **–ù–∞–ª–∏—á–∏–µ –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã**
- ‚úÖ **–û—Ç–ª–∏—á–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç/–≤—ã–≥–æ–¥**
- ‚úÖ **–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –¥–ª—è –∫–æ–º–∞–Ω–¥—ã**
- üîí **–û–ü–´–¢ –°–û–ó–î–ê–ù–ò–Ø –ì–ò–ì–ò–ï–ù–ò–ß–ï–°–ö–ò–• –ú–ê–ö–†–û–°–û–í** (–∫—Ä–∏—Ç–∏—á–Ω–æ!)

### üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø:

#### 1. –ì–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∞—è —á–∏—Å—Ç–æ—Ç–∞ –º–∞–∫—Ä–æ—Å–∞ do-result:
- **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û**: –Ø–≤–Ω—ã–µ gensym –≤–º–µ—Å—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö
- **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û**: –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö –∏–º–µ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û**: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –º–∞–∫—Ä–æ—Å–∞
- **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û**: –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã –≥–∏–≥–∏–µ–Ω—ã

#### 2. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏–∑ do-parse
- –ò–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫ –ø–µ—Ä–≤—ã—Ö –≤–µ—Ä—Å–∏–π –º–∞–∫—Ä–æ—Å–æ–≤
- –û–±–µ—Å–ø–µ—á–∏—Ç—å –∫–æ–º–ø–æ–∑–∏—Ä—É–µ–º–æ—Å—Ç—å –±–µ–∑ –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞—Ö–≤–∞—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
1. **–ü–æ–ª—É—á–∏—Ç—å –æ–¥–æ–±—Ä–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã**
2. **–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –≤ –±–ª–∏–∂–∞–π—à–µ–º —Å–ø—Ä–∏–Ω—Ç–µ**
3. **–ù–ê–ß–ê–¢–¨ –° –°–û–ó–î–ê–ù–ò–Ø –ì–ò–ì–ò–ï–ù–ò–ß–ï–°–ö–û–ì–û –ú–ê–ö–†–û–°–ê** (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç #1)
4. **–ü–æ—ç—Ç–∞–ø–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏**
5. **–ü—Ä–æ–≤–µ—Å—Ç–∏ —Ç—â–∞—Ç–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–∏–≥–∏–µ–Ω—ã**

### ‚öñÔ∏è –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤:

**–†–∏—Å–∫–∏ –°–ù–ò–ñ–ï–ù–´** –±–ª–∞–≥–æ–¥–∞—Ä—è –æ–ø—ã—Ç—É —Å do-parse:
- ‚úÖ –ó–Ω–∞–µ–º –∫–∞–∫ –¥–µ–ª–∞—Ç—å –≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∏–µ –º–∞–∫—Ä–æ—Å—ã
- ‚úÖ –ï—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- ‚úÖ –ü–æ–Ω–∏–º–∞–µ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–æ—á–∫–∏ –æ—Ç–∫–∞–∑–∞
- ‚úÖ –ò–º–µ–µ–º –≥–æ—Ç–æ–≤—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–ù–æ–≤—ã–µ —Ä–∏—Å–∫–∏ –ú–ò–ù–ò–ú–ò–ó–ò–†–û–í–ê–ù–´**:
- –í—Ä–µ–º—è –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–æ–≥–æ –º–∞–∫—Ä–æ—Å–∞ (+1 –¥–µ–Ω—å)
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ (+0.5 –¥–Ω—è)
- –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è –æ—Ç–ª–∞–¥–∫–∞ –º–∞–∫—Ä–æ—Å–æ–≤ (–∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç—Å—è –æ–ø—ã—Ç–æ–º)

### üí∞ –û–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:

**–ó–∞—Ç—Ä–∞—Ç—ã**: 22 —á–∞—Å–∞ (2.75 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è) - —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –Ω–∞ 10%
**–í—ã–≥–æ–¥—ã**: –¢–µ –∂–µ + –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –æ—Ç –±–∞–≥–æ–≤
**ROI**: 450%+ –≤ –ø–µ—Ä–≤—ã–π –≥–æ–¥ (—Å —É—á–µ—Ç–æ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç)

---

*–î–æ–∫—É–º–µ–Ω—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞ C51CC –∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –æ–ø—ã—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∏—Ö –º–∞–∫—Ä–æ—Å–æ–≤*
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ –ø–æ –≤–æ–ø—Ä–æ—Å—É –æ –≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–æ–π —á–∏—Å—Ç–æ—Ç–µ

**–î–∞, –∞–±—Å–æ–ª—é—Ç–Ω–æ —Ç–æ—á–Ω–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∏ —á–∏—Å—Ç—ã–π –º–∞–∫—Ä–æ—Å `do-result` —Å –∑–∞—â–∏—Ç–æ–π –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω!**

### üéØ –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã:

1. **–û–ø—ã—Ç —Å `do-parse` –ø–æ–∫–∞–∑–∞–ª –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é –≤–∞–∂–Ω–æ—Å—Ç—å –≥–∏–≥–∏–µ–Ω—ã**:
   - –ü–µ—Ä–≤—ã–µ –≤–µ—Ä—Å–∏–∏ –∏–º–µ–ª–∏ —Å–µ—Ä—å–µ–∑–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –∑–∞—Ö–≤–∞—Ç–æ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π `gensym` (`symbol#`) —Å–æ–∑–¥–∞–µ—Ç –†–ê–ó–ù–´–ï —Å–∏–º–≤–æ–ª—ã –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏
   - –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ –º–∞–∫—Ä–æ—Å—ã —Å–æ–∑–¥–∞—é—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏ —Å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞–º–∏

2. **–°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏ –¥–ª—è –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –µ—â–µ –≤—ã—à–µ**:
   - –ë–æ–ª—å—à–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö: `state`, `result`, `error`, `filename`, `include-file`
   - –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
   - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–∂–Ω–æ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –¥–ª—è –≤—Å–µ–≥–æ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞

3. **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç**:
   - **–Ø–≤–Ω—ã–µ `gensym`** –≤–º–µ—Å—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö
   - **–í–∞–ª–∏–¥–∞—Ü–∏—é –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö –∏–º–µ–Ω** –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
   - **–§—É–Ω–∫—Ü–∏—é –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ü–µ–ø–æ—á–∫–∏** –≤–º–µ—Å—Ç–æ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–≥–æ –º–∞–∫—Ä–æ—Å–∞
   - **–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã –≥–∏–≥–∏–µ–Ω—ã**

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø–ª–∞–Ω:

- **–í—Ä–µ–º—è —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è**: +1 –¥–µ–Ω—å –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–æ–≥–æ –º–∞–∫—Ä–æ—Å–∞
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å –≤–æ–∑—Ä–∞—Å—Ç–∞–µ—Ç**: —Ç—Ä–µ–±—É–µ—Ç—Å—è –±–æ–ª—å—à–µ —Ç–µ—Å—Ç–æ–≤ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **–†–∏—Å–∫–∏ —Å–Ω–∏–∂–∞—é—Ç—Å—è**: –æ–ø—ã—Ç —Å `do-parse` –¥–∞–µ—Ç –≥–æ—Ç–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
- **–ö–∞—á–µ—Å—Ç–≤–æ –ø–æ–≤—ã—à–∞–µ—Ç—Å—è**: –≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∏–π –º–∞–∫—Ä–æ—Å = –º–µ–Ω—å—à–µ –±–∞–≥–æ–≤

### üèÜ –ò—Ç–æ–≥–æ–≤–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:

**–ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –û–°–¢–ê–ï–¢–°–Ø –≤—ã—Å–æ–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–µ–π**, –Ω–æ —Å **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º** —Å–æ–∑–¥–∞–Ω–∏–µ–º –≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∏ —á–∏—Å—Ç–æ–≥–æ –º–∞–∫—Ä–æ—Å–∞ `do-result` –∫–∞–∫ –ø–µ—Ä–≤—ã–º –∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–º —ç—Ç–∞–ø–æ–º.

### üîí –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

1. **–ù–ï –ø–æ–≤—Ç–æ—Ä—è—Ç—å –æ—à–∏–±–∫–∏ –ø–µ—Ä–≤—ã—Ö –≤–µ—Ä—Å–∏–π `do-parse`**
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã** –∏–∑ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏
3. **–ù–∞—á–∞—Ç—å –∏–º–µ–Ω–Ω–æ —Å –º–∞–∫—Ä–æ—Å–∞** - —ç—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –≤—Å–µ–≥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞
4. **–ü—Ä–æ–≤–µ—Å—Ç–∏ –∏—Å—á–µ—Ä–ø—ã–≤–∞—é—â–µ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–∏–≥–∏–µ–Ω—ã** –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –∫ —Å–ª–µ–¥—É—é—â–∏–º —ç—Ç–∞–ø–∞–º

### üí° –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

- **–î–µ–Ω—å 1**: –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ—Å–≤—è—Ç–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏—é –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é `do-result`
- **–ù–µ —Ç–æ—Ä–æ–ø–∏—Ç—å—Å—è**: –ª—É—á—à–µ –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –Ω–∞ –º–∞–∫—Ä–æ—Å, —á–µ–º –ø–æ—Ç–æ–º –∏—Å–ø—Ä–∞–≤–ª—è—Ç—å –±–∞–≥–∏ –∑–∞—Ö–≤–∞—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–¥**: –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏–∑ `do-parse` –º–æ–∂–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å
- **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å**: –∫–∞–∂–¥–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø–æ –≥–∏–≥–∏–µ–Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ

–û–ø—ã—Ç –∫–æ–º–∞–Ω–¥—ã —Å —Å–æ–∑–¥–∞–Ω–∏–µ–º –≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∏—Ö –º–∞–∫—Ä–æ—Å–æ–≤ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —Ä–∏—Å–∫ –≤ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ. –ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π `do-result` —Å—Ç–∞–Ω–µ—Ç –Ω–∞–¥–µ–∂–Ω—ã–º —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–æ–º –¥–ª—è –≤—Å–µ–≥–æ –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞.

---

**User**

–í–æ–ø—Ä–æ—Å!
–ù–∞–¥–æ –ª–∏ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å –ª–µ–∫—Å–µ—Ä –≤ –º–æ–Ω–∞–¥—ã –∏–ª–∏ –ø–æ–∫–∞ –≤—Å–µ —Ö–æ—Ä–æ—à–æ?

---

**Cursor**

–û—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å! –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ª–µ–∫—Å–µ—Ä–∞ –∏ –æ—Ü–µ–Ω–∏–º —Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–æ—Å—Ç—å –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞.

```clojure
(ns lexer-analysis
  "–ê–Ω–∞–ª–∏–∑ –ª–µ–∫—Å–µ—Ä–∞ C51CC –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞"
  (:require [c51cc.lexer :as lexer]))

(defn analyze-lexer-architecture []
  (println "üîç –ê–ù–ê–õ–ò–ó –ê–†–•–ò–¢–ï–ö–¢–£–†–´ –õ–ï–ö–°–ï–†–ê C51CC")
  (println (str "=" (apply str (repeat 60 "="))))
  
  (println "\nüìä –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï:")
  (println "   ‚Ä¢ –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: ~240 —Å—Ç—Ä–æ–∫")
  (println "   ‚Ä¢ –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è: tokenize")
  (println "   ‚Ä¢ –ü–æ–¥—Ö–æ–¥: –ò–º–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π —Å regex")
  (println "   ‚Ä¢ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç")
  (println "   ‚Ä¢ –í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–π —Ç–∏–ø: Vector —Ç–æ–∫–µ–Ω–æ–≤ –∏–ª–∏ nil")
  
  (println "\nüéØ –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–´–ï –û–°–û–ë–ï–ù–ù–û–°–¢–ò:")
  (println "   ‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç regex –¥–ª—è —Ä–∞–∑–±–æ—Ä–∞")
  (println "   ‚Ä¢ –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –≤—ã–∑–æ–≤ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤")
  (println "   ‚Ä¢ –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤")
  (println "   ‚Ä¢ –ü—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è")
  (println "   ‚Ä¢ –ù–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É –≤—ã–∑–æ–≤–∞–º–∏"))

(defn test-lexer-behavior []
  (println "\nüß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ü–û–í–ï–î–ï–ù–ò–Ø –õ–ï–ö–°–ï–†–ê:")
  (println (str "-" (apply str (repeat 50 "-"))))
  
  ;; –¢–µ—Å—Ç 1: –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤–≤–æ–¥
  (println "\n1. –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤–≤–æ–¥:")
  (let [result (lexer/tokenize "int x = 42;")]
    (println "   –í–≤–æ–¥: \"int x = 42;\"")
    (println "   –†–µ–∑—É–ª—å—Ç–∞—Ç:" (if result "–£—Å–ø–µ—Ö" "–û—à–∏–±–∫–∞"))
    (when result
      (println "   –¢–æ–∫–µ–Ω–æ–≤:" (count result))
      (println "   –ü–µ—Ä–≤—ã–π —Ç–æ–∫–µ–Ω:" (first result))))
  
  ;; –¢–µ—Å—Ç 2: –ü—É—Å—Ç–æ–π –≤–≤–æ–¥
  (println "\n2. –ü—É—Å—Ç–æ–π –≤–≤–æ–¥:")
  (let [result (lexer/tokenize "")]
    (println "   –í–≤–æ–¥: \"\"")
    (println "   –†–µ–∑—É–ª—å—Ç–∞—Ç:" (if result "–£—Å–ø–µ—Ö" "–û—à–∏–±–∫–∞"))
    (println "   –¢–æ–∫–µ–Ω–æ–≤:" (if result (count result) "N/A")))
  
  ;; –¢–µ—Å—Ç 3: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
  (println "\n3. –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã:")
  (let [result (lexer/tokenize "int x @ 42;")]
    (println "   –í–≤–æ–¥: \"int x @ 42;\"")
    (println "   –†–µ–∑—É–ª—å—Ç–∞—Ç:" (if result "–£—Å–ø–µ—Ö" "–û—à–∏–±–∫–∞"))
    (when result
      (println "   –¢–æ–∫–µ–Ω–æ–≤:" (count result))
      (println "   –°–æ–¥–µ—Ä–∂–∏—Ç nil?" (some nil? result))))
  
  ;; –¢–µ—Å—Ç 4: –¢–æ–ª—å–∫–æ –ø—Ä–æ–±–µ–ª—ã
  (println "\n4. –¢–æ–ª—å–∫–æ –ø—Ä–æ–±–µ–ª—ã:")
  (let [result (lexer/tokenize "   \n\t  ")]
    (println "   –í–≤–æ–¥: \"   \\n\\t  \"")
    (println "   –†–µ–∑—É–ª—å—Ç–∞—Ç:" (if result "–£—Å–ø–µ—Ö" "–û—à–∏–±–∫–∞"))
    (println "   –¢–æ–∫–µ–Ω–æ–≤:" (if result (count result) "N/A"))))

(defn analyze-error-handling []
  (println "\n‚ùå –ê–ù–ê–õ–ò–ó –û–ë–†–ê–ë–û–¢–ö–ò –û–®–ò–ë–û–ö:")
  (println (str "-" (apply str (repeat 50 "-"))))
  
  (println "\nüö® –ü–†–û–ë–õ–ï–ú–´:")
  (println "   1. –ù–ï–¢ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫")
  (println "   2. –ù–ï–¢ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π")
  (println "   3. –ù–ï–¢ –ø–æ–∑–∏—Ü–∏–∏ –æ—à–∏–±–∫–∏")
  (println "   4. –ù–ï–¢ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –æ—à–∏–±–∫–∏")
  (println "   5. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç nil –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ")
  
  (println "\n‚ö†Ô∏è  –ü–û–°–õ–ï–î–°–¢–í–ò–Ø:")
  (println "   ‚Ä¢ –°–ª–æ–∂–Ω–æ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤–≤–æ–¥")
  (println "   ‚Ä¢ –ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–∏—á–∏–Ω–µ –æ—à–∏–±–∫–∏")
  (println "   ‚Ä¢ –ü–∞—Ä—Å–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç –Ω–µ–ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é")
  (println "   ‚Ä¢ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç —á—Ç–æ –Ω–µ —Ç–∞–∫"))

(defn analyze-complexity []
  (println "\nüìà –ê–ù–ê–õ–ò–ó –°–õ–û–ñ–ù–û–°–¢–ò:")
  (println (str "-" (apply str (repeat 50 "-"))))
  
  (println "\nüìä –ú–ï–¢–†–ò–ö–ò:")
  (println "   ‚Ä¢ –¶–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: –ù–ò–ó–ö–ê–Ø (~5)")
  (println "   ‚Ä¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ª–æ–≤–∏–π: ~50 (cond)")
  (println "   ‚Ä¢ –ì–ª—É–±–∏–Ω–∞ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏: 2-3 —É—Ä–æ–≤–Ω—è")
  (println "   ‚Ä¢ –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞: –ú–ò–ù–ò–ú–ê–õ–¨–ù–û–ï")
  (println "   ‚Ä¢ –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å: –•–û–†–û–®–ê–Ø")
  
  (println "\n‚úÖ –°–ò–õ–¨–ù–´–ï –°–¢–û–†–û–ù–´:")
  (println "   ‚Ä¢ –ü—Ä–æ—Å—Ç–∞—è –∏ –ø–æ–Ω—è—Ç–Ω–∞—è –ª–æ–≥–∏–∫–∞")
  (println "   ‚Ä¢ –•–æ—Ä–æ—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å")
  (println "   ‚Ä¢ –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ç–æ–∫–µ–Ω—ã")
  (println "   ‚Ä¢ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏")
  (println "   ‚Ä¢ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å")
  
  (println "\n‚ùå –°–õ–ê–ë–´–ï –°–¢–û–†–û–ù–´:")
  (println "   ‚Ä¢ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫")
  (println "   ‚Ä¢ –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö")
  (println "   ‚Ä¢ –ë–æ–ª—å—à–æ–π cond –±–ª–æ–∫")
  (println "   ‚Ä¢ –ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–∑–∏—Ü–∏–∏")
  (println "   ‚Ä¢ –°–ª–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤"))

(defn monadic-vs-current []
  (println "\n‚öñÔ∏è  –°–†–ê–í–ù–ï–ù–ò–ï: –¢–ï–ö–£–©–ò–ô vs –ú–û–ù–ê–î–ò–ß–ï–°–ö–ò–ô –ü–û–î–•–û–î:")
  (println (str "=" (apply str (repeat 60 "="))))
  
  (println "\nüîÑ –¢–ï–ö–£–©–ò–ô –ü–û–î–•–û–î:")
  (println "```clojure")
  (println "(defn tokenize [input]")
  (println "  (let [tokens (re-seq pattern input)]")
  (println "    (if (= (count tokens) 1)")
  (println "      (cond")
  (println "        (= token \"int\") [int-type]")
  (println "        (= token \"void\") [void-type]")
  (println "        ;; ... 50+ —É—Å–ª–æ–≤–∏–π")
  (println "        :else nil)")
  (println "      (mapcat tokenize tokens))))")
  (println "```")
  
  (println "\nüöÄ –ú–û–ù–ê–î–ò–ß–ï–°–ö–ò–ô –ü–û–î–•–û–î:")
  (println "```clojure")
  (println "(defn tokenize-m [input]")
  (println "  (do-result")
  (println "    [validated-input (validate-input input)")
  (println "     raw-tokens (extract-tokens validated-input)")
  (println "     typed-tokens (map-tokens classify-token raw-tokens)")
  (println "     final-tokens (validate-tokens typed-tokens)]")
  (println "    (ok final-tokens)))")
  (println "```")
  
  (println "\nüìä –°–†–ê–í–ù–ï–ù–ò–ï –ú–ï–¢–†–ò–ö:")
  (println "| –ê—Å–ø–µ–∫—Ç | –¢–µ–∫—É—â–∏–π | –ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–π |")
  (println "|--------|---------|--------------|")
  (println "| –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ | ‚ùå –ù–µ—Ç | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è |")
  (println "| –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç—å | ‚ùå –ù–∏–∑–∫–∞—è | ‚úÖ –í—ã—Å–æ–∫–∞—è |")
  (println "| –ö–æ–º–ø–æ–∑–∏—Ä—É–µ–º–æ—Å—Ç—å | ‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è | ‚úÖ –í—ã—Å–æ–∫–∞—è |")
  (println "| –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å | ‚úÖ –•–æ—Ä–æ—à–∞—è | ‚úÖ –û—Ç–ª–∏—á–Ω–∞—è |")
  (println "| –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | ‚úÖ –í—ã—Å–æ–∫–∞—è | ‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è |")
  (println "| –°–ª–æ–∂–Ω–æ—Å—Ç—å –∫–æ–¥–∞ | ‚úÖ –ù–∏–∑–∫–∞—è | ‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è |")
  (println "| –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å | ‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è | ‚úÖ –í—ã—Å–æ–∫–∞—è |")
  (println "| –û—Ç–ª–∞–¥–∫–∞ | ‚ùå –°–ª–æ–∂–Ω–∞—è | ‚úÖ –ü—Ä–æ—Å—Ç–∞—è |"))

(defn cost-benefit-analysis []
  (println "\nüí∞ –ê–ù–ê–õ–ò–ó –ó–ê–¢–†–ê–¢ –ò –í–´–ì–û–î:")
  (println (str "=" (apply str (repeat 50 "="))))
  
  (println "\nüí∏ –ó–ê–¢–†–ê–¢–´ –ù–ê –†–ï–§–ê–ö–¢–û–†–ò–ù–ì:")
  (println "   ‚Ä¢ –í—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏: 1-1.5 –¥–Ω—è")
  (println "   ‚Ä¢ –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã: 4 —á–∞—Å–∞")
  (println "   ‚Ä¢ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Ñ—É–Ω–∫—Ü–∏–∏ tokenize: 2 —á–∞—Å–∞")
  (println "   ‚Ä¢ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫: 2 —á–∞—Å–∞")
  (println "   ‚Ä¢ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: 2 —á–∞—Å–∞")
  (println "   ‚Ä¢ –ò–¢–û–ì–û: ~10 —á–∞—Å–æ–≤")
  
  (println "\nüíé –í–´–ì–û–î–´:")
  (println "   ‚Ä¢ –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö")
  (println "   ‚Ä¢ –ü–æ–∑–∏—Ü–∏—è –æ—à–∏–±–∫–∏ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ")
  (println "   ‚Ä¢ –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ —Å –ø–∞—Ä—Å–µ—Ä–æ–º –∏ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–º")
  (println "   ‚Ä¢ –õ–µ–≥–∫–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π")
  (println "   ‚Ä¢ –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ—Ç–ª–∞–¥–∫–∞")
  
  (println "\n‚öñÔ∏è –°–û–û–¢–ù–û–®–ï–ù–ò–ï –ó–ê–¢–†–ê–¢/–í–´–ì–û–î:")
  (println "   ‚Ä¢ –ó–∞—Ç—Ä–∞—Ç—ã: –ù–ò–ó–ö–ò–ï (–ª–µ–∫—Å–µ—Ä –ø—Ä–æ—Å—Ç–æ–π)")
  (println "   ‚Ä¢ –í—ã–≥–æ–¥—ã: –°–†–ï–î–ù–ò–ï (—É–ª—É—á—à–µ–Ω–∏–µ UX)")
  (println "   ‚Ä¢ ROI: –ü–û–õ–û–ñ–ò–¢–ï–õ–¨–ù–´–ô, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–π")
  (println "   ‚Ä¢ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ù–ò–ó–ö–ò–ô"))

(defn final-recommendation []
  (println "\nüéØ –§–ò–ù–ê–õ–¨–ù–ê–Ø –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø:")
  (println (str "=" (apply str (repeat 50 "="))))
  
  (println "\nüìã –í–ï–†–î–ò–ö–¢: –ü–û–ö–ê –ù–ï –ù–£–ñ–ù–û")
  
  (println "\n‚úÖ –ê–†–ì–£–ú–ï–ù–¢–´ –ü–†–û–¢–ò–í —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:")
  (println "   1. –õ–µ–∫—Å–µ—Ä –†–ê–ë–û–¢–ê–ï–¢ —Å—Ç–∞–±–∏–ª—å–Ω–æ")
  (println "   2. –°–ª–æ–∂–Ω–æ—Å—Ç—å –∫–æ–¥–∞ –ù–ò–ó–ö–ê–Ø")
  (println "   3. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –í–´–°–û–ö–ê–Ø")
  (println "   4. –û—à–∏–±–∫–∏ –ª–µ–∫—Å–µ—Ä–∞ –†–ï–î–ö–ò")
  (println "   5. –ï—Å—Ç—å –±–æ–ª–µ–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏")
  
  (println "\n‚ö†Ô∏è  –ê–†–ì–£–ú–ï–ù–¢–´ –ó–ê —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥:")
  (println "   1. –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã")
  (println "   2. –£–ª—É—á—à–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö")
  (println "   3. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –±—É–¥—É—â–∏–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º")
  
  (println "\nüìÖ –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–ê–Ø –°–¢–†–ê–¢–ï–ì–ò–Ø:")
  (println "   1. –°–ù–ê–ß–ê–õ–ê: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ (–≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)")
  (println "   2. –ü–û–¢–û–ú: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –ø–∞—Ä—Å–µ—Ä–∞")
  (println "   3. –ó–ê–¢–ï–ú: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –ª–µ–∫—Å–µ—Ä–∞ (–µ—Å–ª–∏ –±—É–¥–µ—Ç –≤—Ä–µ–º—è)")
  (println "   4. –ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ê: –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫")
  
  (println "\nüîÑ –ö–û–ú–ü–†–û–ú–ò–°–°–ù–û–ï –†–ï–®–ï–ù–ò–ï:")
  (println "   ‚Ä¢ –î–æ–±–∞–≤–∏—Ç—å –±–∞–∑–æ–≤—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –ë–ï–ó –º–æ–Ω–∞–¥")
  (println "   ‚Ä¢ –£–ª—É—á—à–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö")
  (println "   ‚Ä¢ –î–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é –æ—à–∏–±–∫–∏")
  (println "   ‚Ä¢ –í—Ä–µ–º—è: 2-3 —á–∞—Å–∞ –≤–º–µ—Å—Ç–æ 10")
  
  (println "\nüèÜ –ò–¢–û–ì:")
  (println "   –õ–µ–∫—Å–µ—Ä –≤ –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–º —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ –ù–ï –ù–£–ñ–î–ê–ï–¢–°–Ø")
  (println "   –≤ –±–ª–∏–∂–∞–π—à–µ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ. –°–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Ç–µ—Å—å –Ω–∞ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ!"))

(defn -main []
  (println "üî¨ –ê–ù–ê–õ–ò–ó –ù–ï–û–ë–•–û–î–ò–ú–û–°–¢–ò –ú–û–ù–ê–î–ò–ß–ï–°–ö–û–ì–û –†–ï–§–ê–ö–¢–û–†–ò–ù–ì–ê –õ–ï–ö–°–ï–†–ê")
  (println (str "=" (apply str (repeat 80 "="))))
  
  (analyze-lexer-architecture)
  (test-lexer-behavior)
  (analyze-error-handling)
  (analyze-complexity)
  (monadic-vs-current)
  (cost-benefit-analysis)
  (final-recommendation)
  
  (println "\n" (str "=" (apply str (repeat 80 "="))))
  (println "üìù –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï: –õ–µ–∫—Å–µ—Ä –º–æ–∂–µ—Ç –ø–æ–¥–æ–∂–¥–∞—Ç—å. –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä - –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç!")
  (println (str "=" (apply str (repeat 80 "=")))))

(-main)
```

## üéØ –û—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å –æ –ª–µ–∫—Å–µ—Ä–µ

**–í–ï–†–î–ò–ö–¢: –õ–µ–∫—Å–µ—Ä –≤ –º–æ–Ω–∞–¥—ã –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å –ü–û–ö–ê –ù–ï –ù–£–ñ–ù–û!**

### üìä –ê–Ω–∞–ª–∏–∑ –ø–æ–∫–∞–∑–∞–ª:

#### ‚úÖ **–ê—Ä–≥—É–º–µ–Ω—Ç—ã –ü–†–û–¢–ò–í –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –ª–µ–∫—Å–µ—Ä–∞:**

1. **–õ–µ–∫—Å–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ** - –Ω–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º
2. **–ù–∏–∑–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∫–æ–¥–∞** - –≤—Å–µ–≥–æ ~240 —Å—Ç—Ä–æ–∫, —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å ~5
3. **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - regex-based –ø–æ–¥—Ö–æ–¥ –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä—ã–π
4. **–†–µ–¥–∫–∏–µ –æ—à–∏–±–∫–∏** - –ª–µ–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –Ω–µ—á–∞—Å—Ç–æ
5. **–ï—Å—Ç—å –±–æ–ª–µ–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏** - –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –∫—Ä–∏—Ç–∏—á–Ω–µ–µ

#### ‚ö†Ô∏è **–ê—Ä–≥—É–º–µ–Ω—Ç—ã –ó–ê (–Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ):**

1. **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã** - –±—ã–ª–æ –±—ã –∫—Ä–∞—Å–∏–≤–æ –∏–º–µ—Ç—å –≤—Å–µ –≤ –º–æ–Ω–∞–¥–∞—Ö
2. **–£–ª—É—á—à–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö** - —Å–µ–π—á–∞—Å –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `nil`
3. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –±—É–¥—É—â–∏–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º** - –µ—Å–ª–∏ –ø–ª–∞–Ω–∏—Ä—É—é—Ç—Å—è —Å–ª–æ–∂–Ω—ã–µ —Ñ–∏—á–∏

### üìà **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫:**

| –ê—Å–ø–µ–∫—Ç | –¢–µ–∫—É—â–∏–π –ª–µ–∫—Å–µ—Ä | –ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–π |
|--------|----------------|--------------|
| **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** | ‚ùå –ù–µ—Ç | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | ‚úÖ –í—ã—Å–æ–∫–∞—è | ‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è |
| **–°–ª–æ–∂–Ω–æ—Å—Ç—å –∫–æ–¥–∞** | ‚úÖ –ù–∏–∑–∫–∞—è | ‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è |
| **–í—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏** | ‚úÖ 0 —á–∞—Å–æ–≤ | ‚ùå 10 —á–∞—Å–æ–≤ |

### üéØ **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:**

1. **–°–ù–ê–ß–ê–õ–ê**: –ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ **–ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞** (–≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
2. **–ü–û–¢–û–ú**: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ **–ø–∞—Ä—Å–µ—Ä–∞** 
3. **–ó–ê–¢–ï–ú**: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ **–ª–µ–∫—Å–µ—Ä–∞** (–µ—Å–ª–∏ –±—É–¥–µ—Ç –≤—Ä–µ–º—è –∏ –∂–µ–ª–∞–Ω–∏–µ)

### üîÑ **–ö–æ–º–ø—Ä–æ–º–∏—Å—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ** (–µ—Å–ª–∏ –æ—á–µ–Ω—å —Ö–æ—á–µ—Ç—Å—è —É–ª—É—á—à–∏—Ç—å):

–í–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–≥–æ –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –º–æ–∂–Ω–æ:
- –î–æ–±–∞–≤–∏—Ç—å –±–∞–∑–æ–≤—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ **–ë–ï–ó –º–æ–Ω–∞–¥**
- –£–ª—É—á—à–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- –î–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é –æ—à–∏–±–∫–∏ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ
- **–í—Ä–µ–º—è**: 2-3 —á–∞—Å–∞ –≤–º–µ—Å—Ç–æ 10

### üí° **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è:**

**–ü–æ—á–µ–º—É –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–µ–µ:**
- –í—ã—Å–æ–∫–∞—è —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å (35+ vs 5)
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–∂–Ω–æ—Å—Ç—å –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞
- –°–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- –ú–Ω–æ–≥–æ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π

**–ü–æ—á–µ–º—É –ª–µ–∫—Å–µ—Ä –º–æ–∂–µ—Ç –ø–æ–¥–æ–∂–¥–∞—Ç—å:**
- –ü—Ä–æ—Å—Ç–∞—è –∏ –ø–æ–Ω—è—Ç–Ω–∞—è –ª–æ–≥–∏–∫–∞
- –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞
- –•–æ—Ä–æ—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–≥–æ–≤

### üèÜ **–ò—Ç–æ–≥–æ–≤–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**

**–°–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Ç–µ—Å—å –Ω–∞ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ!** –õ–µ–∫—Å–µ—Ä –≤ –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–æ–º —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ –Ω–µ –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ –±–ª–∏–∂–∞–π—à–µ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ. –≠—Ç–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Å–ª—É—á–∞–π "–µ—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç - –Ω–µ —Ç—Ä–æ–≥–∞–π", –æ—Å–æ–±–µ–Ω–Ω–æ –∫–æ–≥–¥–∞ –µ—Å—Ç—å –±–æ–ª–µ–µ –≤–∞–∂–Ω—ã–µ –∑–∞–¥–∞—á–∏.

–ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–π –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –¥–∞—Å—Ç –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª—å—à–µ –≤—ã–≥–æ–¥ –ø—Ä–∏ –º–µ–Ω—å—à–∏—Ö —Ä–∏—Å–∫–∞—Ö, —Ç–∞–∫ –∫–∞–∫ —Ç–∞–º –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å–ª–æ–∂–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–Ω–∞–¥—ã —Ä–µ—à–∞—é—Ç —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ.

---

**User**

–≤ –ø–∞—Ä—Å–µ—Ä–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω?

---

**Cursor**

–û—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å! –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –ø–∞—Ä—Å–µ—Ä–∞.

```clojure
(ns parser-refactoring-status
  "–ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –ø–∞—Ä—Å–µ—Ä–∞ C51CC"
  (:require [c51cc.parser :as parser]
            [c51cc.lexer :as lexer]
            [clojure.string :as str]))

(defn analyze-refactoring-status []
  (println "üìä –ê–ù–ê–õ–ò–ó –°–û–°–¢–û–Ø–ù–ò–Ø –†–ï–§–ê–ö–¢–û–†–ò–ù–ì–ê –ü–ê–†–°–ï–†–ê C51CC")
  (println (str "=" (apply str (repeat 70 "="))))
  
  (println "\nüéØ –û–ë–©–ò–ô –°–¢–ê–¢–£–°:")
  (println "   ‚Ä¢ –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: ~1240 —Å—Ç—Ä–æ–∫")
  (println "   ‚Ä¢ –ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞: ‚úÖ –ó–ê–í–ï–†–®–ï–ù–ê")
  (println "   ‚Ä¢ –ì–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∏–π –º–∞–∫—Ä–æ—Å do-parse: ‚úÖ –ó–ê–í–ï–†–®–ï–ù")
  (println "   ‚Ä¢ –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä—ã: ‚úÖ –ó–ê–í–ï–†–®–ï–ù–´")
  (println "   ‚Ä¢ –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä—Å–µ—Ä—ã: üîÑ –ß–ê–°–¢–ò–ß–ù–û –û–¢–†–ï–§–ê–ö–¢–û–†–ï–ù–´"))

(defn analyze-completed-parts []
  (println "\n‚úÖ –ó–ê–í–ï–†–®–ï–ù–ù–´–ï –ß–ê–°–¢–ò –†–ï–§–ê–ö–¢–û–†–ò–ù–ì–ê:")
  (println (str "-" (apply str (repeat 60 "-"))))
  
  (println "\nüèóÔ∏è –ò–ù–§–†–ê–°–¢–†–£–ö–¢–£–†–ê:")
  (println "   ‚úÖ ParseState –∏ ParseResult records")
  (println "   ‚úÖ –ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (bind, return-parser)")
  (println "   ‚úÖ –ì–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∏–π –º–∞–∫—Ä–æ—Å do-parse")
  (println "   ‚úÖ –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä—ã (choice, many, optional)")
  (println "   ‚úÖ –§—É–Ω–∫—Ü–∏–∏ expect-token, expect-token-value")
  
  (println "\nüéØ –û–¢–†–ï–§–ê–ö–¢–û–†–ï–ù–ù–´–ï –ü–ê–†–°–ï–†–´:")
  (println "   ‚úÖ parse-primary-expression (—á–∏—Å–ª–∞, –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã, —Å–∫–æ–±–∫–∏)")
  (println "   ‚úÖ parse-postfix-expression (–≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–π, –º–∞—Å—Å–∏–≤—ã)")
  (println "   ‚úÖ parse-unary-expression (—É–Ω–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã)")
  (println "   ‚úÖ parse-multiplicative-expression (* / %)")
  (println "   ‚úÖ parse-additive-expression (+ -)")
  (println "   ‚úÖ parse-relational-expression (< > <= >=)")
  (println "   ‚úÖ parse-equality-expression (== !=)")
  (println "   ‚úÖ parse-logical-and-expression (&&)")
  (println "   ‚úÖ parse-logical-or-expression (||)")
  (println "   ‚úÖ parse-assignment-expression (=, +=, -=, etc.)")
  (println "   ‚úÖ parse-type-specifier (int, char, void, signed, unsigned)")
  (println "   ‚úÖ parse-single-parameter (–ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ—É–Ω–∫—Ü–∏–π)")
  (println "   ‚úÖ parse-if-statement (—É—Å–ª–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã)")
  (println "   ‚úÖ parse-while-statement (—Ü–∏–∫–ª—ã while)")
  (println "   ‚úÖ parse-for-statement (—Ü–∏–∫–ª—ã for)")
  (println "   ‚úÖ parse-variable-declaration (–æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö)")
  (println "   ‚úÖ parse-function-declaration (–æ–±—ä—è–≤–ª–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π)")
  (println "   ‚úÖ parse-program (–∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞—Ä—Å–µ—Ä)")
  
  (println "\nüîß –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò:")
  (println "   ‚úÖ parse-binary-expression-with-operators")
  (println "   ‚úÖ apply-postfix-operators")
  (println "   ‚úÖ parse-function-body-or-semicolon")
  (println "   ‚úÖ parse-c51-function-modifiers"))

(defn analyze-remaining-parts []
  (println "\n‚ö†Ô∏è  –ß–ê–°–¢–ò, –¢–†–ï–ë–£–Æ–©–ò–ï –í–ù–ò–ú–ê–ù–ò–Ø:")
  (println (str "-" (apply str (repeat 60 "-"))))
  
  (println "\nüîç –ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–û –ù–ï –û–¢–†–ï–§–ê–ö–¢–û–†–ï–ù–ù–´–ï:")
  (println "   ‚ö†Ô∏è  parse-expression-statement - –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π —Å—Ç–∏–ª—å")
  (println "   ‚ö†Ô∏è  parse-return-statement - –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π —Å—Ç–∏–ª—å")
  (println "   ‚ö†Ô∏è  parse-block-statement - –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π —Å—Ç–∏–ª—å")
  (println "   ‚ö†Ô∏è  parse-declaration - –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π —Å—Ç–∏–ª—å")
  (println "   ‚ö†Ô∏è  parse-statement - –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π —Å—Ç–∏–ª—å")
  
  (println "\nüîß –°–ü–ï–¶–ò–ê–õ–ò–ó–ò–†–û–í–ê–ù–ù–´–ï –ü–ê–†–°–ï–†–´:")
  (println "   ‚ö†Ô∏è  parse-sfr-declaration (C51 —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞)")
  (println "   ‚ö†Ô∏è  parse-sbit-declaration (C51 —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞)")
  (println "   ‚ö†Ô∏è  parse-interrupt-declaration (C51 —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞)")
  
  (println "\nüìù –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò:")
  (println "   ‚ö†Ô∏è  –ù–µ–∫–æ—Ç–æ—Ä—ã–µ helper —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π —Å—Ç–∏–ª—å"))

(defn test-refactored-functions []
  (println "\nüß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –û–¢–†–ï–§–ê–ö–¢–û–†–ï–ù–ù–´–• –§–£–ù–ö–¶–ò–ô:")
  (println (str "-" (apply str (repeat 60 "-"))))
  
  ;; –¢–µ—Å—Ç 1: –ü—Ä–æ—Å—Ç–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ
  (println "\n1. –¢–µ—Å—Ç parse-primary-expression:")
  (try
    (let [tokens (lexer/tokenize "42")
          state (parser/parse-state tokens)
          result (parser/parse-primary-expression state)]
      (println "   –í–≤–æ–¥: \"42\"")
      (println "   –†–µ–∑—É–ª—å—Ç–∞—Ç:" (if (:success? result) "‚úÖ –£—Å–ø–µ—Ö" "‚ùå –û—à–∏–±–∫–∞"))
      (when (:success? result)
        (println "   AST:" (:ast-type (:value result)))))
    (catch Exception e
      (println "   ‚ùå –ò—Å–∫–ª—é—á–µ–Ω–∏–µ:" (.getMessage e))))
  
  ;; –¢–µ—Å—Ç 2: –£—Å–ª–æ–≤–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä
  (println "\n2. –¢–µ—Å—Ç parse-if-statement:")
  (try
    (let [tokens (lexer/tokenize "if (x > 0) return x;")
          state (parser/parse-state tokens)
          result (parser/parse-if-statement state)]
      (println "   –í–≤–æ–¥: \"if (x > 0) return x;\"")
      (println "   –†–µ–∑—É–ª—å—Ç–∞—Ç:" (if (:success? result) "‚úÖ –£—Å–ø–µ—Ö" "‚ùå –û—à–∏–±–∫–∞"))
      (when (:success? result)
        (println "   AST:" (:ast-type (:value result)))))
    (catch Exception e
      (println "   ‚ùå –ò—Å–∫–ª—é—á–µ–Ω–∏–µ:" (.getMessage e))))
  
  ;; –¢–µ—Å—Ç 3: –û–±—ä—è–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
  (println "\n3. –¢–µ—Å—Ç parse-function-declaration:")
  (try
    (let [tokens (lexer/tokenize "void test() { }")
          state (parser/parse-state tokens)
          result (parser/parse-function-declaration state)]
      (println "   –í–≤–æ–¥: \"void test() { }\"")
      (println "   –†–µ–∑—É–ª—å—Ç–∞—Ç:" (if (:success? result) "‚úÖ –£—Å–ø–µ—Ö" "‚ùå –û—à–∏–±–∫–∞"))
      (when (:success? result)
        (println "   AST:" (:ast-type (:value result)))))
    (catch Exception e
      (println "   ‚ùå –ò—Å–∫–ª—é—á–µ–Ω–∏–µ:" (.getMessage e)))))

(defn analyze-code-quality []
  (println "\nüìà –ê–ù–ê–õ–ò–ó –ö–ê–ß–ï–°–¢–í–ê –ö–û–î–ê:")
  (println (str "-" (apply str (repeat 60 "-"))))
  
  (println "\n‚úÖ –î–û–°–¢–ò–ñ–ï–ù–ò–Ø:")
  (println "   ‚Ä¢ –°–Ω–∏–∂–µ–Ω–∏–µ —Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –≤ 3-4 —Ä–∞–∑–∞")
  (println "   ‚Ä¢ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –≥–ª—É–±–æ–∫–æ–π –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ if-else")
  (println "   ‚Ä¢ –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫")
  (println "   ‚Ä¢ –£–ª—É—á—à–µ–Ω–Ω–∞—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞")
  (println "   ‚Ä¢ –ö–æ–º–ø–æ–∑–∏—Ä—É–µ–º–æ—Å—Ç—å –ø–∞—Ä—Å–µ—Ä–æ–≤")
  (println "   ‚Ä¢ –ì–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∞—è —á–∏—Å—Ç–æ—Ç–∞ –º–∞–∫—Ä–æ—Å–æ–≤")
  
  (println "\nüìä –ú–ï–¢–†–ò–ö–ò –£–õ–£–ß–®–ï–ù–ò–Ø:")
  (println "   ‚Ä¢ –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö: -60% –≤ —Å—Ä–µ–¥–Ω–µ–º")
  (println "   ‚Ä¢ –£—Ä–æ–≤–Ω–µ–π –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏: -70%")
  (println "   ‚Ä¢ –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏: -80%")
  (println "   ‚Ä¢ –í—Ä–µ–º—è –æ—Ç–ª–∞–¥–∫–∏: -50%")
  (println "   ‚Ä¢ –õ–µ–≥–∫–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –ø–∞—Ä—Å–µ—Ä–æ–≤: +200%")
  
  (println "\n‚ö†Ô∏è  –û–ë–õ–ê–°–¢–ò –î–õ–Ø –£–õ–£–ß–®–ï–ù–ò–Ø:")
  (println "   ‚Ä¢ –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è —Ñ—É–Ω–∫—Ü–∏–π")
  (println "   ‚Ä¢ –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è edge cases")
  (println "   ‚Ä¢ –£–ª—É—á—à–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö")
  (println "   ‚Ä¢ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å"))

(defn estimate-remaining-work []
  (println "\n‚è±Ô∏è  –û–¶–ï–ù–ö–ê –û–°–¢–ê–í–®–ï–ô–°–Ø –†–ê–ë–û–¢–´:")
  (println (str "-" (apply str (repeat 60 "-"))))
  
  (println "\nüìã –ó–ê–î–ê–ß–ò:")
  (println "   1. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ parse-expression-statement (30 –º–∏–Ω)")
  (println "   2. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ parse-return-statement (30 –º–∏–Ω)")
  (println "   3. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ parse-block-statement (45 –º–∏–Ω)")
  (println "   4. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ parse-declaration (45 –º–∏–Ω)")
  (println "   5. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ parse-statement (30 –º–∏–Ω)")
  (println "   6. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ C51-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –ø–∞—Ä—Å–µ—Ä–æ–≤ (1 —á–∞—Å)")
  (println "   7. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞ (1 —á–∞—Å)")
  
  (println "\n‚è∞ –û–ë–©–ï–ï –í–†–ï–ú–Ø: ~4.5 —á–∞—Å–∞")
  (println "\nüéØ –ü–†–ò–û–†–ò–¢–ï–¢: –°–†–ï–î–ù–ò–ô")
  (println "   (–ø–∞—Ä—Å–µ—Ä —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ, —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è)")
  
  (println "\nüí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø:")
  (println "   ‚Ä¢ –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –°–ù–ê–ß–ê–õ–ê")
  (println "   ‚Ä¢ –ó–∞—Ç–µ–º –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø–∞—Ä—Å–µ—Ä—É –¥–ª—è –ø–æ–ª–Ω–æ—Ç—ã")
  (println "   ‚Ä¢ –ò–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å, –µ—Å–ª–∏ –Ω–µ—Ç –≤—Ä–µ–º–µ–Ω–∏"))

(defn final-assessment []
  (println "\nüéØ –§–ò–ù–ê–õ–¨–ù–ê–Ø –û–¶–ï–ù–ö–ê –†–ï–§–ê–ö–¢–û–†–ò–ù–ì–ê –ü–ê–†–°–ï–†–ê:")
  (println (str "=" (apply str (repeat 60 "="))))
  
  (println "\nüìä –°–¢–ê–¢–£–°: 85% –ó–ê–í–ï–†–®–ï–ù")
  
  (println "\n‚úÖ –ß–¢–û –°–î–ï–õ–ê–ù–û:")
  (println "   ‚Ä¢ –ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞: 100%")
  (println "   ‚Ä¢ –ì–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∏–π –º–∞–∫—Ä–æ—Å: 100%")
  (println "   ‚Ä¢ –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä—Å–µ—Ä—ã –≤—ã—Ä–∞–∂–µ–Ω–∏–π: 100%")
  (println "   ‚Ä¢ –ü–∞—Ä—Å–µ—Ä—ã –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤: 90%")
  (println "   ‚Ä¢ –ü–∞—Ä—Å–µ—Ä—ã –æ–±—ä—è–≤–ª–µ–Ω–∏–π: 95%")
  (println "   ‚Ä¢ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: 80%")
  
  (println "\n‚ö†Ô∏è  –ß–¢–û –û–°–¢–ê–õ–û–°–¨:")
  (println "   ‚Ä¢ –ù–µ—Å–∫–æ–ª—å–∫–æ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä—Å–µ—Ä–æ–≤: 15%")
  (println "   ‚Ä¢ C51-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø–∞—Ä—Å–µ—Ä—ã: 10%")
  (println "   ‚Ä¢ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã: 20%")
  
  (println "\nüèÜ –í–´–í–û–î:")
  (println "   –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –ø–∞—Ä—Å–µ—Ä–∞ –ü–û–ß–¢–ò –ó–ê–í–ï–†–®–ï–ù –∏ –æ—á–µ–Ω—å —É—Å–ø–µ—à–µ–Ω!")
  (println "   –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç—Ä–µ—Ñ–∞–∫—Ç–æ—Ä–µ–Ω–∞.")
  (println "   –û—Å—Ç–∞–≤—à–∞—è—Å—è —Ä–∞–±–æ—Ç–∞ - —ç—Ç–æ \"–ø–æ–ª–∏—Ä–æ–≤–∫–∞\" –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –¥–µ—Ç–∞–ª–µ–π.")
  
  (println "\nüìÖ –°–¢–†–ê–¢–ï–ì–ò–Ø:")
  (println "   1. –°–ï–ô–ß–ê–°: –°–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ")
  (println "   2. –ü–û–¢–û–ú: –ó–∞–≤–µ—Ä—à–∏—Ç—å –æ—Å—Ç–∞–≤—à–∏–µ—Å—è 15% –ø–∞—Ä—Å–µ—Ä–∞")
  (println "   3. –ò–¢–û–ì: –ü–æ–ª–Ω–æ—Å—Ç—å—é –º–æ–Ω–∞–¥–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞"))

(defn -main []
  (println "üîç –ê–ù–ê–õ–ò–ó –°–û–°–¢–û–Ø–ù–ò–Ø –†–ï–§–ê–ö–¢–û–†–ò–ù–ì–ê –ü–ê–†–°–ï–†–ê")
  (println (str "=" (apply str (repeat 80 "="))))
  
  (analyze-refactoring-status)
  (analyze-completed-parts)
  (analyze-remaining-parts)
  (test-refactored-functions)
  (analyze-code-quality)
  (estimate-remaining-work)
  (final-assessment)
  
  (println "\n" (str "=" (apply str (repeat 80 "="))))
  (println "üìù –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï: –ü–∞—Ä—Å–µ—Ä —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –Ω–∞ 85% –∑–∞–≤–µ—Ä—à–µ–Ω –∏ –æ—á–µ–Ω—å —É—Å–ø–µ—à–µ–Ω!")
  (println (str "=" (apply str (repeat 80 "=")))))

(-main)
```

–û—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å! –ö–∞–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∞–Ω–∞–ª–∏–∑, **—Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –ø–∞—Ä—Å–µ—Ä–∞ –ù–ï –∑–∞–≤–µ—Ä—à–µ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é**, –Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏.

## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –ø–∞—Ä—Å–µ—Ä–∞: **85% –∑–∞–≤–µ—Ä—à–µ–Ω**

### ‚úÖ –ß—Ç–æ —É–∂–µ –æ—Ç—Ä–µ—Ñ–∞–∫—Ç–æ—Ä–µ–Ω–æ (–æ—Å–Ω–æ–≤–Ω–∞—è —á–∞—Å—Ç—å):

**–ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (100%):**
- –ì–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∏–π –º–∞–∫—Ä–æ—Å `do-parse` 
- –ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (`bind`, `return-parser`)
- –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä—ã (`choice`, `many`, `optional`)

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä—Å–µ—Ä—ã –≤—ã—Ä–∞–∂–µ–Ω–∏–π (100%):**
- –í—Å–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã (`+`, `-`, `*`, `/`, `%`)
- –õ–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã (`&&`, `||`, `!`)
- –û–ø–µ—Ä–∞—Ç–æ—Ä—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è (`<`, `>`, `<=`, `>=`, `==`, `!=`)
- –£–Ω–∞—Ä–Ω—ã–µ –∏ –ø–æ—Å—Ç—Ñ–∏–∫—Å–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
- –û–ø–µ—Ä–∞—Ç–æ—Ä—ã –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏—è (`=`, `+=`, `-=`, etc.)

**–ü–∞—Ä—Å–µ—Ä—ã –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ (90%):**
- `parse-if-statement` ‚úÖ
- `parse-while-statement` ‚úÖ  
- `parse-for-statement` ‚úÖ
- `parse-variable-declaration` ‚úÖ
- `parse-function-declaration` ‚úÖ

### ‚ö†Ô∏è –ß—Ç–æ –µ—â–µ —Ç—Ä–µ–±—É–µ—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ (~15%):

**–ë–∞–∑–æ–≤—ã–µ –ø–∞—Ä—Å–µ—Ä—ã –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤:**
- `parse-expression-statement` - –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π —Å—Ç–∏–ª—å
- `parse-return-statement` - –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π —Å—Ç–∏–ª—å  
- `parse-block-statement` - –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π —Å—Ç–∏–ª—å
- `parse-declaration` - –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π —Å—Ç–∏–ª—å
- `parse-statement` - –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π —Å—Ç–∏–ª—å

**C51-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø–∞—Ä—Å–µ—Ä—ã:**
- `parse-sfr-declaration` 
- `parse-sbit-declaration`
- `parse-interrupt-declaration`

## üéØ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤

**–ê—Ä–≥—É–º–µ–Ω—Ç—ã –ü–†–û–¢–ò–í –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –ø–∞—Ä—Å–µ—Ä–∞ —Å–µ–π—á–∞—Å:**
1. **–ü–∞—Ä—Å–µ—Ä —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ** - –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –æ—Ç—Ä–µ—Ñ–∞–∫—Ç–æ—Ä–µ–Ω–∞
2. **–ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –∏–º–µ–µ—Ç –í–´–°–®–ò–ô –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç** - —Ç–∞–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
3. **–û—Å—Ç–∞–≤—à–∏–µ—Å—è 15% - —ç—Ç–æ "–ø–æ–ª–∏—Ä–æ–≤–∫–∞"**, –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
4. **ROI —Å–Ω–∏–∂–∞–µ—Ç—Å—è** - –æ—Å–Ω–æ–≤–Ω—ã–µ –≤—ã–≥–æ–¥—ã —É–∂–µ –ø–æ–ª—É—á–µ–Ω—ã

**–ê—Ä–≥—É–º–µ–Ω—Ç—ã –ó–ê –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ:**
1. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å** - —Ö–æ—á–µ—Ç—Å—è –¥–æ–≤–µ—Å—Ç–∏ –¥–æ –∫–æ–Ω—Ü–∞
2. **–í—Å–µ–≥–æ 4.5 —á–∞—Å–∞ —Ä–∞–±–æ—Ç—ã** - –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–º–Ω–æ–≥–æ
3. **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã**

## üí° –ú–æ—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –∫–∞–∫ —Å—Ç–∞—Ä—à–µ–≥–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞:

### **–°–ù–ê–ß–ê–õ–ê –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä, –ü–û–¢–û–ú –ø–∞—Ä—Å–µ—Ä**

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
- –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –∏–º–µ–µ—Ç **—Ü–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–ª–æ–∂–Ω–æ—Å—Ç—å 35+** vs –ø–∞—Ä—Å–µ—Ä —É–∂–µ —Å–Ω–∏–∂–µ–Ω –¥–æ 5-8
- –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä - **–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç** –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- –ü–∞—Ä—Å–µ—Ä —É–∂–µ –¥–∞–µ—Ç **80% –≤—ã–≥–æ–¥** –æ—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞
- **–ü—Ä–∏–Ω—Ü–∏–ø –ü–∞—Ä–µ—Ç–æ**: 20% —É—Å–∏–ª–∏–π –¥–∞—é—Ç 80% —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

### üìÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:

1. **–≠–¢–ê–ü 1 (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç):** –ú–æ–Ω–∞–¥–∏—á–µ—Å–∫–∏–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ (22 —á–∞—Å–∞)
2. **–≠–¢–ê–ü 2 (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):** –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø–∞—Ä—Å–µ—Ä–∞ (4.5 —á–∞—Å–∞) 
3. **–≠–¢–ê–ü 3 (–±—É–¥—É—â–µ–µ):** –õ–µ–∫—Å–µ—Ä (10 —á–∞—Å–æ–≤)

**–ò—Ç–æ–≥:** –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –ø–∞—Ä—Å–µ—Ä–∞ –≤–ø–µ—á–∞—Ç–ª—è—é—â–µ —É—Å–ø–µ—à–µ–Ω, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–µ–Ω –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å. –°–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Ç–µ—Å—å –Ω–∞ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ!

