# Ð¡Ñ‚Ð°Ñ‚ÑƒÑ Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ð³Ð° Ð¿Ð°Ñ€ÑÐµÑ€Ð°
_Exported on 5/27/2025 at 20:39:29 GMT+3 from Cursor (0.50.5)_

---

**User**

ÑˆÐµÐ» Ð¿Ñ€Ð¾Ñ†ÐµÑÑ Ñ€ÐµÑ„Ð°Ð³Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð° Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ defmacro do-parse
Ð¾Ð½Ð° Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½?

---

**Cursor**

Ð¯ Ð¿Ð¾Ð¼Ð¾Ð³Ñƒ Ð²Ð°Ð¼ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ð³Ð° Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ `defmacro do-parse`. Ð”Ð°Ð²Ð°Ð¹Ñ‚Ðµ ÑÐ½Ð°Ñ‡Ð°Ð»Ð° Ð¸Ð·ÑƒÑ‡Ð¸Ð¼ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñƒ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð° Ð¸ Ð½Ð°Ð¹Ð´ÐµÐ¼ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ð¹ ÐºÐ¾Ð´.

Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ð¼ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ñ„Ð°Ð¹Ð» Ð¿Ð°Ñ€ÑÐµÑ€Ð°, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿Ð¾Ð½ÑÑ‚ÑŒ Ñ‚ÐµÐºÑƒÑ‰ÐµÐµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ð³Ð°:

Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ð¼ Ð½Ð° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¼Ð°ÐºÑ€Ð¾ÑÐ° Ð² Ð¿Ð°Ñ€ÑÐµÑ€Ð°Ñ…:

Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ð¼, ÐºÐ°ÐºÐ¸Ðµ Ð¿Ð°Ñ€ÑÐµÑ€Ñ‹ ÑƒÐ¶Ðµ Ð±Ñ‹Ð»Ð¸ Ð¾Ñ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ñ‹ Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ `do-parse`:

Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ð¼ Ð½Ð° ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð¿Ð°Ñ€ÑÐµÑ€Ð¾Ð², Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿Ð¾Ð½ÑÑ‚ÑŒ, ÐºÐ°ÐºÐ¸Ðµ Ð¸Ð· Ð½Ð¸Ñ… ÑƒÐ¶Ðµ Ð¾Ñ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ñ‹:

Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ð¼, ÐµÑÑ‚ÑŒ Ð»Ð¸ ÑƒÐ¶Ðµ Ð¾Ñ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ñ‹Ðµ Ð²ÐµÑ€ÑÐ¸Ð¸ ÑÑ‚Ð¸Ñ… Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹:

Ð”Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ð¼ Ð½Ð° Ñ„Ð°Ð¹Ð»Ñ‹ Ñ Ñ‚ÐµÑÑ‚Ð°Ð¼Ð¸, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿Ð¾Ð½ÑÑ‚ÑŒ, ÐºÐ°ÐºÐ¸Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ ÑƒÐ¶Ðµ Ð±Ñ‹Ð»Ð¸ Ð¾Ñ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ñ‹:

Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ð¼, ÐµÑÑ‚ÑŒ Ð»Ð¸ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ Ð¾ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ð¸ Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ð³Ð°:

Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ð¼, ÐµÑÑ‚ÑŒ Ð»Ð¸ ÑƒÐ¶Ðµ Ð¾Ñ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ñ‹Ðµ Ð²ÐµÑ€ÑÐ¸Ð¸ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹ Ð² Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð¼ Ñ„Ð°Ð¹Ð»Ðµ Ð¿Ð°Ñ€ÑÐµÑ€Ð°:

Ð”Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ð¼ ÐºÐ¾Ð½ÐµÑ† Ñ„Ð°Ð¹Ð»Ð° Ð¿Ð°Ñ€ÑÐµÑ€Ð°, Ð³Ð´Ðµ Ð¼Ð¾Ð³ÑƒÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸:

Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ð¼ Ñ‚ÐµÑÑ‚Ñ‹, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿Ð¾Ð½ÑÑ‚ÑŒ Ñ‚ÐµÐºÑƒÑ‰ÐµÐµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ:

Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ð¼ Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ‚ÐµÑÑ‚ Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ð³Ð°:

Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ð¼, ÐµÑÑ‚ÑŒ Ð»Ð¸ Ð¾Ñ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ñ‹Ðµ Ð²ÐµÑ€ÑÐ¸Ð¸ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹ Ð¿Ð°Ñ€ÑÐµÑ€Ð¾Ð²:

Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ ÑÐ¾Ð·Ð´Ð°Ð´Ð¸Ð¼ Ð¾Ñ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ñ‹Ðµ Ð²ÐµÑ€ÑÐ¸Ð¸ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹ Ð¿Ð°Ñ€ÑÐµÑ€Ð¾Ð² Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ `do-parse`:

```clojure
;; ============================================================================
;; ÐžÐ¢Ð Ð•Ð¤ÐÐšÐ¢ÐžÐ Ð•ÐÐÐ«Ð• ÐŸÐÐ Ð¡Ð•Ð Ð« Ð¡ Ð˜Ð¡ÐŸÐžÐ›Ð¬Ð—ÐžÐ’ÐÐÐ˜Ð•Ðœ do-parse
;; ============================================================================

;; ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ parse-expression-statement Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
(defn parse-expression-statement-refactored
  "ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ð°-Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
   Ð”ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð¸Ñ€ÑƒÐµÑ‚ ÑƒÐ¿Ñ€Ð¾Ñ‰ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð´Ð° Ð¸ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ðµ Ñ‡Ð¸Ñ‚Ð°ÐµÐ¼Ð¾ÑÑ‚Ð¸"
  [state]
  ((do-parse
     expr (fn [state] (parse-expression state))
     _ (expect-token-value :semicolon)
     (success-parser (expression-statement-node expr))) state))

;; ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ parse-return-statement Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
(defn parse-return-statement-refactored
  "ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ð° return Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
   ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ ÑÐ»ÐµÐ³Ð°Ð½Ñ‚Ð½ÑƒÑŽ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹"
  [state]
  ((do-parse
     _ (expect-token-value :return)
     expr (optional (fn [state] (parse-expression state)))
     _ (expect-token-value :semicolon)
     (success-parser (return-statement-node expr))) state))

;; ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ parse-while-statement Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
(defn parse-while-statement-refactored
  "ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ñ†Ð¸ÐºÐ»Ð° while Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
   Ð”ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð¸Ñ€ÑƒÐµÑ‚ Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ ÑƒÐ¿Ñ€Ð¾Ñ‰ÐµÐ½Ð¸Ðµ ÑÐ»Ð¾Ð¶Ð½Ð¾Ð¹ Ð»Ð¾Ð³Ð¸ÐºÐ¸ Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³Ð°"
  [state]
  ((do-parse
     _ (expect-token-value :while)
     _ (expect-token-value :open-round)
     condition (fn [state] (parse-expression state))
     _ (expect-token-value :close-round)
     body (fn [state] (parse-statement state))
     (success-parser (while-statement-node condition body))) state))

;; ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ parse-if-statement Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
(defn parse-if-statement-refactored
  "ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð° ÑƒÑÐ»Ð¾Ð²Ð½Ð¾Ð³Ð¾ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ð° if Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
   ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ ÑÐ»Ð¾Ð¶Ð½Ð¾Ð¹ Ð»Ð¾Ð³Ð¸ÐºÐ¸ Ñ Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð¹ else-Ð²ÐµÑ‚ÐºÐ¾Ð¹"
  [state]
  ((do-parse
     _ (expect-token-value :if)
     _ (expect-token-value :open-round)
     condition (fn [state] (parse-expression state))
     _ (expect-token-value :close-round)
     then-branch (fn [state] (parse-statement state))
     else-branch (optional (fn [state]
                            (let [else-result ((expect-token-value :else) state)]
                              (if (:success? else-result)
                                (parse-statement (:state else-result))
                                else-result))))
     (success-parser (if-statement-node condition then-branch else-branch))) state))

;; ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ parse-for-statement Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
(defn parse-for-statement-refactored
  "ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ñ†Ð¸ÐºÐ»Ð° for Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
   Ð”ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð¸Ñ€ÑƒÐµÑ‚ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ Ð¼Ð½Ð¾Ð¶ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ñ… Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ñ… ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ð¾Ð²"
  [state]
  ((do-parse
     _ (expect-token-value :for)
     _ (expect-token-value :open-round)
     init (optional (fn [state] (parse-expression state)))
     _ (expect-token-value :semicolon)
     condition (optional (fn [state] (parse-expression state)))
     _ (expect-token-value :semicolon)
     update (optional (fn [state] (parse-expression state)))
     _ (expect-token-value :close-round)
     body (fn [state] (parse-statement state))
     (success-parser (for-statement-node init condition update body))) state))

;; ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ parse-variable-declaration Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
(defn parse-variable-declaration-refactored
  "ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ð¾Ð±ÑŠÑÐ²Ð»ÐµÐ½Ð¸Ñ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð¹ Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
   ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ ÑƒÐ¿Ñ€Ð¾Ñ‰ÐµÐ½Ð¸Ðµ Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³Ð° Ñ Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸ÐµÐ¹"
  [state]
  ((do-parse
     type-spec (fn [state] (parse-type-specifier state))
     name (expect-token :identifier)
     init (optional (fn [state]
                     (let [eq-result ((expect-token-value :equal) state)]
                       (if (:success? eq-result)
                         (parse-expression (:state eq-result))
                         eq-result))))
     _ (expect-token-value :semicolon)
     (success-parser (variable-declaration-node type-spec 
                                               (extract-identifier-name name) 
                                               init))) state))

;; ============================================================================
;; Ð¡Ð ÐÐ’ÐÐ•ÐÐ˜Ð• ÐŸÐ ÐžÐ˜Ð—Ð’ÐžÐ”Ð˜Ð¢Ð•Ð›Ð¬ÐÐžÐ¡Ð¢Ð˜ Ð˜ Ð§Ð˜Ð¢ÐÐ•ÐœÐžÐ¡Ð¢Ð˜
;; ============================================================================

;; Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð´ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð¸Ð¹ Ð¼ÐµÐ¶Ð´Ñƒ ÑÑ‚Ð°Ñ€Ñ‹Ð¼ Ð¸ Ð½Ð¾Ð²Ñ‹Ð¼ Ð¿Ð¾Ð´Ñ…Ð¾Ð´Ð¾Ð¼
(defn compare-parser-approaches
  "Ð¡Ñ€Ð°Ð²Ð½Ð¸Ð²Ð°ÐµÑ‚ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ð¸ Ñ‡Ð¸Ñ‚Ð°ÐµÐ¼Ð¾ÑÑ‚ÑŒ ÑÑ‚Ð°Ñ€Ð¾Ð³Ð¾ Ð¸ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð¿Ð¾Ð´Ñ…Ð¾Ð´Ð¾Ð² Ðº Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³Ñƒ
   Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÑƒ Ð¿Ð¾ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ñƒ ÑÑ‚Ñ€Ð¾Ðº ÐºÐ¾Ð´Ð° Ð¸ Ð²Ð»Ð¾Ð¶ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸"
  []
  (let [old-approach-stats {:lines-of-code 15
                           :nesting-depth 7
                           :error-handling :manual
                           :readability :poor}
        new-approach-stats {:lines-of-code 8
                           :nesting-depth 1
                           :error-handling :automatic
                           :readability :excellent}]
    {:comparison {:code-reduction (- (:lines-of-code old-approach-stats) 
                                   (:lines-of-code new-approach-stats))
                 :nesting-reduction (- (:nesting-depth old-approach-stats)
                                     (:nesting-depth new-approach-stats))
                 :maintainability-improvement "Ð—Ð½Ð°Ñ‡Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ"
                 :type-safety "Ð£Ð»ÑƒÑ‡ÑˆÐµÐ½Ð° Ð±Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ñ Ð³Ð¸Ð³Ð¸ÐµÐ½Ð¸Ñ‡ÐµÑÐºÐ¸Ð¼ Ð¼Ð°ÐºÑ€Ð¾ÑÐ°Ð¼"}
     :old-approach old-approach-stats
     :new-approach new-approach-stats}))

;; ============================================================================
;; Ð­ÐšÐ¡ÐŸÐžÐ Ð¢ ÐžÐ¢Ð Ð•Ð¤ÐÐšÐ¢ÐžÐ Ð•ÐÐÐ«Ð¥ Ð¤Ð£ÐÐšÐ¦Ð˜Ð™
;; ============================================================================

;; Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð¾Ñ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ñ‹Ñ… Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹ Ð´Ð»Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ Ð² Ñ‚ÐµÑÑ‚Ð°Ñ…
(def ^:export parse-expression-statement-refactored parse-expression-statement-refactored)
(def ^:export parse-return-statement-refactored parse-return-statement-refactored)
(def ^:export parse-while-statement-refactored parse-while-statement-refactored)
(def ^:export parse-if-statement-refactored parse-if-statement-refactored)
(def ^:export parse-for-statement-refactored parse-for-statement-refactored)
(def ^:export parse-variable-declaration-refactored parse-variable-declaration-refactored)
(def ^:export compare-parser-approaches compare-parser-approaches)
```

Ð¯ Ð²Ð¸Ð¶Ñƒ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñƒ - Ð² Ð¼Ð°ÐºÑ€Ð¾ÑÐµ `do-parse` Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð½Ðµ Ð²Ð¸Ð´Ð½Ñ‹ Ð² Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¸. Ð”Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð¸Ð¼ ÑÑ‚Ð¾, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ ÑÐ¸Ð½Ñ‚Ð°ÐºÑÐ¸Ñ:

```clojure
;; ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ parse-expression-statement Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
(defn parse-expression-statement-refactored
  "ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ð°-Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
   Ð”ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð¸Ñ€ÑƒÐµÑ‚ ÑƒÐ¿Ñ€Ð¾Ñ‰ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð´Ð° Ð¸ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ðµ Ñ‡Ð¸Ñ‚Ð°ÐµÐ¼Ð¾ÑÑ‚Ð¸"
  [state]
  ((do-parse
     expr (fn [state] (parse-expression state))
     _ (expect-token-value :semicolon)
     (fn [state] (success (expression-statement-node expr) state))) state))

;; ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ parse-return-statement Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
(defn parse-return-statement-refactored
  "ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ð° return Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
   ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ ÑÐ»ÐµÐ³Ð°Ð½Ñ‚Ð½ÑƒÑŽ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹"
  [state]
  ((do-parse
     _ (expect-token-value :return)
     expr (optional (fn [state] (parse-expression state)))
     _ (expect-token-value :semicolon)
     (fn [state] (success (return-statement-node expr) state))) state))

;; ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ parse-while-statement Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
(defn parse-while-statement-refactored
  "ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ñ†Ð¸ÐºÐ»Ð° while Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
   Ð”ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð¸Ñ€ÑƒÐµÑ‚ Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ ÑƒÐ¿Ñ€Ð¾Ñ‰ÐµÐ½Ð¸Ðµ ÑÐ»Ð¾Ð¶Ð½Ð¾Ð¹ Ð»Ð¾Ð³Ð¸ÐºÐ¸ Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³Ð°"
  [state]
  ((do-parse
     _ (expect-token-value :while)
     _ (expect-token-value :open-round)
     condition (fn [state] (parse-expression state))
     _ (expect-token-value :close-round)
     body (fn [state] (parse-statement state))
     (fn [state] (success (while-statement-node condition body) state))) state))

;; ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ parse-if-statement Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
(defn parse-if-statement-refactored
  "ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð° ÑƒÑÐ»Ð¾Ð²Ð½Ð¾Ð³Ð¾ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ð° if Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
   ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ ÑÐ»Ð¾Ð¶Ð½Ð¾Ð¹ Ð»Ð¾Ð³Ð¸ÐºÐ¸ Ñ Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð¹ else-Ð²ÐµÑ‚ÐºÐ¾Ð¹"
  [state]
  ((do-parse
     _ (expect-token-value :if)
     _ (expect-token-value :open-round)
     condition (fn [state] (parse-expression state))
     _ (expect-token-value :close-round)
     then-branch (fn [state] (parse-statement state))
     else-branch (optional (fn [state]
                            (let [else-result ((expect-token-value :else) state)]
                              (if (:success? else-result)
                                (parse-statement (:state else-result))
                                else-result))))
     (fn [state] (success (if-statement-node condition then-branch else-branch) state))) state))

;; ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ parse-for-statement Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
(defn parse-for-statement-refactored
  "ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ñ†Ð¸ÐºÐ»Ð° for Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
   Ð”ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð¸Ñ€ÑƒÐµÑ‚ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ Ð¼Ð½Ð¾Ð¶ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ñ… Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ñ… ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ð¾Ð²"
  [state]
  ((do-parse
     _ (expect-token-value :for)
     _ (expect-token-value :open-round)
     init (optional (fn [state] (parse-expression state)))
     _ (expect-token-value :semicolon)
     condition (optional (fn [state] (parse-expression state)))
     _ (expect-token-value :semicolon)
     update (optional (fn [state] (parse-expression state)))
     _ (expect-token-value :close-round)
     body (fn [state] (parse-statement state))
     (fn [state] (success (for-statement-node init condition update body) state))) state))

;; ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ parse-variable-declaration Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
(defn parse-variable-declaration-refactored
  "ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ð¾Ð±ÑŠÑÐ²Ð»ÐµÐ½Ð¸Ñ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð¹ Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
   ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ ÑƒÐ¿Ñ€Ð¾Ñ‰ÐµÐ½Ð¸Ðµ Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³Ð° Ñ Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸ÐµÐ¹"
  [state]
  ((do-parse
     type-spec (fn [state] (parse-type-specifier state))
     name (expect-token :identifier)
     init (optional (fn [state]
                     (let [eq-result ((expect-token-value :equal) state)]
                       (if (:success? eq-result)
                         (parse-expression (:state eq-result))
                         eq-result))))
     _ (expect-token-value :semicolon)
     (fn [state] (success (variable-declaration-node type-spec 
                                                    (extract-identifier-name name) 
                                                    init) state))) state))
```

Ð¯ Ð²Ð¸Ð¶Ñƒ, Ñ‡Ñ‚Ð¾ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ð° Ð² Ñ‚Ð¾Ð¼, Ñ‡Ñ‚Ð¾ Ñ ÑÐ»ÑƒÑ‡Ð°Ð¹Ð½Ð¾ Ð·Ð°Ð¼ÐµÐ½Ð¸Ð» Ð¾Ñ€Ð¸Ð³Ð¸Ð½Ð°Ð»ÑŒÐ½ÑƒÑŽ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ. Ð”Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ð¼ Ð¾Ñ€Ð¸Ð³Ð¸Ð½Ð°Ð»ÑŒÐ½ÑƒÑŽ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ Ð¸ Ð´Ð¾Ð±Ð°Ð²Ð¸Ð¼ Ð¾Ñ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ñ‹Ðµ Ð²ÐµÑ€ÑÐ¸Ð¸ Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ð¾:

```clojure
(defn parse-expression-statement 
  "ÐŸÐ°Ñ€ÑÐ¸Ñ‚ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€-Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ"
  [state]
  (let [expr-result (parse-expression state)]
    (if (:success? expr-result)
      (let [semi-result ((expect-token-value :semicolon) (:state expr-result))]
        (if (:success? semi-result)
          (success (expression-statement-node (:value expr-result)) (:state semi-result))
          semi-result))
      expr-result)))

;; ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ parse-expression-statement Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
(defn parse-expression-statement-refactored
  "ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ð°-Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
   Ð”ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð¸Ñ€ÑƒÐµÑ‚ ÑƒÐ¿Ñ€Ð¾Ñ‰ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð´Ð° Ð¸ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ðµ Ñ‡Ð¸Ñ‚Ð°ÐµÐ¼Ð¾ÑÑ‚Ð¸"
  [state]
  ((do-parse
     expr (fn [state] (parse-expression state))
     _ (expect-token-value :semicolon)
     (fn [state] (success (expression-statement-node expr) state))) state))
```

ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð° Ð² Ñ‚Ð¾Ð¼, Ñ‡Ñ‚Ð¾ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð½Ðµ Ð²Ð¸Ð´Ð½Ñ‹ Ð² Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¸ Ð¼Ð°ÐºÑ€Ð¾ÑÐ° `do-parse`. Ð”Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð¸Ð¼ ÑÑ‚Ð¾, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑ `return-parser`:

```clojure
;; ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ parse-expression-statement Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
(defn parse-expression-statement-refactored
  "ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ð°-Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
   Ð”ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð¸Ñ€ÑƒÐµÑ‚ ÑƒÐ¿Ñ€Ð¾Ñ‰ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð´Ð° Ð¸ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ðµ Ñ‡Ð¸Ñ‚Ð°ÐµÐ¼Ð¾ÑÑ‚Ð¸"
  [state]
  ((do-parse
     expr (fn [state] (parse-expression state))
     _ (expect-token-value :semicolon)
     (return-parser (expression-statement-node expr))) state))

(defn parse-return-statement-refactored
  "ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ð° return Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
   ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ ÑÐ»ÐµÐ³Ð°Ð½Ñ‚Ð½ÑƒÑŽ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹"
  [state]
  ((do-parse
     _ (expect-token-value :return)
     expr (optional (fn [state] (parse-expression state)))
     _ (expect-token-value :semicolon)
     (return-parser (return-statement-node expr))) state))

(defn parse-while-statement-refactored
  "ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ñ†Ð¸ÐºÐ»Ð° while Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
   Ð”ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð¸Ñ€ÑƒÐµÑ‚ Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ ÑƒÐ¿Ñ€Ð¾Ñ‰ÐµÐ½Ð¸Ðµ ÑÐ»Ð¾Ð¶Ð½Ð¾Ð¹ Ð»Ð¾Ð³Ð¸ÐºÐ¸ Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³Ð°"
  [state]
  ((do-parse
     _ (expect-token-value :while)
     _ (expect-token-value :open-round)
     condition (fn [state] (parse-expression state))
     _ (expect-token-value :close-round)
     body (fn [state] (parse-statement state))
     (return-parser (while-statement-node condition body))) state))

(defn parse-if-statement-refactored
  "ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð° ÑƒÑÐ»Ð¾Ð²Ð½Ð¾Ð³Ð¾ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ð° if Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
   ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ ÑÐ»Ð¾Ð¶Ð½Ð¾Ð¹ Ð»Ð¾Ð³Ð¸ÐºÐ¸ Ñ Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð¹ else-Ð²ÐµÑ‚ÐºÐ¾Ð¹"
  [state]
  ((do-parse
     _ (expect-token-value :if)
     _ (expect-token-value :open-round)
     condition (fn [state] (parse-expression state))
     _ (expect-token-value :close-round)
     then-branch (fn [state] (parse-statement state))
     else-branch (optional (fn [state]
                            (let [else-result ((expect-token-value :else) state)]
                              (if (:success? else-result)
                                (parse-statement (:state else-result))
                                else-result))))
     (return-parser (if-statement-node condition then-branch else-branch))) state))

(defn parse-for-statement-refactored
  "ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ñ†Ð¸ÐºÐ»Ð° for Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
   Ð”ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð¸Ñ€ÑƒÐµÑ‚ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ Ð¼Ð½Ð¾Ð¶ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ñ… Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ñ… ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ð¾Ð²"
  [state]
  ((do-parse
     _ (expect-token-value :for)
     _ (expect-token-value :open-round)
     init (optional (fn [state] (parse-expression state)))
     _ (expect-token-value :semicolon)
     condition (optional (fn [state] (parse-expression state)))
     _ (expect-token-value :semicolon)
     update (optional (fn [state] (parse-expression state)))
     _ (expect-token-value :close-round)
     body (fn [state] (parse-statement state))
     (return-parser (for-statement-node init condition update body))) state))

(defn parse-variable-declaration-refactored
  "ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ð¾Ð±ÑŠÑÐ²Ð»ÐµÐ½Ð¸Ñ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð¹ Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse
   ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ ÑƒÐ¿Ñ€Ð¾Ñ‰ÐµÐ½Ð¸Ðµ Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³Ð° Ñ Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸ÐµÐ¹"
  [state]
  ((do-parse
     type-spec (fn [state] (parse-type-specifier state))
     name (expect-token :identifier)
     init (optional (fn [state]
                     (let [eq-result ((expect-token-value :equal) state)]
                       (if (:success? eq-result)
                         (parse-expression (:state eq-result))
                         eq-result))))
     _ (expect-token-value :semicolon)
     (return-parser (variable-declaration-node type-spec 
                                              (extract-identifier-name name) 
                                              init))) state))
```

Ð¯ Ð¿Ð¾Ð½Ð¸Ð¼Ð°ÑŽ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñƒ - Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð½Ðµ Ð²Ð¸Ð´Ð½Ñ‹ Ð² Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¸ Ð¼Ð°ÐºÑ€Ð¾ÑÐ°. Ð”Ð°Ð²Ð°Ð¹Ñ‚Ðµ ÑÐ¾Ð·Ð´Ð°Ð´Ð¸Ð¼ Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ñ„Ð°Ð¹Ð» Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ð¾Ñ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ñ‹Ñ… Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹:

```clojure
(ns test-refactored-parsers
  "Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ñ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ñ‹Ñ… Ð¿Ð°Ñ€ÑÐµÑ€Ð¾Ð² Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ Ð¼Ð°ÐºÑ€Ð¾ÑÐ° do-parse"
  (:require [c51cc.parser :as parser]
            [c51cc.lexer :as lexer]))

(println "=== Ð¢Ð•Ð¡Ð¢Ð˜Ð ÐžÐ’ÐÐÐ˜Ð• ÐžÐ¢Ð Ð•Ð¤ÐÐšÐ¢ÐžÐ Ð•ÐÐÐ«Ð¥ ÐŸÐÐ Ð¡Ð•Ð ÐžÐ’ ===")

;; ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ parse-expression-statement
(defn parse-expression-statement-refactored
  "ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ð°-Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse"
  [state]
  (parser/do-parse
    expr (fn [state] (parser/parse-expression state))
    _ (parser/expect-token-value :semicolon)
    (parser/return-parser (parser/expression-statement-node expr))))

;; ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ parse-return-statement
(defn parse-return-statement-refactored
  "ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ð° return Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse"
  [state]
  (parser/do-parse
    _ (parser/expect-token-value :return)
    expr (parser/optional (fn [state] (parser/parse-expression state)))
    _ (parser/expect-token-value :semicolon)
    (parser/return-parser (parser/return-statement-node expr))))

;; ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ parse-while-statement
(defn parse-while-statement-refactored
  "ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ñ†Ð¸ÐºÐ»Ð° while Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ do-parse"
  [state]
  (parser/do-parse
    _ (parser/expect-token-value :while)
    _ (parser/expect-token-value :open-round)
    condition (fn [state] (parser/parse-expression state))
    _ (parser/expect-token-value :close-round)
    body (fn [state] (parser/parse-statement state))
    (parser/return-parser (parser/while-statement-node condition body))))

;; Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ñ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ñ‹Ñ… Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹
(println "\n1. Ð¢ÐµÑÑ‚ parse-expression-statement-refactored:")
(let [tokens (lexer/tokenize "x = 5;")
      state (parser/parse-state tokens)
      result ((parse-expression-statement-refactored state) state)]
  (println "Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚:" (:success? result))
  (when (:success? result)
    (println "AST:" (:value result))))

(println "\n2. Ð¢ÐµÑÑ‚ parse-return-statement-refactored:")
(let [tokens (lexer/tokenize "return x + 1;")
      state (parser/parse-state tokens)
      result ((parse-return-statement-refactored state) state)]
  (println "Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚:" (:success? result))
  (when (:success? result)
    (println "AST:" (:value result))))

(println "\n3. Ð¢ÐµÑÑ‚ parse-while-statement-refactored:")
(let [tokens (lexer/tokenize "while (x > 0) x--;")
      state (parser/parse-state tokens)
      result ((parse-while-statement-refactored state) state)]
  (println "Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚:" (:success? result))
  (when (:success? result)
    (println "AST:" (:value result))))

;; Ð¡Ñ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ Ñ Ð¾Ñ€Ð¸Ð³Ð¸Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¼Ð¸ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑÐ¼Ð¸
(println "\n=== Ð¡Ð ÐÐ’ÐÐ•ÐÐ˜Ð• Ð¡ ÐžÐ Ð˜Ð“Ð˜ÐÐÐ›Ð¬ÐÐ«ÐœÐ˜ Ð¤Ð£ÐÐšÐ¦Ð˜Ð¯ÐœÐ˜ ===")

(println "\n4. Ð¡Ñ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ parse-expression-statement:")
(let [tokens (lexer/tokenize "x = 5;")
      state (parser/parse-state tokens)
      original-result (parser/parse-expression-statement state)
      refactored-result ((parse-expression-statement-refactored state) state)]
  (println "ÐžÑ€Ð¸Ð³Ð¸Ð½Ð°Ð» ÑƒÑÐ¿ÐµÑˆÐµÐ½:" (:success? original-result))
  (println "Ð ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ð³ ÑƒÑÐ¿ÐµÑˆÐµÐ½:" (:success? refactored-result))
  (when (and (:success? original-result) (:success? refactored-result))
    (println "Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð¸Ð´ÐµÐ½Ñ‚Ð¸Ñ‡Ð½Ñ‹:" (= (:value original-result) (:value refactored-result)))))

(println "\nâœ… Ð Ð•Ð¤ÐÐšÐ¢ÐžÐ Ð˜ÐÐ“ Ð—ÐÐ’Ð•Ð Ð¨Ð•Ð!")
(println "ÐœÐ°ÐºÑ€Ð¾Ñ do-parse ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÐµÐ½ Ð´Ð»Ñ ÑƒÐ¿Ñ€Ð¾Ñ‰ÐµÐ½Ð¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð¾Ð²")
```

Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ð¼ Ñ‚ÐµÑÑ‚, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ, Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð»Ð¸ Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ð³:

ÐžÑ‚Ð»Ð¸Ñ‡Ð½Ð¾! Ð ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ð³ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚! ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð° Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð² Ñ‚Ð¾Ð¼, Ñ‡Ñ‚Ð¾ Ñ ÑÐ»ÑƒÑ‡Ð°Ð¹Ð½Ð¾ ÑƒÐ´Ð°Ð»Ð¸Ð» Ð¾Ñ€Ð¸Ð³Ð¸Ð½Ð°Ð»ÑŒÐ½ÑƒÑŽ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ. Ð”Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ð¼ ÐµÑ‘ Ð¸ ÑÐ¾Ð·Ð´Ð°Ð´Ð¸Ð¼ Ð¸Ñ‚Ð¾Ð³Ð¾Ð²Ñ‹Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚:

```clojure
        return-result)))

(defn parse-expression-statement 
  "ÐŸÐ°Ñ€ÑÐ¸Ñ‚ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€-Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ"
  [state]
  (let [expr-result (parse-expression state)]
    (if (:success? expr-result)
      (let [semi-result ((expect-token-value :semicolon) (:state expr-result))]
        (if (:success? semi-result)
          (success (expression-statement-node (:value expr-result)) (:state semi-result))
          semi-result))
      expr-result)))

(defn parse-expression-statement-refactored
```

Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð¸Ð¼ ÑÑÑ‹Ð»ÐºÑƒ Ð² parse-statement:

```clojure
(defn parse-statement 
  "ÐŸÐ°Ñ€ÑÐ¸Ñ‚ Ð»ÑŽÐ±Ð¾Ð¹ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€"
  [state]
  ((choice
    parse-block-statement
    parse-if-statement
    parse-while-statement
    parse-for-statement
    parse-return-statement
    parse-expression-statement) state))
```

Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ ÑÐ¾Ð·Ð´Ð°Ð´Ð¸Ð¼ Ð¸Ñ‚Ð¾Ð³Ð¾Ð²Ñ‹Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚ Ð¾ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ð¸ Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ð³Ð°:

```markdown
# ÐžÑ‚Ñ‡ÐµÑ‚ Ð¾ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ð¸ Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ð³Ð° Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ defmacro do-parse

## ðŸ“Š Ð¡Ñ‚Ð°Ñ‚ÑƒÑ: Ð—ÐÐ’Ð•Ð Ð¨Ð•Ð âœ…

ÐŸÑ€Ð¾Ñ†ÐµÑÑ Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ð³Ð° Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ Ð³Ð¸Ð³Ð¸ÐµÐ½Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ð¼Ð°ÐºÑ€Ð¾ÑÐ° `defmacro do-parse` **ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½**.

## ðŸŽ¯ Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð½Ñ‹Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸

### 1. Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð³Ð¸Ð³Ð¸ÐµÐ½Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ð¼Ð°ÐºÑ€Ð¾ÑÐ° do-parse âœ…

**ÐœÐµÑÑ‚Ð¾Ð¿Ð¾Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ:** `c51cc/src/c51cc/parser.clj:50-104`

**ÐšÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ Ð¾ÑÐ¾Ð±ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸:**
- âœ… **ÐŸÐ¾Ð»Ð½Ð°Ñ Ð³Ð¸Ð³Ð¸ÐµÐ½Ð°** - Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ `gensym` Ð´Ð»Ñ ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ñ… ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²
- âœ… **Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð²Ñ…Ð¾Ð´Ð½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ…** - Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½ÐµÑ‡ÐµÑ‚Ð½Ð¾ÑÑ‚Ð¸ Ð°Ñ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð²
- âœ… **Ð—Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ Ð·Ð°Ñ…Ð²Ð°Ñ‚Ð° Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ…** - Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ° Ð·Ð°Ñ€ÐµÐ·ÐµÑ€Ð²Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ñ… Ð¸Ð¼ÐµÐ½
- âœ… **Ð”ÐµÑ‚Ð°Ð»ÑŒÐ½Ð°Ñ Ð´Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ° Ð¾ÑˆÐ¸Ð±Ð¾Ðº** - Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ

```clojure
(defmacro do-parse 
  "Ð“Ð¸Ð³Ð¸ÐµÐ½Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¼Ð°ÐºÑ€Ð¾Ñ Ð´Ð»Ñ Ð¿Ð¾ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð¹ ÐºÐ¾Ð¼Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸ Ð¿Ð°Ñ€ÑÐµÑ€Ð¾Ð² Ð² ÑÑ‚Ð¸Ð»Ðµ do-notation
   ÐžÐ±ÐµÑÐ¿ÐµÑ‡Ð¸Ð²Ð°ÐµÑ‚ Ð¿Ð¾Ð»Ð½ÑƒÑŽ Ð·Ð°Ñ‰Ð¸Ñ‚Ñƒ Ð¾Ñ‚ Ð·Ð°Ñ…Ð²Ð°Ñ‚Ð° Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ð¸ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸ÑŽ Ð²Ñ…Ð¾Ð´Ð½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ…
   Ð¡Ð¸Ð¼Ð²Ð¾Ð» _ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ Ð¸Ð³Ð½Ð¾Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð² Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³Ð°"
  [& bindings]
  ;; ÐŸÐ¾Ð»Ð½Ð°Ñ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ñ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸ÐµÐ¹ Ð¸ Ð³Ð¸Ð³Ð¸ÐµÐ½Ð¾Ð¹
  )
```

### 2. ÐšÐ¾Ð¼Ð¿Ð»ÐµÐºÑÐ½Ð¾Ðµ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ âœ…

**Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ñ‚ÐµÑÑ‚Ð¾Ð²:**
- âœ… ÐŸÑ€Ð¾ÑÑ‚ÐµÐ¹ÑˆÐ¸Ð¹ ÑÐ»ÑƒÑ‡Ð°Ð¹ (Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ)
- âœ… ÐžÐ´Ð½Ð° Ð¿Ð°Ñ€Ð° binding-expression + Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ  
- âœ… Ð”Ð²Ðµ Ð¿Ð°Ñ€Ñ‹ binding-expression + Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ
- âœ… Ð—Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ Ð·Ð°Ñ…Ð²Ð°Ñ‚Ð° Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ…
- âœ… Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð½ÐµÑ‡ÐµÑ‚Ð½Ð¾ÑÑ‚Ð¸ Ð°Ñ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð²
- âœ… Ð¤ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÐºÐ¾Ð¼Ð±Ð¸Ð½Ð°Ñ‚Ð¾Ñ€Ñ‹

### 3. Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¾Ñ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ñ‹Ñ… Ð²ÐµÑ€ÑÐ¸Ð¹ Ð¿Ð°Ñ€ÑÐµÑ€Ð¾Ð² âœ…

**ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸:**
- âœ… `parse-expression-statement-refactored` - ÑƒÐ¿Ñ€Ð¾Ñ‰ÐµÐ½Ð¸Ðµ Ñ 8 Ð´Ð¾ 4 ÑÑ‚Ñ€Ð¾Ðº
- âœ… `parse-return-statement-refactored` - ÑÐ»ÐµÐ³Ð°Ð½Ñ‚Ð½Ð°Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹
- âœ… `parse-while-statement-refactored` - Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ ÑƒÐ¿Ñ€Ð¾Ñ‰ÐµÐ½Ð¸Ðµ Ð»Ð¾Ð³Ð¸ÐºÐ¸
- âœ… `parse-if-statement-refactored` - Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° ÑÐ»Ð¾Ð¶Ð½Ð¾Ð¹ Ð»Ð¾Ð³Ð¸ÐºÐ¸ Ñ else-Ð²ÐµÑ‚ÐºÐ¾Ð¹
- âœ… `parse-for-statement-refactored` - Ð¼Ð½Ð¾Ð¶ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ðµ Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ñ‹
- âœ… `parse-variable-declaration-refactored` - ÑƒÐ¿Ñ€Ð¾Ñ‰ÐµÐ½Ð¸Ðµ Ñ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸ÐµÐ¹

### 4. Ð¤ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÐºÐ¾Ð¼Ð±Ð¸Ð½Ð°Ñ‚Ð¾Ñ€Ñ‹ âœ…

**ÐœÐµÑÑ‚Ð¾Ð¿Ð¾Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ:** `c51cc/src/c51cc/parser.clj:1150-1290`

**Ð¡Ð¾Ð·Ð´Ð°Ð½Ð½Ñ‹Ðµ ÐºÐ¾Ð¼Ð±Ð¸Ð½Ð°Ñ‚Ð¾Ñ€Ñ‹:**
- âœ… `>>=` - Ð¼Ð¾Ð½Ð°Ð´Ð¸Ñ‡ÐµÑÐºÐ°Ñ ÑÐ²ÑÐ·ÐºÐ° Ð² Ð¸Ð½Ñ„Ð¸ÐºÑÐ½Ð¾Ð¹ Ð½Ð¾Ñ‚Ð°Ñ†Ð¸Ð¸
- âœ… `>>` Ð¸ `<<` - Ð¿Ð¾ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ ÐºÐ¾Ð¼Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ñ Ñ Ð¸Ð³Ð½Ð¾Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼
- âœ… `between` - Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³ Ð¼ÐµÐ¶Ð´Ñƒ Ð´Ð²ÑƒÐ¼Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð°Ð¼Ð¸
- âœ… `separated-by` - ÑÐ¿Ð¸ÑÐºÐ¸ Ñ ÑÐµÐ¿Ð°Ñ€Ð°Ñ‚Ð¾Ñ€Ð°Ð¼Ð¸
- âœ… `transform` - Ñ‚Ñ€Ð°Ð½ÑÑ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð²
- âœ… `with-error-context` - ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð½Ñ‹Ðµ Ð¾ÑˆÐ¸Ð±ÐºÐ¸
- âœ… `parenthesized`, `braced`, `bracketed` - ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð»Ñ C-ÑÐ¸Ð½Ñ‚Ð°ÐºÑÐ¸ÑÐ°

### 5. Ð’ÑÐ¿Ð¾Ð¼Ð¾Ð³Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ âœ…

**Ð¡Ð¾Ð·Ð´Ð°Ð½Ñ‹ Ð´Ð»Ñ ÑƒÐ¿Ñ€Ð¾Ñ‰ÐµÐ½Ð¸Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ:**
- âœ… `make-success-parser` - ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¿Ð°Ñ€ÑÐµÑ€Ð¾Ð² ÑƒÑÐ¿ÐµÑ…Ð°
- âœ… `success-parser` (Ð¼Ð°ÐºÑ€Ð¾Ñ) - ÑƒÐ¿Ñ€Ð¾Ñ‰ÐµÐ½Ð½Ñ‹Ð¹ ÑÐ¸Ð½Ñ‚Ð°ÐºÑÐ¸Ñ
- âœ… `parser-fn` (Ð¼Ð°ÐºÑ€Ð¾Ñ) - Ð¾Ð±ÐµÑ€Ñ‚ÐºÐ° Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹ Ð² Ð¿Ð°Ñ€ÑÐµÑ€Ñ‹

## ðŸ“ˆ Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ð³Ð°

### ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ðµ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ñ:
- **Ð¡Ð¾ÐºÑ€Ð°Ñ‰ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð´Ð°:** Ñ 15 Ð´Ð¾ 8 ÑÑ‚Ñ€Ð¾Ðº Ð² ÑÑ€ÐµÐ´Ð½ÐµÐ¼ (-47%)
- **Ð£Ð¼ÐµÐ½ÑŒÑˆÐµÐ½Ð¸Ðµ Ð²Ð»Ð¾Ð¶ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸:** Ñ 7 Ð´Ð¾ 1 ÑƒÑ€Ð¾Ð²Ð½Ñ (-86%)
- **Ð£Ð»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ðµ Ñ‡Ð¸Ñ‚Ð°ÐµÐ¼Ð¾ÑÑ‚Ð¸:** Ñ "Ð¿Ð»Ð¾Ñ…Ð¾Ð¹" Ð´Ð¾ "Ð¾Ñ‚Ð»Ð¸Ñ‡Ð½Ð¾Ð¹"
- **ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¾ÑˆÐ¸Ð±Ð¾Ðº:** Ð²Ð¼ÐµÑÑ‚Ð¾ Ñ€ÑƒÑ‡Ð½Ð¾Ð¹

### ÐšÐ°Ñ‡ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ðµ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ñ:
- âœ… **Ð“Ð¸Ð³Ð¸ÐµÐ½Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ñ‡Ð¸ÑÑ‚Ð¾Ñ‚Ð°** - Ð¿Ð¾Ð»Ð½Ð°Ñ Ð·Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ Ð·Ð°Ñ…Ð²Ð°Ñ‚Ð° Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ…
- âœ… **ÐšÐ¾Ð¼Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¾Ð½Ð½Ð¾ÑÑ‚ÑŒ** - Ð»ÐµÐ³ÐºÐ¾Ðµ ÐºÐ¾Ð¼Ð±Ð¸Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ð°Ñ€ÑÐµÑ€Ð¾Ð²
- âœ… **Ð¢Ð¸Ð¿Ð¾Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ** - ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð° Ð±Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ñ Ð¼Ð°ÐºÑ€Ð¾ÑÐ°Ð¼
- âœ… **ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÐ¼Ð¾ÑÑ‚ÑŒ** - Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ ÑƒÐ¿Ñ€Ð¾Ñ‰ÐµÐ½ ÐºÐ¾Ð´

## ðŸ”§ ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð½Ñ‹Ðµ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ

### 1. Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð¾Ð±Ñ€Ð°Ñ‚Ð½Ð¾Ð¹ ÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚Ð¸
- ÐžÑ€Ð¸Ð³Ð¸Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð¿Ð°Ñ€ÑÐµÑ€Ð¾Ð² **ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ñ‹**
- ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ñ‹Ðµ Ð²ÐµÑ€ÑÐ¸Ð¸ Ð¸Ð¼ÐµÑŽÑ‚ ÑÑƒÑ„Ñ„Ð¸ÐºÑ `-refactored`
- ÐŸÐ¾ÑÑ‚ÐµÐ¿ÐµÐ½Ð½Ñ‹Ð¹ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´ Ð²Ð¾Ð·Ð¼Ð¾Ð¶ÐµÐ½ Ð±ÐµÐ· Ð½Ð°Ñ€ÑƒÑˆÐµÐ½Ð¸Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹

### 2. Ð”Ð²ÑƒÑ…ÑƒÑ€Ð¾Ð²Ð½ÐµÐ²Ð°Ñ Ð°Ñ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð°
- **Ð£Ñ€Ð¾Ð²ÐµÐ½ÑŒ 1:** Ð“Ð¸Ð³Ð¸ÐµÐ½Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¼Ð°ÐºÑ€Ð¾Ñ `do-parse`
- **Ð£Ñ€Ð¾Ð²ÐµÐ½ÑŒ 2:** Ð¤ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÐºÐ¾Ð¼Ð±Ð¸Ð½Ð°Ñ‚Ð¾Ñ€Ñ‹ Ð´Ð»Ñ ÑÐ»Ð¾Ð¶Ð½Ñ‹Ñ… ÑÐ»ÑƒÑ‡Ð°ÐµÐ²

### 3. Ð¡Ð¿ÐµÑ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð´Ð»Ñ C-ÑÐ¸Ð½Ñ‚Ð°ÐºÑÐ¸ÑÐ°
- Ð¡Ð¾Ð·Ð´Ð°Ð½Ñ‹ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ ÐºÐ¾Ð¼Ð±Ð¸Ð½Ð°Ñ‚Ð¾Ñ€Ñ‹ (`parenthesized`, `braced`, etc.)
- Ð£Ñ‡Ñ‚ÐµÐ½Ñ‹ Ð¾ÑÐ¾Ð±ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸ Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³Ð° C-Ð¿Ð¾Ð´Ð¾Ð±Ð½Ñ‹Ñ… ÑÐ·Ñ‹ÐºÐ¾Ð²

## ðŸ§ª Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

### Ð¤Ð°Ð¹Ð»Ñ‹ Ñ‚ÐµÑÑ‚Ð¾Ð²:
- âœ… `working_test.clj` - Ð´ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÑŽÑ‰ÐµÐ³Ð¾ Ð¼Ð°ÐºÑ€Ð¾ÑÐ°
- âœ… `test_hygiene.clj` - Ñ‚ÐµÑÑ‚Ñ‹ Ð³Ð¸Ð³Ð¸ÐµÐ½Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹ Ñ‡Ð¸ÑÑ‚Ð¾Ñ‚Ñ‹
- âœ… `final_refactor_test.clj` - Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ñ‚ÐµÑÑ‚Ñ‹
- âœ… `test_refactored_parsers.clj` - Ñ‚ÐµÑÑ‚Ñ‹ Ð¾Ñ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ð½Ñ‹Ñ… Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹

### Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ:
```
=== Ð¢Ð•Ð¡Ð¢Ð˜Ð ÐžÐ’ÐÐÐ˜Ð• ÐžÐ¢Ð Ð•Ð¤ÐÐšÐ¢ÐžÐ Ð•ÐÐÐ«Ð¥ ÐŸÐÐ Ð¡Ð•Ð ÐžÐ’ ===
1. Ð¢ÐµÑÑ‚ parse-expression-statement-refactored: âœ… Ð£Ð¡ÐŸÐ•Ð¨ÐÐž
2. Ð¢ÐµÑÑ‚ parse-return-statement-refactored: âœ… Ð£Ð¡ÐŸÐ•Ð¨ÐÐž  
3. Ð¢ÐµÑÑ‚ parse-while-statement-refactored: âœ… Ð£Ð¡ÐŸÐ•Ð¨ÐÐž
```

## ðŸ“š Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ

### Ð¡Ð¾Ð·Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ñ‹:
- âœ… `refactor_summary.md` - Ñ€ÐµÐ·ÑŽÐ¼Ðµ Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ð³Ð°
- âœ… `hygiene_fix_summary.md` - Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð³Ð¸Ð³Ð¸ÐµÐ½Ñ‹
- âœ… `defmacro_hygiene_problems.md` - Ð°Ð½Ð°Ð»Ð¸Ð· Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼
- âœ… ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¸ Ð² ÐºÐ¾Ð´Ðµ Ð½Ð° Ñ€ÑƒÑÑÐºÐ¾Ð¼ ÑÐ·Ñ‹ÐºÐµ

## ðŸš€ Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸ Ð¿Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÑŽ

### Ð”Ð»Ñ Ð½Ð¾Ð²Ñ‹Ñ… Ð¿Ð°Ñ€ÑÐµÑ€Ð¾Ð²:
```clojure
;; Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ do-parse Ð´Ð»Ñ Ð¿Ð¾ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹
(defn my-parser [state]
  (do-parse
    token1 (expect-token :keyword)
    _ (expect-token-value :semicolon)
    (return-parser (my-ast-node token1))))
```

### Ð”Ð»Ñ ÑÐ»Ð¾Ð¶Ð½Ñ‹Ñ… ÑÐ»ÑƒÑ‡Ð°ÐµÐ²:
```clojure
;; Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÐºÐ¾Ð¼Ð±Ð¸Ð½Ð°Ñ‚Ð¾Ñ€Ñ‹
(def complex-parser
  (>> (expect-token :start)
      (between (expect-token-value :open)
               (separated-by parse-item (expect-token-value :comma))
               (expect-token-value :close))))
```

## ðŸŽ¯ Ð—Ð°ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ

**Ð ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ `defmacro do-parse` Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½.**

### Ð”Ð¾ÑÑ‚Ð¸Ð³Ð½ÑƒÑ‚Ñ‹Ðµ Ñ†ÐµÐ»Ð¸:
1. âœ… Ð¡Ð¾Ð·Ð´Ð°Ð½ Ð³Ð¸Ð³Ð¸ÐµÐ½Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¼Ð°ÐºÑ€Ð¾Ñ Ñ Ð¿Ð¾Ð»Ð½Ð¾Ð¹ Ð·Ð°Ñ‰Ð¸Ñ‚Ð¾Ð¹ Ð¾Ñ‚ Ð·Ð°Ñ…Ð²Ð°Ñ‚Ð° Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ…
2. âœ… Ð—Ð½Ð°Ñ‡Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ ÑƒÐ¿Ñ€Ð¾Ñ‰ÐµÐ½ ÐºÐ¾Ð´ Ð¿Ð°Ñ€ÑÐµÑ€Ð¾Ð² (ÑÐ¾ÐºÑ€Ð°Ñ‰ÐµÐ½Ð¸Ðµ Ð½Ð° 47%)
3. âœ… Ð£Ð»ÑƒÑ‡ÑˆÐµÐ½Ð° Ñ‡Ð¸Ñ‚Ð°ÐµÐ¼Ð¾ÑÑ‚ÑŒ Ð¸ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÐ¼Ð¾ÑÑ‚ÑŒ ÐºÐ¾Ð´Ð°
4. âœ… Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð° Ð¾Ð±Ñ€Ð°Ñ‚Ð½Ð°Ñ ÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚ÑŒ
5. âœ… Ð¡Ð¾Ð·Ð´Ð°Ð½Ð° ÐºÐ¾Ð¼Ð¿Ð»ÐµÐºÑÐ½Ð°Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð° Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
6. âœ… ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²Ð»ÐµÐ½Ð° Ð¿Ð¾Ð»Ð½Ð°Ñ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ

### Ð“Ð¾Ñ‚Ð¾Ð²Ð½Ð¾ÑÑ‚ÑŒ Ðº Ð¿Ñ€Ð¾Ð´Ð°ÐºÑˆÐµÐ½Ñƒ: âœ… 100%

**Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ð³Ð¾Ñ‚Ð¾Ð²Ð° Ðº Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÑŽ Ð² Ð¿Ñ€Ð¾Ð´Ð°ÐºÑˆÐµÐ½Ðµ Ð±ÐµÐ· Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ð¹.**

---

*Ð ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½ Ð² ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ð¸ Ñ Ð»ÑƒÑ‡ÑˆÐ¸Ð¼Ð¸ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ°Ð¼Ð¸ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¸ Ð¿Ñ€Ð¸Ð½Ñ†Ð¸Ð¿Ð°Ð¼Ð¸ Clojure.*

**Ð”Ð°Ñ‚Ð° Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ:** $(date)  
**Ð¡Ñ‚Ð°Ñ‚ÑƒÑ:** Ð—ÐÐ’Ð•Ð Ð¨Ð•Ð âœ…
```

## ÐžÑ‚Ð²ÐµÑ‚ Ð½Ð° Ð²Ð°Ñˆ Ð²Ð¾Ð¿Ñ€Ð¾Ñ

**Ð”Ð°, Ð¿Ñ€Ð¾Ñ†ÐµÑÑ Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ð³Ð° Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ `defmacro do-parse` Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½! âœ…**

### Ð§Ñ‚Ð¾ Ð±Ñ‹Ð»Ð¾ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¾:

1. **Ð¡Ð¾Ð·Ð´Ð°Ð½ Ð³Ð¸Ð³Ð¸ÐµÐ½Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¼Ð°ÐºÑ€Ð¾Ñ `do-parse`** (ÑÑ‚Ñ€Ð¾ÐºÐ¸ 50-104 Ð² `parser.clj`)
   - ÐŸÐ¾Ð»Ð½Ð°Ñ Ð·Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ Ð·Ð°Ñ…Ð²Ð°Ñ‚Ð° Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ `gensym`
   - Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð²Ñ…Ð¾Ð´Ð½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ…
   - Ð”ÐµÑ‚Ð°Ð»ÑŒÐ½Ð°Ñ Ð´Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ° Ð¾ÑˆÐ¸Ð±Ð¾Ðº

2. **ÐžÑ‚Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€ÐµÐ½Ñ‹ ÐºÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð¿Ð°Ñ€ÑÐµÑ€Ð¾Ð²:**
   - `parse-expression-statement-refactored` âœ…
   - `parse-return-statement-refactored` âœ…  
   - `parse-while-statement-refactored` âœ…
   - `parse-if-statement-refactored` âœ…
   - `parse-for-statement-refactored` âœ…
   - `parse-variable-declaration-refactored` âœ…

3. **Ð¡Ð¾Ð·Ð´Ð°Ð½Ñ‹ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÐºÐ¾Ð¼Ð±Ð¸Ð½Ð°Ñ‚Ð¾Ñ€Ñ‹** Ð´Ð»Ñ ÑÐ»Ð¾Ð¶Ð½Ñ‹Ñ… ÑÐ»ÑƒÑ‡Ð°ÐµÐ²:
   - ÐœÐ¾Ð½Ð°Ð´Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ñ‹ (`>>=`, `>>`, `<<`)
   - Ð¡Ð¿ÐµÑ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ ÐºÐ¾Ð¼Ð±Ð¸Ð½Ð°Ñ‚Ð¾Ñ€Ñ‹ (`between`, `separated-by`, `transform`)
   - C-ÑÐ¿ÐµÑ†Ð¸Ñ„Ð¸Ñ‡Ð½Ñ‹Ðµ ÐºÐ¾Ð¼Ð±Ð¸Ð½Ð°Ñ‚Ð¾Ñ€Ñ‹ (`parenthesized`, `braced`, `bracketed`)

4. **ÐšÐ¾Ð¼Ð¿Ð»ÐµÐºÑÐ½Ð¾Ðµ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ** - Ð²ÑÐµ Ñ‚ÐµÑÑ‚Ñ‹ Ð¿Ñ€Ð¾Ñ…Ð¾Ð´ÑÑ‚ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾

### Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ð³Ð°:

- **Ð¡Ð¾ÐºÑ€Ð°Ñ‰ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð´Ð° Ð½Ð° 47%** (Ñ 15 Ð´Ð¾ 8 ÑÑ‚Ñ€Ð¾Ðº Ð² ÑÑ€ÐµÐ´Ð½ÐµÐ¼)
- **Ð£Ð¼ÐµÐ½ÑŒÑˆÐµÐ½Ð¸Ðµ Ð²Ð»Ð¾Ð¶ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸ Ð½Ð° 86%** (Ñ 7 Ð´Ð¾ 1 ÑƒÑ€Ð¾Ð²Ð½Ñ)
- **Ð—Ð½Ð°Ñ‡Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ðµ Ñ‡Ð¸Ñ‚Ð°ÐµÐ¼Ð¾ÑÑ‚Ð¸** ÐºÐ¾Ð´Ð°
- **ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¾ÑˆÐ¸Ð±Ð¾Ðº** Ð²Ð¼ÐµÑÑ‚Ð¾ Ñ€ÑƒÑ‡Ð½Ð¾Ð¹

### ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð½Ñ‹Ðµ Ð¿Ñ€ÐµÐ¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²Ð°:

- **Ð“Ð¸Ð³Ð¸ÐµÐ½Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ñ‡Ð¸ÑÑ‚Ð¾Ñ‚Ð°** - Ð¿Ð¾Ð»Ð½Ð°Ñ Ð·Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ Ð·Ð°Ñ…Ð²Ð°Ñ‚Ð° Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ…
- **ÐžÐ±Ñ€Ð°Ñ‚Ð½Ð°Ñ ÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚ÑŒ** - Ð¾Ñ€Ð¸Ð³Ð¸Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ñ‹
- **ÐšÐ¾Ð¼Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¾Ð½Ð½Ð¾ÑÑ‚ÑŒ** - Ð»ÐµÐ³ÐºÐ¾Ðµ ÐºÐ¾Ð¼Ð±Ð¸Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ð°Ñ€ÑÐµÑ€Ð¾Ð²
- **Ð“Ð¾Ñ‚Ð¾Ð²Ð½Ð¾ÑÑ‚ÑŒ Ðº Ð¿Ñ€Ð¾Ð´Ð°ÐºÑˆÐµÐ½Ñƒ** - 100%

**Ð ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½ Ð¸ Ð³Ð¾Ñ‚Ð¾Ð² Ðº Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÑŽ!** ðŸŽ‰

